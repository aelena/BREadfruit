; -- RULES FOR VENDOR SEARCH FORM 
; -- TODO: PENDING PORTING UNEXPLICIT RULES SUCH AS THOSE IN METHOD ApplyAccountGroupRules
; -- TODO: MANY THINGS MISSING SUCH AS THE COMPOSITE CONTROLS, TEH ATTCHMENTS, buttons iN COMPOSITE CONTROLS....
; 


; -- AccountGroup	DisplayName
;	 YVT1	Belgium/Belgique
;	 YVT2	Luxembourg
;	 YVT3	Spain/Espagne
;	 YVT4	Portugal/Portugal
;	 YVT5	Italy/Italie
;	 YVT6	Reunion/Réunion
;	 YVT6	Martinique/Martinique
;	 YVT6	France Metropolitaine
;	 YVT6	French Guayana/Guyane franç.
;	 YVT6	Guadeloupe
;	 YVT7	Greece/Grèce


; ----------------------------------------------------------------------------	
;     SEARCH FORM 
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4
Entity rbSpiridon is RadioButton in frmSearch
	with defaults
		enabled false
		label "Spiridon"
		value true				; means checked

; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=4
Entity rbEPass is RadioButton in frmSearch
	with defaults
		enabled false
		label "Epass"
		value false				; means unchecked

; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=4, ACTIONS=3, TRIGGERS=1
Entity TBVendorName is TextBox in frmSearch
	with defaults
		enabled true
		visible
		value   ''
		label LABELS.NAME


	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid
		clear vendorSearchResultGrid

	with rules
		
	with triggers
		TBVendorName.value changes

; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=4, ACTIONS=3, TRIGGERS=1

Entity TBVendorCity is TextBox in frmSearch
	with defaults
		visible true
		value ""
		label LABELS.labVendorCity

	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid
		clear vendorSearchResultGrid

	with triggers
		this.value on change


; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=7, ACTIONS=3, RULES=2, CONSTRAINTS=1,TRIGGERS=1

Entity TBVendorNumber is TextBox in frmSearch
	with defaults
		visible true
		value ''
		max length 10
		min length 10
		label LABELS.labVendorNumber
		validation ^[0-9]{10}$


	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid
		clear vendorSearchResultGrid

	with rules
		; show this message "This partner is not managed by Madam. Please contact GSS master data team." if starting with 0
		TBVendorNumber.text starts with '0' then
			set value "This partner is not managed by Madam. Please contact GSS master data team." in MESSAGE_POPUP

	with triggers
		this.value changes

	with constraints
		only numbers
			
; ----------------------------------------------------------------------------	

Entity TBVendorIFA is TextBox in frmSearch
	with defaults
		visible true
		value ''
		label LABELS.labVendorIFA

	with actions
		hide btnCreateVendor
		hide vendorSearchResultGrid
		clear vendorSearchResultGrid
	
	with rules
		; should this be moved to rules for the btnSearch button? maybe.....
		TBVendorIFA.value is '' then 
			DDLVDCountry mandatory
		else 
			DDLVDCountry not mandatory

	with triggers
		this.value changes
				
; ----------------------------------------------------------------------------	


 Entity DDLVDCountry is DropDownList in frmSearch
	with defaults
		value USER.COUNTRY		; preselect user country if there is data in SCD for this user
		load data from DATASOURCE.MDM_Countries
		label LABELS.COUNTRY

	with actions
		set value '' in MESSAGE_POPUP
		hide vendorSearchResultGrid
		hide btnCreateVendor
		load data from DATASOURCE.MDM_Countries
		clear vendorSearchResultGrid


	with rules
		DDLVDCountry.value in {FR,GF,GP,RE,MQ,YT,NC,PF,PM,WF,MC,TF} then label LABELS.labSIRET in TBVendorVAT
		DDLVDCountry.value in {PT,ES} then label LABELS.labNIF in TBVendorVAT
		DDLVDCountry.value is IT then label LABELS.labPartitaIVA in TBVendorVAT
		DDLVDCountry.value not in {PT,ES,IT,FR,GF,GP,RE,MQ,YT,NC,PF,PM,WF,MC} then label LABELS.labVAT in TBVendorVAT
	
	with triggers
		this.value changes 

; ----------------------------------------------------------------------------	

Entity TBVendorVAT is TextBox in frmSearch
	with defaults
		visible true
		value ''
		label LABELS.labVendorVAT

	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid
		clear vendorSearchResultGrid

	with triggers
		this.value changes
		
; ----------------------------------------------------------------------------	


Entity DDLCDCountry is DropDownList in frmSearch
	with defaults
		visible true
		value USER.COUNTRY		; preselect user country if there is data in SCD for this user
		load data from DATASOURCE.MDM_ClusterCountries
		label LABELS.labCountry
		mandatory true
	
	with actions
		; load active companies for this country
		load data from DATASOURCE.MDM_ClusterCompanies with arguments {"Country" : this.value} in DDLCDCompany
		; purge the data in this dropdownlist
		clear DDLCDPurchOrg
		set hidden vendorSearchResultGrid
		clear vendorSearchResultGrid
		hide btnCreateVendor

	with triggers
		this.value changes

; ----------------------------------------------------------------------------	


Entity DDLCDCompany is DropDownList in frmSearch
	with defaults
		visible true
		value USER.COST_LOCATION_UNIT			; another data constant
		label LABELS.labCompany
		mandatory true

	with actions
		; load active companies for this country
		load data from DATASOURCE.MDM_ClusterPurchaseOrganizations with arguments {CompanyCode: this.value} in DDLCDPurchOrg 
		set hidden vendorSearchResultGrid
		clear vendorSearchResultGrid
		hide btnCreateVendor

	with triggers
		this.value changes

; ----------------------------------------------------------------------------	


Entity DDLCDPurchOrg is DropDownList in frmSearch
	with defaults
		visible true
		value ''
		label LABELS.labPURCHASEORG
		mandatory true

	with actions
		clear vendorSearchResultGrid
		hide vendorSearchResultGrid
		hide btnCreateVendor

	with triggers
		this.value changes	

; ----------------------------------------------------------------------------	

Entity btnSearch is Button in frmSearch

	with defaults
		label LABELS.btnSearch

	with actions
		; TODO: missing defining arguments here...
		load data from DATASOURCE.USER_HAS_PERMISSIONS with arguments {User : USER.USER_ID, Country : DDLCDCountry.Value, Company : DDLCDCompany.Value, PurchaseOrg : DDLCDPurchOrg.Value} in MESSAGE_POPUP
		load data from WEBSERVICE.VENDOR_SEARCH_SERVICE with arguments {VendorName:TBVendorName.Value, VendorCity:TBVendorCity, VendorNumber:TBVendorNumber.Value, VendorCountry:DDLVDCountry.Value,TaxCode1:TBVendorVAT.Value,TaxCode4:TBVendorIFA.Value, Country:DDLDCountry.Value, CompanyCode:DDLCDCompany.Value, SalesOrganization:DDLCDSalesOrg.Value, Division:DDLCDivision } in vendorSearchResultGrid
		; this means the database has to be asked to see if current user has permissions for the selected combination
		; of COUNTRY + COMPANY + PURCHASE ORG. If the user has permission, then go ahead, but if not
		; show an error message or popup
		; maybe this has to be defined a bit better
		; would this be DATASOURCE or maybe WEBSERVICE call?
		; what properties should be passed to identify the user? or shall this be somehow managed or injected by environment?
		
	with rules
		
		TBVendorNumber is not empty and TBVendorNumber.Length is not 10 then
			set value 'Insert a valid Vendor Number. It must be 10 digits long.' in MESSAGE_POPUP

		; TODO: CHECK THIS
		; TBVendorIFA.value is not empty then DDLVDCountry mandatory
		; TBVendorIFA.value is not empty then DDLVDCountry not mandatory

		DDLVDCountry is empty then
			set value MESSAGES.ERRfieldVCountry in MESSAGE_POPUP
		
		TBVendorName is empty and TBVendorCity is empty and TBVendorIFA is empty then
			set value 'Fill the fields KeyTax or Vendor or IFA Number or Country + Name or Country + City' in MESSAGE_POPUP
	
		TBVendorName is empty and TBVendorCity is empty and TBVendorIFA is empty and DDLVDCountry is empty and TBVendorVAT is empty then
			set value 'Fill the fields KeyTax or Vendor or IFA Number or Country + Name or Country + City' in MESSAGE_POPUP
		
		TBVendorName is empty and TBVendorCity is not empty and TBVendorName is empty and TBVendorIFA is empty and DDLVDCountry is empty and TBVendorVAT is empty then
			set value MESSAGES.SEARCH.FILL01 in MESSAGE_POPUP
	
		DDLCDCountry is empty or DDLCDCompany is empty or DDLCDPurchOrg is empty then
			set value MESSAGES.SEARCH.FILL03 in MESSAGE_POPUP
		
		TBVendorName is not empty and DDLVDCountry is empty then
			set value MESSAGES.SEARCH.FILL01 in MESSAGE_POPUP

		
						

	with triggers

		this on click

; ----------------------------------------------------------------------------	

Entity btnCreateVendor is Button in frmSearch
	with defaults
		visible false
		label LABELS.btnCreateVendor

	with actions
		; transition to the main form
		; TODO: guess we will have to pass some arguments here and map things to the conceptual model
		; this works already anyway
		; TODO: PROBABLY NOT NEEDED
		change form to frmMain with arguments {"A" : "B"}


	with triggers
		this clicked

; ----------------------------------------------------------------------------	

Entity vendorSearchResultGrid is Grid in frmSearch
	with defaults
		visible false
	
; ----------------------------------------------------------------------------	
;     END OF SEARCH FORM DEFINITION
; ----------------------------------------------------------------------------	

; ----------------------------------------------------------------------------	
; BEGIN MAIN FORM CONTROL DEFINITION
; ----------------------------------------------------------------------------	

; -- RULES FOR VENDOR MAIN FORM (MDM.ASPX)


Entity GD_Ctr_RiskClassification is DropDownList in frmMain

	with defaults
		enabled true
		visible true
		value "00"
		; only two values, 00 and 09
		load data from DATASOURCE.MDM_RiskClassifications
		label LABELS.labGD_Ctr_RiskClassification

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM} then
			this enable false

		REQUEST.CURRENT_ROLE is ROLES.RCO and REQUEST.COUNTRY in {IT, GR} then
			this enabled true

		REQUEST.CURRENT_ROLE not in {ROLES.ENQ,ROLES.CLERK} then enabled false

		REQUEST.CURRENT_ROLE in {ROLES.ENQ, ROLES.RCO, ROLES.CLERK} then enabled true

		GD_Ctr_RiskClassification.Value is '' then
			GD_Ctr_RiskClassification enabled true

	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change

; ----------------------------------------------------------------------------	


Entity GD_Adr_Country is DropDownList in frmMain

	with defaults
		visible true
		enabled false					; this control is always disabled
		value USER.COUNTRY				; -- depends on country selected in search form, so this data has to be passed
		load data from DATASOURCE.MDM_Countries
		mandatory true
		label LABELS.labGD_GD_Adr_Country

	with rules
		GD_Adr_Country.Value is ES and GD_Ctr_CustomerClassification is not G and GD_Ctr_TaxCode1.Value starts with {P,Q,S} then
			set value G in GD_Ctr_CustomerClassification

; ----------------------------------------------------------------------------	

Entity GD_Ctr_VendorClassification is DropDownList in frmMain

	with defaults
		visible true
		enabled true
		value "NG"
		; values G  and NG
		load data from DATASOURCE.labGD_Ctr_VendorClassification
		mandatory true
		label LABELS.labGD_Ctr_VendorClassification

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM} then
			this enable false
		REQUEST.VENDOR_COUNTRY is ES and GD_Ctr_TaxCode1.Text starts with {"P","Q","S"} then set value G in GD_Ctr_VendorClassification
		REQUEST.VENDOR_COUNTRY is ES and GD_Ctr_TaxCode1.Text starts with "X" then set value "NG" in GD_Ctr_VendorClassification
		
		REQUEST.CURRENT_ROLE is ROLES.RCO and REQUEST.COUNTRY in {IT, GR} then
			this enabled 

		REQUEST.CURRENT_ROLE not in {ROLES.ENQ,ROLES.CLERK} then enabled false

		REQUEST.CURRENT_ROLE in {ROLES.ENQ, ROLES.RCO, ROLES.CLERK} then enabled true

	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
; ----------------------------------------------------------------------------	

Entity CC_AM_BPClassification is DropDownList in frmMain

	with defaults
		visible true
		enabled true
		value NORM
		load data from DATASOURCE.BP_CLASSIFICATIONS
		mandatory true
		label LABELS.labCC_AM_BPClassification

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM} then
			this enable false
		CC_AM_BPClassification.Value in {"BPHR", "BPMR"} then ATTACHMENT mandatory 
		REQUEST.CURRENT_ROLE is ROLES.RCO and REQUEST.COUNTRY in {IT, GR} then
			this enabled 

		REQUEST.CURRENT_ROLE not in {ROLES.ENQ,ROLES.CLERK} then enabled false

		REQUEST.CURRENT_ROLE in {ROLES.ENQ, ROLES.RCO, ROLES.CLERK} then enabled true

	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
; ----------------------------------------------------------------------------	

Entity GD_Damex is DropDownList in frmMain
	with defaults
		visible true
		enabled true
		value ''
		load data from DATASOURCE.YES_NO
		mandatory true
		label LABELS.labGD_Damex

	with actions
		ATTACHMENT mandatory true

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE not in {VC, VC_CC} then 
			GD_Damex not mandatory
			GD_Damex not visible

	with triggers
		this changes
; ----------------------------------------------------------------------------	

Entity GD_DamexNote is CheckBox in frmMain
	with defaults
		visible true
		enabled true
		value LABELS.labGD_DamexNote

; ----------------------------------------------------------------------------	


Entity GD_Ctr_IsNaturalPerson is CheckBox in frmMain
	with defaults
		value false		; unchecked
		label LABELS.labGD_Ctr_IsNaturalPerson


	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST.ACCOUNT_GROUP in {YVT4, YVT5} then
			show this
			show DIV_ADDITIONAL_INFO_NATURAL_PERSON	
			; ALL FIELDS IN	DIV_ADDITIONAL_INFO_NATURAL_PERSON mandatory

		REQUEST.COUNTRY is ES and GD_Ctr_TaxCode1.Value starts with {P, Q, S} then
			set value false in GD_Ctr_IsNaturalPerson

		REQUEST.CURRENT_ROLE is ROLES.RCO and REQUEST.COUNTRY in {IT, GR} then
			this enabled 

		REQUEST.COUNTRY is ES and GD_Ctr_TaxCode1.Value starts with {X,1,2,3,4,5,6,7,8,9} then 
			set value true in GD_Ctr_IsNaturalPerson 

		; CHECK THIS -> 5) If request type creation for company or creation for sales org. or modification->enabled

	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change

; ----------------------------------------------------------------------------	

Entity GD_Procur_SupplierDunsNumber is TextBox in frmMain
	with defaults
		max length 20
		label LABELS.labGD_Procur_SupplierDunsNumber

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_Procur_Reason_Supplier is TextBox in frmMain
	with defaults
		max length 35
		label LABELS.labGD_Procur_Reason_Supplier

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_Procur_Supplier_OnContractBasis is DropDownList in frmMain
	with defaults
		label LABELS.labGD_Procur_Supplier_OnContractBasis

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_Procur_Supplier_IsOneTimeVendor is DropDownList in frmMain
	with defaults
		label LABELS.labGD_Procur_Supplier_IsOneTimeVendor

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_Procur_Supplier_ContactPhone is TextBox in frmMain
	with defaults
		label LABELS.labGD_Procur_Supplier_ContactPhone
		max length 26

	with actions
		; move to phone control

	with triggers
		; TODO: TEST THIS AUTOFOCUS
		this exit

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false
; ----------------------------------------------------------------------------	

Entity GD_Procur_Supplier_ContactPerson is DropDownList in frmMain
	with defaults
		label LABELS.labGD_Procur_Supplier_ContactPerson
		max length 47		

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity lGD_Procur_Supplier_ContactEmail is TextBox in frmMain
	with defaults
		label LABELS.labGD_Procur_Supplier_ContactEmail
		max length 47		

	with actions
		; move to email control

	with triggers
		; TODO: TEST THIS AUTOFOCUS
		this exit

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_Procur_MainProducts is DropDownList in frmMain
	with defaults
		label LABELS.labGD_Procur_MainProducts

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_Procur_SuppliersName is TextBox in frmMain
	with defaults
		max length 35
		label LABELS.labGD_Procur_SuppliersName

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_Procur_SuppliersName2 is TextBox in frmMain
	with defaults
		max length 35
		; actually they have no label text
		label ''

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_Procur_SuppliersName3 is TextBox in frmMain
	with defaults
		max length 35
		label ''

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false
				

; ----------------------------------------------------------------------------	

Entity GD_Procur_SuppliersName4 is TextBox in frmMain
	with defaults
		max length 35
		label ''
		
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_Procur_Reason_Justification is TextBox in frmMain
	with defaults
		max length 1000
		mandatory true
		label LABELS.labGD_Procur_Reason_Justification

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false
			this mandatory false

; ----------------------------------------------------------------------------	

Entity GD_Procur_MainActivity is TextBox in frmMain
	with defaults
		label LABELS.labGD_Procur_MainActivity
		
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false
; ----------------------------------------------------------------------------	

Entity GD_Procur_Supplier_ExpectedPVO is DropDownList in frmMain
	with defaults
		label LABELS.labGD_Procur_Supplier_ExpectedPVO
		mandatory true
		; by default it shows the first item in the list which is blank
		value ''
		; the rest of values to show in the dropdown list are to be loaded from DB
		; I think this is hardcoded now in the app itself...
		load data from DATASOURCE.EXPECTED_PVO_RANGES

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		; 3 and 4 are the values for the last two values in the combo
		; if the value is one of those, a series of other controls have to be shown (GD_PVO_Question 1 to 5)
		GD_Procur_Supplier_ExpectedPVO.Value in {"3", "4"} then
			GD_PVO_Question1 visible
			GD_PVO_Question1 mandatory
			GD_PVO_Question2 visible
			GD_PVO_Question2 mandatory
			GD_PVO_Question3 visible
			GD_PVO_Question3 mandatory
			GD_PVO_Question4 visible
			GD_PVO_Question4 mandatory
			GD_PVO_Question5 visible
			GD_PVO_Question5 mandatory

		GD_Procur_Supplier_ExpectedPVO.Value bot in {"3", "4"} then
			GD_PVO_Question1 visible false
			GD_PVO_Question1 mandatory false
			GD_PVO_Question2 visible false
			GD_PVO_Question2 mandatory false
			GD_PVO_Question3 visible false
			GD_PVO_Question3 mandatory false
			GD_PVO_Question4 visible false
			GD_PVO_Question4 mandatory false
			GD_PVO_Question5 visible false
			GD_PVO_Question5 mandatory false

		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false
			this mandatory false

; ----------------------------------------------------------------------------

Entity GD_PVO_Question1 is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labGD_PVO_Question1
		mandatory false
		value ''
		load data from DATASOURCE.YES_NO

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		GD_PVO_Question1.Value is YES then GD_PVO_Link1 visible
		GD_PVO_Question1.Value is NO then GD_PVO_Link1 not visible
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false
			
; ----------------------------------------------------------------------------	

Entity GD_PVO_Question2 is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labGD_PVO_Question2
		mandatory false
		value ''
		; high risk country or low risk country
		load data from DATASOURCE.COUNTRY_RISK_CLASSIFICATION

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		GD_PVO_Question2.Value is "HR" then GD_PVO_Link2 visible
		GD_PVO_Question2.Value is "LR" then GD_PVO_Link2 not visible

		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	
	
Entity GD_PVO_Question3 is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labGD_PVO_Question3
		mandatory false
		value ''
		; high risk country or low risk country
		load data from DATASOURCE.YES_NO

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		this.Value is YES then GD_PVO_Link3 visible
		this.Value is NO then GD_PVO_Link3 not visible
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false
; ----------------------------------------------------------------------------	

Entity GD_PVO_Question4 is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labGD_PVO_Question4
		mandatory false
		value ''
		; values: low, average, high
		load data from DATASOURCE.LOW_AVERAGE_HIGH

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		GD_PVO_Question4.Value is "HR" then GD_PVO_Link4 visible
		GD_PVO_Question4.Value is not "HR" then GD_PVO_Link4 not visible

		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_PVO_Question5 is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labGD_PVO_Question5
		mandatory false
		value ''
		; high risk country or low risk country
		load data from DATASOURCE.YES_NO

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		GD_PVO_Question5.Value is YES then GD_PVO_Link5 visible
		GD_PVO_Question5.Value is NO then GD_PVO_Link5 not visible

		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

;  this.GD_PVO_Link1.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/1.-Basic%20Quality%20Requirements%20and%20Certificates.doc";
;            this.GD_PVO_Link2.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/2.-Corporate%20Responsibility%20Self%20Assessment.doc";
;            this.GD_PVO_Link3.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/3.-Security%20in%20the%20supply%20chain%20-%20customs%20security%20initiatives.doc";
;            this.GD_PVO_Link4.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/4.-Future%20influence%20in%20Siemens.xlsx";
;            this.GD_PVO_Link5.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/5.-Environmental%20Protection,%20Health%20Management%20and%20Safety.doc";


Entity GD_PVO_Link1 is HyperLink in frmMain
	with defaults
		label .MDMFillDoc
		value "~/Resources/MDM/Templates/1.-Basic%20Quality%20Requirements%20and%20Certificates.doc"
		visible false
		
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_PVO_Link2 is HyperLink in frmMain
	with defaults
		label .MDMFillDoc
		value "https://workspace.swe.siemens.com/content/70000071/07/22978293/Docs/2.-Corporate%20Responsibility%20Self%20Assessment.doc"
		visible false

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_PVO_Link3 is HyperLink in frmMain
	with defaults
		label .MDMFillDoc
		value "https://workspace.swe.siemens.com/content/70000071/07/22978293/Docs/3.-Security%20in%20the%20supply%20chain%20-%20customs%20security%20initiatives.doc"
		visible false

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_PVO_Link4 is HyperLink in frmMain
	with defaults
		label .MDMFillDoc
		value "https://workspace.swe.siemens.com/content/70000071/07/22978293/Docs/4.-Future%20influence%20in%20Siemens.xlsx"
		visible false

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false
; ----------------------------------------------------------------------------	

Entity GD_PVO_Link5 is HyperLink in frmMain
	with defaults
		label .MDMFillDoc
		value "https://workspace.swe.siemens.com/content/70000071/07/22978293/Docs/5.-Environmental%20Protection,%20Health%20Management%20and%20Safety.doc"
		visible false

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false
; ----------------------------------------------------------------------------	



Entity GD_Procur_GoodsToSiemens is TextBox in frmMain
	with defaults
		; bd field length
		max length 250
		mandatory true

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false
			this mandatory false

; ----------------------------------------------------------------------------	


Entity GD_Procur_ESNCode  is TextBox in frmMain
	with defaults
		max length 3
		label LABELS.labGD_Procur_ESN

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VC, VC_CC} then 
			GD_Procur_ESNCode mandatory

		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false
			this mandatory false
			

; ----------------------------------------------------------------------------	


Entity GD_Procur_ESNCode2 is TextBox in frmMain
	with defaults
		max length 3

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	

Entity GD_Procur_ESNCode3 is TextBox in frmMain
	with defaults
		max length 3

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false
; ----------------------------------------------------------------------------	

Entity GD_Procur_ESNCode4 is TextBox in frmMain
	with defaults
		max length 3

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.FLOWTYPE in {VM, VC_PO, VM_BLK, VM_UBLK} then 
			this visible false

; ----------------------------------------------------------------------------	
; 25 entities
; ----------------------------------------------------------------------------	


Entity GD_Adr_Name is TextBox in frmMain
	with defaults
		max length 35			;  32 sometimes
		label LABELS.labName

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.ACCOUNT_GROUP in {YVT1,YVT2} then
			max length 32
	with actions
		ATTACHMENT mandatory  true 
		; _COMMENT_ mandatory  false
		set value SUBSTRING(GD_Adr_Name,20) in GD_Adr_Search
		set value GD_Adr_Name in B_GD_VB_AccountHolder

	with triggers 
		this on change
; ----------------------------------------------------------------------------	

Entity GD_Adr_Name2 is TextBox in frmMain
	with defaults
		max length 35

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.ACCOUNT_GROUP in {YVT1,YVT2} then
			max length 32
	with actions
		ATTACHMENT mandatory  true 
		; _COMMENT_ mandatory  false  

	with triggers 
		on change
; ----------------------------------------------------------------------------	

Entity GD_Adr_Name3 is TextBox in frmMain
	with defaults
		max length 35

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST.ACCOUNT_GROUP is YVT7 and REQUEST.REQUEST_TYPE in {VC, VC_CC} then
			mandatory true

		REQUEST.ACCOUNT_GROUP in {YVT1,YVT2} then
			max length 32

		; mandatory for ROLES.ENQ and in 5150 (the only Greece CoCD)
		COMPANY_CODE is 5150 and CURRENT_ROLE is ROLES.ENQ then 
			GD_Adr_Name4 mandatory true

; ----------------------------------------------------------------------------	

Entity GD_Adr_Name4 is TextBox in frmMain
	with defaults
		mandatory false
		enabled true
		max length 35


	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		; for any company 
		REQUEST.CURRENT_ROLE is ROLES.CLERK then mandatory true
		
		; mandatory for ROLES.ENQ and in 5150 (the only Greece CoCD)
		REQUEST.COMPANY_CODE is 5150 and REQUEST.CURRENT_ROLE is ROLES.ENQ then 
			GD_Adr_Name4 mandatory true
		
		REQUEST.REQUEST.ACCOUNT_GROUP is YVT7 and REQUEST.REQUEST_TYPE in {VC, VC_CC} then
			mandatory true

		REQUEST.ACCOUNT_GROUP in {YVT1,YVT2} then
			max length 32
; ----------------------------------------------------------------------------	

Entity GD_Adr_Street is TextBox in frmMain
	with defaults
		max length 35
		label LABELS.labHouseNumber

	with actions
		ATTACHMENT mandatory true

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.ACCOUNT_GROUP in {YVT1,YVT2} then
			max length 32

	with triggers
		this changes

; ----------------------------------------------------------------------------	

Entity GD_Adr_Street2 is TextBox in frmMain
	with defaults
		max length 35
	with actions
		ATTACHMENT mandatory true
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REGIONAL_COUNTRY is FR then GD_Adr_Street2 not visible
		REQUEST.ACCOUNT_GROUP in {YVT1,YVT2} then
			max length 32
	with triggers
		this changes
; ----------------------------------------------------------------------------	

Entity GD_Adr_Street3 is TextBox in frmMain
	with defaults
		max length 35

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REGIONAL_COUNTRY is FR then GD_Adr_Street3 not visible
		REQUEST.ACCOUNT_GROUP in {YVT1,YVT2} then
			max length 32
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
; ----------------------------------------------------------------------------	

Entity GD_Adr_Street4 is TextBox in frmMain
	with defaults
		max length 35
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REGIONAL_COUNTRY is FR then GD_Adr_Street4 not visible
		REQUEST.ACCOUNT_GROUP in {YVT1,YVT2} then
			max length 32
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
; ----------------------------------------------------------------------------	

Entity GD_Adr_Street5 is TextBox in frmMain
	with defaults
		max length 35

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REGIONAL_COUNTRY is FR then GD_Adr_Street5 not visible
		
; ----------------------------------------------------------------------------	


Entity GD_Adr_Region is DropDownList in frmMain
	with defaults
		enabled true
		visible true
		load data from DATASOURCE.MDM_Regions with arguments {"FlagActive" : true, "CountryCode" : REQUEST.VENDOR_COUNTRY }

	; "16-07-2014(RG): 1) In customer creation from scratch MADAM has to check in table in sheet “Mandatory Region List” if it is mandatory and MADAM has to show in DDL the values according to the customer country.
	 
	;	2) If customer country  belongs to YCT6 or YCT9 -> Region mandatory and the control generate postback
	;	3) if customer country belongs to YCT1 -> region mandatory /if region = 01 -> language = NL/If region = 02 OR 03 -> language = FR
	;	4) If customer country belongs to YCT6/YCT9: if region selected = ""2A"" -> Postal code begins with 20/if region selected = ""2B"" -> Postal code begins with 20 else Postal code begins with code region
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST.ACCOUNT_GROUP is YVT7 then
			mandatory false
		REQUEST.REQUEST.ACCOUNT_GROUP is YVT1 then
			mandatory true

		REQUEST.ACCOUNT_GROUP is YVT1 and GD_Adr_Region.Value is 01 then
			set value NL in GD_Com_Language

		REQUEST.ACCOUNT_GROUP is YVT1 and GD_Adr_Region.Value in {02,03} then
			set value FR in GD_Com_Language

		REQUEST.ACCOUNT_GROUP in {YCT6,YVT6,YCT9,YVT9} and REQUEST.Region_IsMandatory and REQUEST.TYPE is VC then
			this mandatory true

; ----------------------------------------------------------------------------	


Entity GD_Adr_CountryGD is TextBox in frmMain

	with defaults
		label LABELS.labCountry
		mandatory true
		enabled false		; always disabled
		; TODO: PENDING FINAL MODEL DEFINITION FROM FD
		value REQUEST.VENDOR_COUNTRY


; ----------------------------------------------------------------------------	

Entity GD_Adr_City is TextBox in frmMain
	with defaults
		visible true		
		enabled true
		mandatory true
		max length 35
		label LABELS.labCity

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		VENDOR_COUNTRY is GR then GD_Adr_City2 visible
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
; ----------------------------------------------------------------------------	


Entity GD_Adr_City2 is TextBox in frmMain
	with defaults
		visible false		; always disabled
		label LABELS.labDistrict
		max length 35

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.VENDOR_COUNTRY is GR and REQUEST.COUNTRY is GR then
			GD_Adr_City2 visible true

		REQUEST.VENDOR_COUNTRY is GR and REQUEST.COUNTRY is not GR then
			GD_Adr_City2 mandatory true

; ----------------------------------------------------------------------------	

Entity GD_Com_Comment is TextBox in frmMain
	with defaults
		max length 35
		label LABELS.labComment
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity GD_Adr_PostalCode is TextBox in frmMain
	with defaults
		max length 10
		mandatory true
		label LABELS.labPostalCode

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		;	IF vendor country belongs to YVT1/YVT2 -> Maxlength = 4 (only numbers - Format: XXXX)
		REQUEST.ACCOUNT_GROUP in {YVT1, YVT2} then
			max length 4
			validation ^[0-9]{4}$

		REQUEST.ACCOUNT_GROUP in {YVT3, YVT5, YVT7} then
			max length 5
			validation ^[0-9]{5}$

		GD_Adr_CountryGD.Value is PT then
			max length 8
			validation ^[0-9]{4}-[0-9]{3}$

		REQUEST.VENDOR_COUNTRY is ES then
			max length 5
			validation ^[0-5]{1}[1-2]{1}[0-9]{3}$

		REQUEST.VENDOR_COUNTRY in {IT, GR} then
			max length 5

		; post code must be >=1500 and <=3999 OR >=8000 and <=9999
		; the regular expression covers the ranges
		REQUEST.VENDOR_COUNTRY is BE and GD_Adr_Region is 01 then
			max length 4
			validation ^(1[5-9][0-9]{2}){1}|((2|3)[0-9]{3}){1}|((8|9)[0-9]{3})$
		
		; post code must be >=1300 and <=1499 OR >=4000 and <=7999
		REQUEST.VENDOR_COUNTRY is BE and GD_Adr_Region is 02 then
			max length 4
			validation ^(1[3-4][0-9]{2}){1}|([4-7][0-9]{3})$

		; post code must be >=1000 and <=1299
		REQUEST.VENDOR_COUNTRY is BE and GD_Adr_Region is 03 then
			max length 4
			validation ^(1[0-2][0-9]{2})$

		REQUEST.VENDOR_COUNTRY in {FR, GF, GP, MC, MQ, NC, PF, PM, RE, WF, YT} then
			max length 5
			validation ^[0-9]{5}$
			set value SUBSTRING(GD_Adr_PostalCode,2) in GD_Adr_Region

		GD_Adr_CountryGD.Value is ES then
			tooltip "Spanish postal code is composed by 5 digits"

		GD_Adr_CountryGD.Value is PT then
			tooltip "Portuguese postal code must have this format 9999-999"

		GD_Adr_CountryGD.Value is IT then
			tooltip "Italian postal code is composed by 5 digits"


; ----------------------------------------------------------------------------	


Entity GD_Adr_Search is TextBox in frmMain
	with defaults
		enabled true
		visible true
		max length 20
		value  GD_Adr_Name1.Value
		label LABELS.Search

	with actions
		ATTACHMENT mandatory true

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then disabled

	with triggers
		this changes


; ----------------------------------------------------------------------------	

; TODO: REVIEW THIS FIELD IN ACTUAL CODE - FIELD MAPPING JUST SAYS "IT WORKS CORRECTLY"
; BECAUSE THE RULES ARE SO COMPLEX THEY DONT EVEN KNOW WHAT THE FUCK IS GOING ON
Entity GD_Adr_POBoxPostalCode is TextBox in frmMain
	with defaults
		enabled true
		visible true
		max length 10
		mandatory false
		label LABELS.labBoxPostalCode

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		; these rules are a bit special
		; this field is imbricated with GD_Adr_POBox and with GD_Adr_POBoxLoc
		; see code around lines 822 and following in MDM.aspx.cs
		REQUEST.VENDOR_COUNTRY in { COUNTRIES.FRENCH_GUAYANA, COUNTRIES.GUADELOUPE, COUNTRIES.MARTINIQUE, COUNTRIES.REUNION, COUNTRIES.FRANCE, COUNTRIES.MAYOTTE, COUNTRIES.NEW_CALEDONIA, COUNTRIES.FRENCH_POLYNESIA, COUNTRIES.STPIERMIQUEL, COUNTRIES.WALLIS_FORTUNA, COUNTRIES.MONACO, COUNTRIES.FRENCH_TERRITORIES } then GD_Adr_POBoxPostalCode mandatory

		REQUEST.VENDOR_COUNTRY is COUNTRIES.FRANCE then this max length 10
		REQUEST.VENDOR_COUNTRY is ES then this max length 5

		REQUEST.REQUEST.ACCOUNT_GROUP is YVT7 then
			max length 5
; ----------------------------------------------------------------------------	

Entity GD_Adr_POBoxLoc is TextBox in frmMain
	with defaults
		enabled true
		visible true
		mandatory false
		label LABELS.labPoBoxLoc
		max length 100


	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COUNTRY is FR then
			max length 40

; ----------------------------------------------------------------------------	

Entity GD_Com_LanguageCode is DropDownList in frmMain
	with defaults
		mandatory true
		; obtain the code for the vendor country, if there is no specific code, then 'EN' is default language
		load data from DATASOURCE.MDM_Languages	with arguments {"FlagActive" : true}	
		label LABELS.labLanguages

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.VENDOR_COUNTRY in {FR,GF,GP,MC,MQ,NC,PF,PM,RE,WF,YT} then
			set value FR in GD_Com_LanguageCode

		REQUEST.ACCOUNT_GROUP is YVT1 and GD_Adr_Region is 01 then
			set value NL in GD_Com_LanguageCode
	
		REQUEST.ACCOUNT_GROUP is YCV1 and GD_Adr_Region in {02, 03} then
			set value FR in GD_Com_LanguageCode

		; this should come from the MODEL (from the MDM_Countries table) where "country configuration" is set
		REQUEST.DefaultLanguage is not empty then
			set value REQUEST.DefaultLanguage in GD_Com_LanguageCode

; ----------------------------------------------------------------------------	

Entity GD_Com_Telebox is DropDownList in frmMain
	with defaults
		mandatory true
		load data from DATASOURCE.MDMC_Telebox with arguments {"FlagActive" : true}
		value PRT
		label LABELS.labTelebox
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity GD_Com_URL is TextBox in frmMain
	with defaults
		max length 120
		label LABELS.labURL
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity GD_Com_DataLine is TextBox in frmMain
	with defaults
		max length 14
		label LABELS.labDataLine
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity P_GD_VT_Country is DropDownList in frmMain
	with defaults
		load data from DATASOURCE.MDM_Countries
		value REQUEST.VENDOR_COUNTRY
		mandatory true
	
	with actions
		load data from DATASOURCE.MDM_CountryTelephonePrefixes with arguments {"COUNTRY" : P_GD_VT_Country.Value } in P_GD_VT_CountryCode
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false	
	with triggers
		this changes

; ----------------------------------------------------------------------------	

Entity P_GD_VT_CountryCode is TextBox in frmMain
	with defaults
		enabled false
		mandatory true
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity P_GD_VT_Number is TextBox in frmMain
	with defaults
		max length 30
		label LABELS.labGD_VT_Number
		mandatory true
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity P_GD_VT_Extension is TextBox in frmMain
	with defaults
		max length 10
		label LABELS.lablabGD_VT_Extension
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity P_GD_VT_Notes is TextBox in frmMain
	with defaults
		max length 50
		label LABELS.labGD_VT_Notes
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity P_GD_VT_Default is TextBox in frmMain
	with defaults
		; by defaults appears checked and disabled
		value true
		label LABELS.labP_GD_VT_Default
		enabled false
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity P_GD_VT_btnInsert is Button in frmMain
	with defaults
		label LABELS.labInsert
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	


; --- TODO: TENTATIVE GRID DEFINITION AND CONVENTIONS

Entity P_GD_VT_Grid is Grid in frmMain
	with defaults
		; TODO: how to define or set the controls inside? the row definition?
		define column GRID_P_GD_VT_Country		with arguments {ControlType : DropDownList, DataField : GD_VT_Country, Header : LABELS.labCountry, DataSource: DATASOURCE.MDM_Countries, Visible : true}
		define column GRID_P_GD_VT_CountryCode	with arguments {ControlType : TextBox,		DataField : GD_VT_CountryCode, Header : LABELS.labPrefix, Enabled : false, Visible : true}
		define column GRID_P_GD_VT_Number		with arguments {ControlType : TextBox,		DataField : GD_VT_Number, Header : LABELS.labNumber, Constraints : Only_Numbers, Visible : true}
		define column GRID_P_GD_VT_Extension	with arguments {ControlType : TextBox,		DataField : GD_VT_Extension, Header : LABELS.labExtension, Constraints : Only_Numbers, Visible : true}
		define column GRID_P_GD_VT_Notes		with arguments {ControlType : TextBox,		DataField : GD_VT_Notes, Header : LABELS.labNotes, Visible : true}
		define column GRID_P_GD_VT_Default		with arguments {ControlType : CheckBox,		DataField : GD_VT_Default, Header : LABELS.labDefault, Constraints : Only_Numbers, Visible : true}
		define column GRID_P_GD_VT_ConsNumber	with arguments {ControlType : TextBox,		DataField : GD_VT_ConsNumber, Visible : false}

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.CURRENT_ROLE in {ROLES.UPM, ROLES.CPM, ROLES.RCO, ROLES.CLERK} then
			load data from DATASOURCE.MDM_Request_VendorPhoneDetails with arguments {"RequestID" : REQUEST.REQUEST_ID}
		REQUEST.CURRENT_ROLE is ROLES.ENQ and REQUEST.REQUEST_TYPE is not VC then
			load data from DATASOURCE.MDM_Request_VendorPhoneDetailsSAP with arguments {"RequestID" : REQUEST.REQUEST_ID}

	with triggers
		on row inserted
		on row deleted
		on row updated

; ----------------------------------------------------------------------------	

Entity F_GD_VF_Country is DropDownList in frmMain
	with defaults
		load data from DATASOURCE.MDM_Countries
		value REQUEST.VENDOR_COUNTRY

	with actions
		load data from DATASOURCE.MDM_CountryTelephonePrefixes with arguments {"COUNTRY" : F_GD_VF_Country.Value } in F_GD_VF_CountryCode
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false	
	with triggers
		this changes

; ----------------------------------------------------------------------------	

Entity F_GD_VF_CountryCode is TextBox in frmMain
	with defaults
		enabled false
		mandatory true
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity F_GD_VF_Number is TextBox in frmMain
	with defaults
		max length 30
		label LABELS.labGD_VF_Number
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false		
; ----------------------------------------------------------------------------	

Entity F_GD_VF_Extension is TextBox in frmMain
	with defaults
		max length 10
		label LABELS.labGD_VF_CountryCode
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity F_GD_VF_Notes is TextBox in frmMain
	with defaults
		max length 50
		label LABELS.labGD_VF_Notes
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false		
; ----------------------------------------------------------------------------	

Entity F_GD_VF_Default is TextBox in frmMain
	with defaults
		value false
		label LABELS.labGD_VF_Default
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity F_GD_VF_btnInsert is Button in frmMain
	with defaults
		label LABELS.labInsert
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

; --- TODO: TENTATIVE GRID DEFINITION AND CONVENTIONS

Entity F_GD_VF_Grid is Grid in frmMain
	with defaults
		; TODO: how to define or set the controls inside? the row definition?
		define column GRID_F_GD_VF_Country		with arguments {ControlType : DropDownList, DataField : GD_VF_Country, Header : LABELS.labCountry, DataSource: DATASOURCE.MDM_Countries, Visible : true}
		define column GRID_F_GD_VF_CountryCode	with arguments {ControlType : TextBox,		DataField : GD_VF_CountryCode, Header : LABELS.labPrefix, Enabled : false, Visible : true}
		define column GRID_F_GD_VF_Number		with arguments {ControlType : TextBox,		DataField : GD_VF_Number, Header : LABELS.labNumber, Constraints : Only_Numbers, Visible : true}
		define column GRID_F_GD_VF_Extension	with arguments {ControlType : TextBox,		DataField : GD_VF_Extension, Header : LABELS.labExtension, Constraints : Only_Numbers, Visible : true}
		define column GRID_F_GD_VF_Notes		with arguments {ControlType : TextBox,		DataField : GD_VF_Notes, Header : LABELS.labNotes, Visible : true}
		define column GRID_F_GD_VF_Default		with arguments {ControlType : CheckBox,		DataField : GD_VF_Default, Header : LABELS.labDefault, Constraints : Only_Numbers, Visible : true}
		define column GRID_F_GD_VF_ConsNumber	with arguments {ControlType : TextBox,		DataField : GD_VF_ConsNumber, Visible : false}

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO, ROLES.CLERK} then
			load data from DATASOURCE.MDM_Request_VendorFaxDetails with arguments {"RequestID" : REQUEST.REQUEST_ID}
		REQUEST.CURRENT_ROLE is ROLES.ENQ and REQUEST.REQUEST_TYPE is not VC then
			load data from DATASOURCE.MDM_Request_VendorFaxDetailsSAP with arguments {"RequestID" : REQUEST.REQUEST_ID}

	with triggers
		on row inserted
		on row deleted
		on row updated

; ----------------------------------------------------------------------------	


Entity E_GD_VE_SmtpAddr is TextBox in frmMain
	with defaults
		; move the tooltip text to the real dictionary
		tooltip "the email is used generally for all the automatic communication with the supplier - e.g. payment advice"
		label LABELS.labGD_VE_SmtpAddr
		max length 241
		mandatory true
		; IT'S ALMOST IMPOSSIBLE TO DO THE RIGHT REGEX FOR EMAIL, SO FOR THE MOMENT WE PUT NOTHING HERE -
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		; check this is true
		REQUEST.REQUEST_TYPE is VC then mandatory true
		
; ----------------------------------------------------------------------------	

Entity E_GD_VE_Notes is TextBox in frmMain
	with defaults
		max length 50
		label LABELS.labGD_VE_Notes
		
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity E_GD_VE_Default is TextBox in frmMain
	with defaults
		value false
		label LABELS.labGD_VE_Default
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false		
; ----------------------------------------------------------------------------	

Entity E_GD_VE_btnInsert is Button in frmMain
	with defaults
		label LABELS.labInsert
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

Entity E_GD_VE_Grid is Grid in frmMain
	with defaults
		; TODO: how to define or set the controls inside? the row definition?
		define column GRID_E_GD_VE_SmtpAddr		with arguments {ControlType : TextBox,		DataField : GD_VE_SmtpAddr, Header : LABELS.labNumber, Constraints : Only_Numbers, Visible : true}
		define column GRID_E_GD_VE_Notes		with arguments {ControlType : TextBox,		DataField : GD_VE_Notes, Header : LABELS.labNotes, Visible : true}
		define column GRID_E_GD_VE_Default		with arguments {ControlType : CheckBox,		DataField : GD_VE_Default, Header : LABELS.labDefault, Constraints : Only_Numbers, Visible : true}
		define column GRID_E_GD_VE_ConsNumber	with arguments {ControlType : TextBox,		DataField : GD_VE_ConsNumber, Visible : false}

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO, ROLES.CLERK} then
			load data from DATASOURCE.MDM_Request_VendorEmailDetails with arguments {"RequestID" : REQUEST.REQUEST_ID}
		REQUEST.CURRENT_ROLE is ROLES.ENQ and REQUEST.REQUEST_TYPE is not VC then
			load data from DATASOURCE.MDM_Request_VendorEmailDetailsSAP with arguments {"RequestID" : REQUEST.REQUEST_ID}

	with triggers
		on row inserted
		on row deleted
		on row updated

; ----------------------------------------------------------------------------	

Entity GD_NatP_DateOfBirth is Calendar in frmMain
	with defaults
		label LABELS.calBirthDate

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

; backed by test 034
Entity GD_NatP_PlaceOfBirth is TextBox in frmMain
	with defaults
		max length 25
		label LABELS.labPlaceOfBirth
		
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COMPANY_CODE is "5240" and GD_Ctr_NIF.Value starts with {1,2} or GD_Ctr_TaxCode1.Value starts with {1,2} then 
			label "Nº Employees"
			make mandatory
		

; ----------------------------------------------------------------------------	

; backed by test 035
Entity GD_NatP_Profession is TextBox in frmMain
	with defaults
		max length 30
		label LABELS.labProfession
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.ACCOUNT_GROUP in {YVT6, YVT9} then this visible false

; ----------------------------------------------------------------------------	

Entity GD_NatP_Sex is DropDownList in frmMain
	with defaults
		load data from DATASOURCE.GENERIC.MDM_Sex
		value ''
		label LABELS.labSex
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false

; ----------------------------------------------------------------------------	


; PREPARE TEST FOR THIS
; THIS ENTITY HAS A LOT OF CODE AND NOTHING IN THE FIELD MAPPING
Entity GD_Ctr_CustomerNumber is TextBox in frmMain
	with defaults
		max length 18
		label LABELS.labCustomerNumber
		
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		
		REQUEST.STATUS is not REQUEST.CLOSED and REQUEST.REQUEST_TYPE is VM and PO_ReturnsVendor.Checked is true and GD_Ctr_CustomerNumber.OldDisplayValue is empty then
			mandatory true
			
		REQUEST.STATUS is not REQUEST.CLOSED and REQUEST.REQUEST_TYPE is VM and PO_ReturnsVendor.Checked is true and GD_Ctr_CustomerNumber.OldDisplayValue is not empty then
			this mandatory
			
		REQUEST.STATUS is not REQUEST.CLOSED and REQUEST.REQUEST_TYPE is VM and PO_ReturnsVendor.Checked is false then
			this not mandatory
			GD_Abc_DEMO mandatory
			
		REQUEST.STATUS is not REQUEST.CLOSED and REQUEST.REQUEST_TYPE is not VM then
			mandatory true	


; ----------------------------------------------------------------------------	


Entity GD_Ctr_Industry is DropDownList in frmMain
	with defaults
		mandatory false
		visible true
		label LABELS.labIndustries
		; if there are no specific data for this specific country, data for "EN" should be loaded
		load data from DATASOURCE.MDM_Industries with arguments {"FlagActive": true, "Country" : REQUEST.VENDOR_COUNTRY}

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST.ACCOUNT_GROUP in {"YCT6", "YVT6"} then
			load data from DATASOURCE.MDM_Industries with arguments {"FlagActive": true, "Country" : FR}
			; this equals to this line in original code
			; this.m_mdmSessionInfo.IndustryCountry = Business.Constants.Countries.France;
			set value FR in REQUEST.INDUSTRY_COUNTRY
			; can or should we do something like this?
			set width 680px		

		REQUEST.REQUEST.ACCOUNT_GROUP in {"YCT9", "YVT9"} then
			load data from DATASOURCE.MDM_Industries with arguments {"FlagActive": true, "Country" : "EN"}
			; this.m_mdmSessionInfo.IndustryCountry = Business.Constants.Countries.France;
			set value "EN" in REQUEST.INDUSTRY_COUNTRY
			mandatory false
			; TODO: can or should we do something like this?
			; set width 680px		
			
; ----------------------------------------------------------------------------	

Entity GD_Ctr_GFORM is DropDownList in frmMain
	with defaults
		label LABELS.labLegalForm
		visible false
		; data source is same for vendors and customers
		load data from DATASOURCE.MDM_LegalForms with arguments {"FlagActive" : true }

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST.ACCOUNT_GROUP in {"YCT6", "YVT6"} then
			visible true

		REQUEST.REQUEST.ACCOUNT_GROUP in {"YCT6", "YVT6"} and REQUEST.ROLE is ROLES.CLERK then
			mandatory true

; ----------------------------------------------------------------------------	

; this is one of the most sensitive and complex controls 
; there are quite a few rules

;	
;	By default visible = false
;	Label:Local Tax Code

;	2) if vendor country France->maxlength 14, label = SIRET, visible true
;	3)if vendor country france -> only numbers
;	4) when PIVA postback: if vendor country belongs to YVT6-> complete piva wiht 0 on left until 14,tax code 1=piva, tax code 2=firts 9 digits of piva , vatnumber=tax code 2
;	else -> if vendor country belongs to EU ->tax code 1 = PIVA
;		if vendor country is not Spain->  vat registration number = tax code 2
;		if regional country is France and vendor country belongs to YVT6->complete piva wiht 0 on left until 14,tax code 1=piva, tax code 2=firts 9 digits of piva , vatnumber=tax code 2
;		if regional country is Greece and vendor country is Greece-> vatregistrationnumber = tax code 2 , tax code 2 remove letters
;	5) If vendor country belongs to YVT6 and tax code1 is informed -> piva = tax code 1
;	6)if vendor country Portugal->visible false
;	7)if vendor country Italy->visible for  vendor creation from scratch and mandatory
;	8)if vendor country Spain->visible false
;	9)enabled for vendors creations from scratch
;	10)if vendor country France->enabled
;	11)if vendor creation from scratch and vendor country Belgium or Luxemburg->visible true and mandatory if role is not ROLES.CLERK
;	12)if vendor country Greece ->maxlength 9
;	13)if vendor country belongs to YVT1->maxlength 10
;	14)if vendor country belongs to YVT2->maxlength 8
;	15)if vendor country belongs to YVT3->maxlength 16
;	16)if vendor country belongs to YVT4->maxlength 10
;	17)if vendor country belongs to YVT5->maxlength 11
;	18)if vendor country belongs to YVT6: 
;		if cleck->mandatory false else mandatory for not natural person
;		enabled for clerck and ROLES.ENQuirer
;	19)if vendor country belongs to YVT9:
;		mandatory false
;		enabled for ROLES.CLERK and ROLES.ENQuirer

Entity GD_Ctr_PIVA is TextBox in frmMain
	with defaults
		; I doubt this
		visible false
		label LABELS.labPIVA ; ocal Tax Code
		mandatory false

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		; this means companycode country
		;	1) if regional country Greece and not vendor creation from scratch->NO mandatory else If vendor country doesn't belong to YVT6 or YVT9 -> mandatory
		REQUEST.COUNTRY is GR and REQUEST.REQUEST_TYPE is not VC then
			this mandatory false
		REQUEST.COUNTRY is GR and REQUEST.REQUEST_TYPE is not VC and REQUEST.ACCOUNT_GROUP not in {YVT6, YVT9} then
			this mandatory true

		; YVT1 is BELGIUM
		REQUEST.ACCOUNT_GROUP is YVT1 then
			validation regex ^[0-9]{10}$			; always 10 digits
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			set value GD_Ctr_PIVA.Value in GD_Ctr_VATRegistrationNumber
			set value [BE + GD_Ctr_PIVA.Value] in GD_Ctr_VATRegistrationNumber
			
		REQUEST.ACCOUNT_GROUP is YVT2 then
			validation regex ^[0-9]{10}$			; always 10 digits
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			GD_Ctr_TaxCode2 enabled false
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			set value [LU + GD_Ctr_PIVA.Value] in GD_Ctr_VATRegistrationNumber

		REQUEST.ACCOUNT_GROUP is YVT3 then
			validation regex ^[A-Za-z0-9]{9}$
			set value [ES + GD_Ctr_PIVA.Value] in GD_Ctr_VATRegistrationNumber
		
		REQUEST.ACCOUNT_GROUP is YVT3 and GD_Ctr_TaxCode1.Text starts with {"P","Q","S"} then
			validation regex ^[A-Za-z0-9]{9}$
			set value [ES + GD_Ctr_PIVA.Value] in GD_Ctr_VATRegistrationNumber
			set value G in GD_Ctr_VendorClassification
	
		REQUEST.ACCOUNT_GROUP is YVT3 and GD_Ctr_TaxCode1.Text starts with "X" then
			validation regex ^[A-Za-z0-9]{9}$
			set value [ES + GD_Ctr_PIVA.Value] in GD_Ctr_VATRegistrationNumber
			set value NG in GD_Ctr_VendorClassification
		
		; if vendor country France->maxlength 14, label = SIRET, visible true, only numbers
		REQUEST.VENDOR_COUNTRY is FR then
			visible true
			label LABEL.labSIRET	; see this
			max length 14
			; validate with this regex
			validation regex ^[0-9]{1,14}$

		REQUEST.ACCOUNT_GROUP is YVT6 then
			; new rule to be tested and parsed
			; complete piva wiht 0 on left until 14
			pad left 0,14
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			; new rule to be tested and parsed
			set value substring(GD_Ctr_PIVA.Value,9) in GD_Ctr_TaxCode2
			set value GD_Ctr_TaxCode2.Value in GD_Ctr_IFANumber

		REQUEST.VENDOR_COUNTRY is FR and REQUEST.REQUEST.ACCOUNT_GROUP is YVT6 then
			pad left 0,14
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			set value substring(GD_Ctr_PIVA.Value,9) in GD_Ctr_TaxCode2
			set value GD_Ctr_TaxCode2.Value in GD_Ctr_IFANumber

		; ny EU country ; finish the list....
		REQUEST.REQUEST.ACCOUNT_GROUP is not "YVT6" and REQUEST.VENDOR_COUNTRY in {ES, IT, PT, GR } then
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1

		REQUEST.VENDOR_COUNTRY is not ES then
			set value GD_Ctr_TaxCode2.Value in GD_Ctr_IFANumber

		REQUEST.VENDOR_COUNTRY is GR and REQUEST.COUNTRY is GR then
			set value GD_Ctr_TaxCode2.Value in GD_Ctr_IFANumber
			remove letters GD_Ctr_TaxCode2.Value
		
		REQUEST.ACCOUNT_GROUP is YVT4 then
			max length 9
			validation regex ^[0-9]{9}$			; always 9 digits
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			set value [PT + GD_Ctr_PIVA.Value] in GD_Ctr_VATRegistrationNumber

		REQUEST.ACCOUNT_GROUP is YVT4 and  GD_Ctr_PIVA.Value starts with {1,2,3} then
			set value true in GD_Ctr_IsNaturalPerson
			GD_Ctr_TaxCode2 mandatory true
			GD_Ctr_TaxCode2 enabled true
			; TODO: HOW TO SET VALIDATION REGEX for antoher control?

		REQUEST.ACCOUNT_GROUP is YVT5 then
			max length 16
			validation regex ^[A-Za-z0-9]{16}$
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode2
			set value [IT + GD_Ctr_PIVA.Value] in GD_Ctr_VATRegistrationNumber

		REQUEST.ACCOUNT_GROUP is YVT5 and GD_Ctr_PIVA.Value is 00000000000 then
			set value '' in GD_Ctr_VATRegistrationNumber
			
		REQUEST.ACCOUNT_GROUP is YVT7 then
			max length 9
			validation regex ^[0-9]{9}$			; always 9 digits
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode2
			set value [GR + GD_Ctr_PIVA.Value] in GD_Ctr_VATRegistrationNumber

; ----------------------------------------------------------------------------	

; TODO: THIS IS A VERY SENSITIVE FIELD
; DEDICATE SPECIFIC TIME TO THIS - ALSO THE PropagateNif METHOD
Entity GD_Ctr_NIF is TextBox in frmMain
	with defaults
		label LABELS.labNIF
		max length 9

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COUNTRY is PT and REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} then
			this mandatory true

; ----------------------------------------------------------------------------	


Entity GD_Ctr_CF is TextBox in frmMain
	with defaults
		label LABELS.labCF
		visible false
		max length 16


	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COUNTRY is IT and REQUEST.REQUEST_TYPE is VC then
			visible true

; ----------------------------------------------------------------------------	


Entity GD_Ctr_TaxCode1 is TextBox in frmMain
	with defaults
		label LABELS.labTaxCode2

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.VENDOR_COUNTRY is ES and GD_Ctr_TaxCode1.Text starts with {1,2,3,4,5,6,7,8,9,X} then
			set value true in GD_Ctr_IsNaturalPerson			; check the checkbox

		REQUEST.ACCOUNT_GROUP is YVT1 then
			validation regex ^[0-9]{10}$			; always 10 digits
			set value [BE + GD_Ctr_PIVA.Value] in GD_Ctr_VATRegistrationNumber
			mandatory true

		REQUEST.ACCOUNT_GROUP is YVT2 then
			mandatory true
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			set value [LU + GD_Ctr_PIVA.Value] in GD_Ctr_VATRegistrationNumber

		REQUEST.REQUEST.ACCOUNT_GROUP is YVT7 then
			mandatory false
			visible false

		REQUEST.REQUEST.ACCOUNT_GROUP is YVT5 then
			max length 16

		REQUEST.ACCOUNT_GROUP in {YVT6, YCT6, YVT9, YCT9} and REQUEST.REQUEST_TYPE is VC and REQUEST.TaxCode1_IsMandatory then
			this mandatory true

; ----------------------------------------------------------------------------	

Entity GD_Ctr_TaxCode2 is TextBox in frmMain
	with defaults
		label LABELS.labTaxCode2

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST.ACCOUNT_GROUP is YVT7 then
			max length 9
		REQUEST.REQUEST.ACCOUNT_GROUP is YVT5 then
			max length 11
		REQUEST.ACCOUNT_GROUP in {YVT1,YVT2} then
			enabled false

		REQUEST.ACCOUNT_GROUP in {YVT6, YCT6, YVT9, YCT9} and REQUEST.REQUEST_TYPE is VC and REQUEST.TaxCode2_IsMandatory then
			this mandatory true

; ----------------------------------------------------------------------------	


; TODO: PENDING ANALYZE WHAT THE METHOD CalculateVATNumber DOES
; 1) if vendor country france -> enabled
; 2)if vendor country NOT belongs to YVT6/YVT9-> vatregnumber mandatory if vendor country has mandatory vatregnumber in table countries
; 3)if vendor country NOT belongs to YVT6/YVT9-> enabled if mandatory and vendor creation from scratch
; 4)if vendor country belgiun/luxemburg and role is ROLES.CLERK ->nor mandatory
; 5)if regional country Greece->not mandatory and not enabled
; 6)if regional country France->enabled
; 7)enabled for creations from scratch
; 8)if vendor country Portugal ->enable false, not mandatory
; 9)if vendor country Italy ->enable false, not mandatory 
; 10)if regional country Belgium/Luxemburg->if ROLES.CLERK and not request block/unblock-> enabled
; 11)if vendor country Portugal-> enabled false, mandatory false
; 12)if vendor country Italy-> enabled false, mandatory false
; 13)if vendor country Portugal-> Vat registration number = PT+NIF
; 14)if vendor country belongs to YVT6->maxlength 14,enabled, if not natural person and vendor creation from scratch->mandatory
; 15)if vendor country belongs to YVT9->not mandatory,enabled

Entity GD_Ctr_VATRegistrationNumber is TextBox in frmMain
	with defaults
		label LABELS.labVATRegistrationNumber

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VC and REQUEST.VAT_IS_MANDATORY_FOR_COUNTRY is true then
			GD_Ctr_VATRegistrationNumber mandatory
			GD_Ctr_VATRegistrationNumber enabled

		REQUEST.COUNTRY in {BE, LU} and REQUEST.CURRENT_ROLE is MDM_ROLES.CLERK then
			GD_Ctr_VATRegistrationNumber mandatory true
			GD_Ctr_VATRegistrationNumber enabled true

		REQUEST.COUNTRY in {BE, LU} and REQUEST.REQUEST_TYPE is VM then
			enabled false

		REQUEST.COUNTRY in {GR,ES} then
			GD_Ctr_VATRegistrationNumber mandatory false
			GD_Ctr_VATRegistrationNumber enabled false

		REQUEST.COUNTRY is FR then
			GD_Ctr_VATRegistrationNumber mandatory true
			GD_Ctr_VATRegistrationNumber enabled true

		REQUEST.REQUEST.ACCOUNT_GROUP is YVT7 then
			this enable false
			this mandatory false

		REQUEST.ACCOUNT_GROUP in {YVT6, YCT6, YVT9, YCT9} and REQUEST.REQUEST_TYPE is VC and REQUEST.VAT_IsMandatory then
			this mandatory true
			this enable true

		REQUEST.VAT_IsMandatory and REQUEST.REQUEST_TYPE is VC then
			this enable true
			this mandatory true
; ----------------------------------------------------------------------------	

Entity GD_Ctr_SalesPurTax is CheckBox in frmMain
	with defaults
		max length 20
		label LABELS.chkSales
		visible false
		value REQUEST.GD_Ctr_SalesPurTax_SAP
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM then
			this visible true

		REQUEST.ACCOUNT_GROUP in {YVT1, YVT3, YVT1} and REQUEST.COMPANY_CODE in {5101, 563M, 5109} then
			set value true in GD_Ctr_SalesPurTax

		REQUEST.ACCOUNT_GROUP in {YVT1, YVT1} then
			show GD_Ctr_SalesPurTax
			set value true in GD_Ctr_SalesPurTax

		REQUEST.COMPANY_CODE in {5101,563M,5109} and REQUEST.ACCOUNT_GROUP is YVT1 then
			set value true ; check the checkbox

; ----------------------------------------------------------------------------	

Entity GD_Ctr_IFANumber is TextBox in frmMain
	with defaults
		max length 20
		label LABELS.labIFANumber
		visible false
		enabled false
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM then
			this visible true

		REQUEST.REQUEST_TYPE is VC and REQUEST.COUNTRY in {BE, LU} then
			this visible true
			
; ----------------------------------------------------------------------------	

Entity GD_Ctr_RepresentiveName is TextBox in frmMain
	with defaults
		max length 10
		label LABELS.labRepresenNumber
		visible false
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM then
			this visible true

					
; ----------------------------------------------------------------------------	

Entity GD_Ctr_TaxNumber	is TextBox in frmMain
	with defaults
		visible false
		label LABELS.labTaxNumber

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM then
			this visible true
			
; ----------------------------------------------------------------------------	

Entity GD_Ctr_CreditInfoNo is TextBox in frmMain
	with defaults
		max length 11
		visible false
		label LABELS.labCreditInfo

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM then
			this visible true
	
; ----------------------------------------------------------------------------	

; TODO: THE DATASOURCE INDICATED DOES NOT EXIST, CURRENTLY VALUES ARE LOADED IN CODE, SO THE DATASOURCE HAS TO BE CREATED
; VALUES ARE
; "", ""
; "D - Unsubscribe", "D"
; "V - Unsubscribed from CMD", "V"
Entity GD_Ctr_UnsubscribeCMD is DropDownList in frmMain
	with defaults
		label LABELS.labUnsubscribeCMD
		load data from DATASOURCE.MDM_UnsubscribeCMD_Options

	with actions
		set value GD_Ctr_UnsubscribeCMD.Value in BLK_GD_Ctr_UnsubscribeCMD
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
	with triggers
		; when this controls change, change the value of BLK_GD_Ctr_UnsubscribeCMD
		this changes


; ----------------------------------------------------------------------------	

; TODO: DECIDE LATER ON WHAT TO DO WITH CONTROLS INSIDE COMPOSITE CONTROLS....

; ---------------------------------------------------------------------------- 


Entity V_Country is DropDownList in frmMain
	with defaults
		label LABELS.labCountry
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
; ---------------------------------------------------------------------------- 

Entity V_VATNumber is TextBox in frmMain
	with defaults
		label LABELS.labNumber
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
; ---------------------------------------------------------------------------- 

Entity V_btnInsert is Button in frmMain
	with defaults
		label LABELS.labInsert
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ---------------------------------------------------------------------------- 

Entity V_Grid is Grid in frmMain
	with defaults
		define column GRID_V_Country		with arguments {ControlType : DropDownList, DataField : Country, Header : LABELS.labCountry, DataSource: DATASOURCE.MDM_Countries, Visible : true}
		define column GRID_V_VATNumber		with arguments {ControlType : TextBox,		DataField : VATNumber, Header : LABELS.labVATNumber, Visible : true}
		
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO, ROLES.CLERK} then
			load data from DATASOURCE.MDM_Request_VendorVAT with arguments {"RequestID" : REQUEST.REQUEST_ID}
		REQUEST.CURRENT_ROLE is ROLES.ENQ and REQUEST.REQUEST_TYPE is not VC then
			load data from DATASOURCE.MDM_Request_VendorVATSAP with arguments {"RequestID" : REQUEST.REQUEST_ID}

	with triggers
		on row inserted
		on row deleted
		on row updated

; ----------------------------------------------------------------------------	

; THIS IS THE BANK DETAILS

Entity B_GD_VB_Country is DropDownList in frmMain

	with defaults
		label LABELS.labCountry
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
; ---------------------------------------------------------------------------- 

Entity B_GD_VB_BankKey is TextBox in frmMain

	with defaults
		label LABELS.labGD_VD_BankKey
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
; ---------------------------------------------------------------------------- 

Entity B_GD_VB_BankAccount is TextBox in frmMain

	with defaults
		label LABELS.labGD_VD_BankAccount
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
; ---------------------------------------------------------------------------- 

Entity B_GD_VB_BankControlKey is TextBox in frmMain

	with defaults
		label LABELS.labGD_VD_BankControlKey
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
; ---------------------------------------------------------------------------- 

Entity B_GD_VB_IBAN is TextBox in frmMain

	with defaults
		label LABELS.labGD_VD_IBAN
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
; ---------------------------------------------------------------------------- 

Entity B_GD_VB_SWIFT is TextBox in frmMain

	with defaults
		label LABELS.labGD_VD_SWIFT
		visible false

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VC then
			this visible true
			
			
; ---------------------------------------------------------------------------- 

Entity B_GD_VB_AccountHolder is TextBox in frmMain

	with defaults
		label LABELS.labGD_VD_AccountHolder
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
; ---------------------------------------------------------------------------- 

Entity B_GD_VB_BankCity is TextBox in frmMain

	with defaults
		label LABELS.labGD_VD_BankCity
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ---------------------------------------------------------------------------- 

Entity B_GD_VB_PartBankType is TextBox in frmMain

	with defaults
		label LABELS.labGD_VB_PartBankType
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ---------------------------------------------------------------------------- 

Entity B_GD_VB_BankReferDetails is TextBox in frmMain

	with defaults
		label LABELS.labGD_VB_BankReferDetails
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ---------------------------------------------------------------------------- 

Entity B_GD_VB_btnInsert is Button in frmMain

	with defaults
		label LABELS.btnInsert
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ---------------------------------------------------------------------------- 

Entity B_GD_VB_Grid is Grid in frmMain
	with defaults
		; TODO: do we need this column also to keep track of the ID in the grid?
		; TODO: define column GRID_V_RequestID		with arguments {ControlType : TextBox,		DataField : RequestID, Header : LABELS.labNumber, Constraints : Only_Numbers, Visible : false}
	
		define column GRID_B_GD_VB_Country		with arguments {ControlType : DropDownList, DataField : Country, Header : LABELS.labCountry, DataSource: DATASOURCE.MDM_Countries, Visible : true}
		define column GRID_B_GD_VB_BankKey		with arguments {ControlType : TextBox,		DataField : GD_VB_BankKey, Header : LABELS.labBankKey, Visible : true}
		define column GRID_B_GD_VB_BankAccount	with arguments {ControlType : TextBox,	DataField : GD_VB_BankAccount, Header : LABELS.labBankAccount, Visible : true}
		define column GRID_B_GD_VB_BankControlKey	with arguments {ControlType : TextBox,	DataField : GD_VB_BankControlKey, Header : LABELS.labBankControlKey, Visible : true}
		define column GRID_B_GD_VB_IBAN			with arguments {ControlType : TextBox,	DataField : GD_VB_IBAN, Header : LABELS.labIBAN, Visible : true}
		define column GRID_B_GD_VB_SWIFT		with arguments {ControlType : TextBox,	DataField : GD_VB_SWIFT, Header : LABELS.labSWIFT, Visible : true}
		define column GRID_B_GD_VB_NameOfBank	with arguments {ControlType : TextBox,	DataField : GD_VB_NameOfBank, Header : LABELS.labNameOfBank, Visible: false}
		define column GRID_B_GD_VB_AccountHolder	with arguments {ControlType : TextBox,	DataField : GD_VB_AccountHolder, Header : LABELS.labAccountHolder, Visible : true}
		define column GRID_B_GD_VB_BankCity	with arguments {ControlType : TextBox,	DataField : GD_VB_BankCity, Header : LABELS.labBankCity, Visible : false}
		define column GRID_B_GD_VB_PartBankType	with arguments {ControlType : TextBox,	DataField : GD_VB_PartBankType, Header : LABELS.labPartBankType, Visible : false}
		define column GRID_B_GD_VB_BankReferDetails	with arguments {ControlType : TextBox,	DataField : GD_VB_BankReferDetails, Header : LABELS.labBankReferDetails, Visible: false}
		define column GRID_RelevantFlag	with arguments {ControlType : CheckBox,	DataField : RelevantFlag, Visible : false}

		
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO, ROLES.CLERK} then
			load data from DATASOURCE.MDM_Request_VendorBankDetails with arguments {"RequestID" : REQUEST.REQUEST_ID}
		REQUEST.CURRENT_ROLE is ROLES.ENQ and REQUEST.REQUEST_TYPE is not VC then
			load data from DATASOURCE.MDM_Request_VendorBankDetailsSAP with arguments {"RequestID" : REQUEST.REQUEST_ID}

	with triggers
		on row inserted
		on row deleted
		on row updated

; ----------------------------------------------------------------------------	

; ALWAYS HIDDEN
; TODO: DECIDE WHAT TO DO WITH THIS SORT OF FIELDS...
Entity CC_CO_ReconAccount is TextBox in frmMain
	with defaults
		visible false
		value REQUEST.CC_CO_ReconAccount_SAP
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

; ALWAYS HIDDEN
; TODO: DECIDE WHAT TO DO WITH THIS SORT OF FIELDS...
Entity LFB1_LNRZE is TextBox in frmMain
	with defaults
		visible false
		value REQUEST.LFB1_LNRZE_SAP
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

; ALWAYS HIDDEN
; TODO: DECIDE WHAT TO DO WITH THIS SORT OF FIELDS....
Entity LFB1_REPRF is TextBox in frmMain
	with defaults
		visible false

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE in {VC, VC_CC} then
			set value X in LFB1_REPRF

		REQUEST.REQUEST_TYPE not in {VC, VC_CC} then
			; in this case send the old value from SAP
			set value REQUEST.LFB1_REPRF_SAP in LFB1_REPRF
; ----------------------------------------------------------------------------	

; TODO: CLARIFY - THE RULES ARE A TOTAL FUCKING MESS
Entity CC_AM_SortKey is DropDownList in frmMain
	with defaults
		label LABELS.labAMSortKeys
		load data from DATASOURCE.MDM_SortKeys with arguments {"FlagActive" : true}
		mandatory

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		; this means the value that was retrieved from SAP
		REQUEST.CC_AM_SortKey_SAP is not empty then
			set value REQUEST.CC_AM_SortKey_SAP in CC_AM_SortKey

		REQUEST.CC_AM_SortKey_SAP is empty and REQUEST.VENDOR_COUNTRY is FR then
			set value 003 in CC_AM_SortKey

		REQUEST.CC_AM_SortKey_SAP is empty and REQUEST.VENDOR_COUNTRY is GR then
			set value 001 in CC_AM_SortKey

		REQUEST.REQUEST_TYPE not in {VM, VM_BLK, VM_UBLK} and REQUEST.COUNTRY is FR then
			set value 003 in CC_AM_SortKey

		REQUEST.REQUEST_TYPE not in {VM, VM_BLK, VM_UBLK} and REQUEST.COUNTRY is GR then
			set value 001 in CC_AM_SortKey

		REQUEST.REQUEST_TYPE in {VC, VC_CC, VC_PO} then
			this visible false
		else
			this visible true


; ----------------------------------------------------------------------------	

; TODO: TEST
Entity CC_AM_SubjectedToWHTax is CheckBox in frmMain
	with defaults
		label LABELS.labAMSubjectedWithholdingTax

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false

		REQUEST.CURRENT_ROLE is ROLES.ENQ and REQUEST.COUNTRY in {ES, IT} then
			CC_AM_WithholdingTaxCode mandatory CC_AM_SubjectedToWHTax.Checked

		REQUEST.COUNTRY is ES and GD_Ctr_IsNaturalPerson.Checked is true and REQUEST.REQUEST_TYPE is VM then
			CC_AM_WithholdingTaxCode mandatory false

		REQUEST.COUNTRY is ES and GD_Ctr_IsNaturalPerson.Checked is true then
			set value true in CC_AM_SubjectedToWHTax

; ----------------------------------------------------------------------------	

; TODO: TEST

Entity CC_AM_WithholdingTaxCode	is DropDownList in frmMain
	with defaults
		label LABELS.labAMWithholdingTaxCode

	with defaults
		load data from DATASOURCE.MDM_WithholdingTaxCodes with arguments {"FlagActive" : true, "ClusteROLES.RCOuntry" : REQUEST.COUNTRY}

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false

		REQUEST.COUNTRY is ES then
			set value E0 in CC_AM_SubjectedToWHTax 

		REQUEST.CURRENT_ROLE is ROLES.ENQ and REQUEST.COUNTRY in {ES, IT} then
			CC_AM_WithholdingTaxCode mandatory CC_AM_SubjectedToWHTax.Checked

		REQUEST.COUNTRY is ES and GD_Ctr_IsNaturalPerson.Checked is true and REQUEST.REQUEST_TYPE is VM then
			CC_AM_WithholdingTaxCode mandatory false

; ----------------------------------------------------------------------------	

Entity CC_AM_ExemptionNumber is TextBox in frmMain
	with defaults
		label LABELS.labAMExemptionNumber
		max length 20
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

; Field is only needed when field NIF/ P.IVA/ Local tax code starts by ""1"" and ""2"", 
; country from PT and Company code 5240. If so field becomes mandatory, label should be ""Social Security Situation"", 
; field must appear in menu ""info add. For natural person"" in general data: 
; and then a dropdownlist with the folloing values must be available: ""0_No exemption"" and 2_Exemption
; 14-07-2014 (MC) the correct technical name is LFB1-QSBGR with DDL (2 options - 0 and 2) and only for company code PT"


; TODO: CLARIFY THIS WITH STAKEHOLDERS_: 
; 2) In case Greece company code, if this field is flagged, the field LFB1-QSSKZ is mandatory  but the DDL must have just the value D1- Dummy. 
; This value D1 will be saved in SAP in the  fields LFBW-WITHT and LFBW-WT_WITHCD = D1 and LFBW-WT_SUBJCT flagged. 

; TODO: TEST

; --- backed by test 036
Entity GD_NatP_Exemption is DropDownList in frmMain
	with defaults
		label LABELS.labExemption
		visible false
		; PUT INTO DATABASE 
		; this.GD_NatP_Exemption.Items.Add ( new ListItem ( "0 - No exemption", "0" ) );
		; this.GD_NatP_Exemption.Items.Add ( new ListItem ( "2 - Exemption", "2" ) );
		; does not exist in Customerload data from DATASOURCE.MDM_NaturalPersonExemptions
		value ''

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.VENDOR_COUNTRY is PT and GD_Ctr_NIF starts with 1 or GD_Ctr_NIF starts with 2 then
			CC_AM_ExemptionNumber visible 
			CC_AM_ExemptionNumber mandatory 
			; change label to "Social Security Situation"
			label LABELS.SOCIAL_SEC_SITUATION


; ----------------------------------------------------------------------------	

Entity CC_PT_ValidityDate is Calendar in frmMain
	with defaults
		label LABELS.labValidityDate
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

; backed by test 037
Entity CC_AM_CashManagementGroup is DropDownList in frmMain
	with defaults
		label LABELS.labAMCashManagementGroup
		load data from DATASOURCE.MDM_CashManagementGroups with arguments {"FlagActive" : true}

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.VENDOR_COUNTRY is REQUEST.COUNTRY then
			set value A1 in CC_AM_CashManagementGroup

		REQUEST.VENDOR_COUNTRY is not REQUEST.COUNTRY then
			; TODO: TEST THIS SHORTER SYNTAX
			set value A2

		REQUEST.COUNTRY is FR and REQUEST.VENDOR_COUNTRY in {FR, GF, GP, RE, MQ, YT, NC, PF, PM, WF, MC} then
			hide this
			set value A1

; ----------------------------------------------------------------------------	


; 3) if a request type creation for purchase organization and the company code already exists, the value from SAP must be preserved
; 1) default values (but ROLES.ENQ can change)
; if request type creation from scratch and/or for company:
;   if company code Spain -> default value 3M60 
;   if company code IT -> default value 5510 
;   if company code LU -> default value 1113 
;   if company code BE - >default value 1301 
;   if company code 5140 - >default value 6115
;   if company code 5924/592F -> default value 6000
;   if company code PT =a)visible but not enable
; if company code GR - > default value 7A90 
; b) if partner country PT-> default value ""4217""
; C) if partner country not PT -> default value ""4117""


Entity CC_PT_PaymentTerms is DropDownList in frmMain
	with defaults
		load data from DATASOURCE.MDM_PaymentTerms with arguments {"FlagActive" : true, "Country": REQUEST.COUNTRY}
		; 1) By default mandatory
		label LABELS.labPTPaymentTerms
		mandatory
		
	with actions
		set value CC_PT_PaymentTerms.Value in PO_TermsOfPaymentKey.Value
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		; 2) visible for all except for CoCd Portugal in creation from scratch and cocd is not visible
		REQUEST.COUNTRY is PT and REQUEST.REQUEST_TYPE in {VC, VC_CC} then
			hide this
			CC_PT_PaymentTerms mandatory false


		REQUEST.COUNTRY is ES and REQUEST.REQUEST_TYPE in {VC, VC_CC} then
			set value 3M60 in CC_PT_PaymentTerms
			set value 3M60 in CC_PT_PaymentTerms.OldDisplayValue

		REQUEST.COUNTRY is IT and REQUEST.REQUEST_TYPE in {VC, VC_CC} then
			set value 5510 in CC_PT_PaymentTerms
			set value 5510 in CC_PT_PaymentTerms.OldDisplayValue
		
		REQUEST.COUNTRY is LU and REQUEST.REQUEST_TYPE in {VC, VC_CC} then
			set value 1113 in PO_TermsOfPaymentKey
			set value 1113 in PO_TermsOfPaymentKey.OldDisplayValue

		REQUEST.COUNTRY is BE and REQUEST.REQUEST_TYPE in {VC, VC_CC} then
			set value 1301 in CC_PT_PaymentTerms
			set value 1301 in CC_PT_PaymentTerms.OldDisplayValue

		REQUEST.COUNTRY is GR and REQUEST.REQUEST_TYPE in {VC, VC_CC} then
			set value 7A90 in CC_PT_PaymentTerms
			set value 7A90 in CC_PT_PaymentTerms.OldDisplayValue

		REQUEST.COMPANY_CODE is 5140 and REQUEST.REQUEST_TYPE in {VC, VC_CC} then
			set value 6115 in CC_PT_PaymentTerms
			set value 6115 in CC_PT_PaymentTerms.OldDisplayValue

		REQUEST.COMPANY_CODE in {5924, 592F} and REQUEST.REQUEST_TYPE in {VC, VC_CC} then
			set value 6000 in CC_PT_PaymentTerms
			set value 6000 in CC_PT_PaymentTerms.OldDisplayValue
	
	with triggers
		this changes

; ----------------------------------------------------------------------------	

Entity CC_PT_PaymentBlock is DropDownList in frmMain
	with defaults
		label LABELS.labPTPaymentBlock
		load data from DATASOURCE.MDM_PaymentBlocks with arguments {"FlagActive" : true}
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
; ----------------------------------------------------------------------------	


; "1) field visible and mandatory for all company codes
; 2) If company code country and vendor country equal -> value G; except for company code PT, BE and LU;
; 3) If company code country and vendor country different -> value Y; except for company code PT, BE and LU;
; 4) For company code France:
;     if bank country belongs to YVt6 (FR, GF, GP, RE, MQ and YT) and payment methods = Y->error:in Company Code Data it is not possible to inform Payment Methods with value 'Y - VIREMENT SFS - FRS'
;     if bank country doesn't belong to YVT6 and payment methods = G->in Company Code Data it is not possible to informPayment Methods with value 'G - Domestic payments thru SFS' for foreign banks
; 5) if company code Belgium/Luxemburg:  value GY and enabled false 
; 6) if company code Portugal: value 2GHY and enabled false 
; 4)if selected payment methods 2 and vendor country Spain and house bank empty-> mandatory inform house bank
; "

; backed by file File038 - CC_PT_PaymentMethods
Entity CC_PT_PaymentMethods	is DropDownList in frmMain
	with defaults
		label LABELS.labPTPaymentMethods
		mandatory
		load data from DATASOURCE.MDM_PaymentMethods with arguments {"FlagActive" : true, "Country": REQUEST.COUNTRY}


	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.VENDOR_COUNTRY is REQUEST.COUNTRY and REQUEST.COUNTRY not in {PT, BE, LU} then
			set value G

		REQUEST.VENDOR_COUNTRY is not REQUEST.COUNTRY and REQUEST.COUNTRY not in {PT, BE, LU} then
			set value Y

		REQUEST.COUNTRY is BE then
			set value GY
			disable this

		REQUEST.COUNTRY is PT and this.Value is empty then
			set value 2GHY
			disable this

		REQUEST.VENDOR_COUNTRY is ES and CC_PT_PaymentMethods.Value is 2 then
			CC_PT_HouseBank mandatory
			
		
; ----------------------------------------------------------------------------	

Entity CC_PT_ClearingWithCustomer is CheckBox in frmMain
	with defaults
		label LABELS.labCC_PT_ClearingWithCustomer

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COMPANY_CODE in {5101, 5109} then
			; meaning, make it checked
			set value true in CC_PT_ClearingWithCustomer

; ----------------------------------------------------------------------------	

Entity CC_PT_AlternativePayee is TextBox in frmMain
	with defaults
		label LABELS.labPTAlternativePayee
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
; ----------------------------------------------------------------------------	

Entity CC_PT_IndividualPayment	is CheckBox in frmMain
	with defaults
		label LABELS.labPTIndividualPayment
		visible false

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COUNTRY in {IT, BE, LU} then
			show CC_PT_IndividualPayment


; ----------------------------------------------------------------------------	

; so far this is being loaded manually, must move to a datasource
;			lic.Add ( new ListItem ( "BEC - Banesto", "BEC" ) );
;            lic.Add ( new ListItem ( "BSB - Sabadell", "BSB" ) );
;            lic.Add ( new ListItem ( "BCH - Santander", "BCH" ) );
;            lic.Add ( new ListItem ( "JPM - JP Morgan", "JPM" ) );
;            lic.Add ( new ListItem ( "DB - Deutsche Bank", "DB" ) );

Entity CC_PT_HouseBank is DropDownList in frmMain
	with defaults
		label LABELS.labPTHouseBank
		load data from DATASOURCE.MDM_HouseBanks with arguments {"FlagActive" : true}
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

; 1) Not visible to all company codes
; 2) Only used for company code 5240:
;    value is always 4112 (is value from SAP different, do not maintain)
; in fact control does not exist in form, just a field, always write 4112 for 5240
Entity CC_PT_ForCreditMemos	is DropDownList in frmMain
	with defaults
		visible false

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COMPANY_CODE is 5240 then
			set value 4112 in CC_PT_ForCreditMemos

; ----------------------------------------------------------------------------	


Entity CC_DD_DunningProcedure is DropDownList in frmMain
	with defaults
		label LABELS.labDDDunningprocedure
		load data from DATASOURCE.MDM_DunningProcedure with arguments {"FlagActive" : true, "Country": REQUEST.COUNTRY}

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COUNTRY is BE then
			set value Y1VE in CC_DD_DunningProcedure

		REQUEST.COUNTRY is LU then
			set value Y001 in CC_DD_DunningProcedure

		REQUEST.COMPANY_CODE in {5101, 563M, 5109} then
			set value 10 in CC_DD_DunningProcedure
			CC_DD_DunningClerk enable false

		REQUEST.COUNTRY is PT then 
			hide this

; ----------------------------------------------------------------------------	


Entity CC_DD_LegalProceedings is Calendar in frmMain
	with defaults
		visible true
		label LABELS.labLegalProceedings	

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COUNTRY is ES and CC_DD_LastDunnedOn is not empty then
			CC_DD_DunningProcedure mandatory

		REQUEST.COUNTRY is ES and CC_DD_LegalProceedings is empty then
			set value '' in CC_DD_DunningProcedure

		REQUEST.COUNTRY is not ES and CC_DD_LegalProceedings is empty then
			set value Y3PR in CC_DD_DunningProcedure

; ----------------------------------------------------------------------------	

; TODO: add test
Entity CC_DD_LastDunnedOn is Calendar in frmMain
	with defaults
		visible true
		label LABELS.labLastDunnedOn

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COUNTRY is PT then 
			hide this

		REQUEST.COUNTRY is ES and CC_DD_DunningProcedure is not empty then
			CC_DD_LastDunnedOn mandatory

		REQUEST.COUNTRY is ES and CC_DD_LegalProceedings is not empty then
			CC_DD_LastDunnedOn mandatory

; ----------------------------------------------------------------------------	

Entity CC_DD_DunningBlock is DropDownList in frmMain
	with defaults
		visible true
		label LABELS.labDDDunningBlock
		load data from DATASOURCE.MDM_DunningBlocks with arguments {"FlagActive" : true}
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false

; ----------------------------------------------------------------------------	


Entity CC_DD_Level is TextBox in frmMain
	with defaults
		visible true
		label LABELS.labDDDunningLevel

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COUNTRY is PT then 
			hide CC_DD_Level

; ----------------------------------------------------------------------------	

; TODO: PENDING TESTS
Entity CC_DD_DunningClerk is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labDDDunningClerk
		load data from DATASOURCE.MDM_AccountingClerks with arguments {"FlagActive" : true, "CompanyCode" : REQUEST.COMPANY_CODE}

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COMPANY_CODE in {5101, 563M, 5109} then
			set value 10 in CC_DD_DunningClerk.Value
			this disabled
			; show this

		REQUEST.COUNTRY is PT then
			show this

; ----------------------------------------------------------------------------	

; TODO: THIS FIELD IS TOO COMPLICATED - REVIEW BETTER - SEE FIELDMAPPING FILE
Entity CC_CO_AccountingClerk is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labCOAccountingClerk
		load data from DATASOURCE.MDM_AccountingClerks with arguments {"FlagActive" : true, "CompanyCode" : REQUEST.COMPANY_CODE}

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false

		REQUEST.VENDOR_COUNTRY in {PT, FR} then
			CC_CO_AccountingClerk visible true

		REQUEST.COMPANY_CODE in {5101, 563M} then
			CC_CO_AccountingClerk visible true

		REQUEST.COUNTRY is PT and CC_CO_AccountingClerk.Visible is true and CC_PT_PaymentTerms is number or PO_TermsOfPaymentKey is number then
			set value 25 in CC_CO_AccountingClerk

		REQUEST.COUNTRY is PT and CC_CO_AccountingClerk.Visible is true and CC_PT_PaymentTerms is not number or PO_TermsOfPaymentKey is not number then
			set value 20 in CC_CO_AccountingClerk
					

; ----------------------------------------------------------------------------	

; has to be saved and resent from SAP in any case
; NOTE: NOT PRESENT IN FORM
; Entity CC_CO_AccountingClerkTel	is TextBox in frmMain
; 	with defaults
; 		visible false
; 	with rules
; 		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
; 			this enable false
; ----------------------------------------------------------------------------	

; has to be saved and resent from SAP in any case
; NOTE: NOT PRESENT IN FORM
; Entity CC_CO_AccountingClerkFax	is TextBox in frmMain
; 	with defaults
; 		visible false
; 	with rules
; 		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
; 			this enable false
; ----------------------------------------------------------------------------	

; has to be saved and resent from SAP in any case
; NOTE: NOT PRESENT IN FORM
; Entity CC_CO_AccountingClerkInternet is TextBox in frmMain
; 	with defaults
; 		visible false
; 	with rules
; 		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
; 			this enable false
; ----------------------------------------------------------------------------	


Entity CC_CO_OurAccountWithVendor is TextBox in frmMain
	with defaults
		; this is only in schema
		max length 50
		label LABELS.labCOOurAccountWithVendor
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false

; ----------------------------------------------------------------------------	

Entity PO_AutomaticGenerationPO	is CheckBox in frmMain
	with defaults
		visible true
		label LABELS.labAutomaticGenerationPO

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COUNTRY is GR then
			PO_AutomaticGenerationPO visible true
			set value false in PO_AutomaticGenerationPO

		REQUEST.COUNTRY is GR then
			set value false in PO_AutomaticGenerationPO
			this visible true

		REQUEST.REQUEST_TYPE in {VC, VC_CC, VC_PO} then
			set value true in PO_OrderAcknowledgmentReq

; ----------------------------------------------------------------------------	

Entity PO_OrderAcknowledgmentReq is CheckBox in frmMain
	with defaults
		visible false
		label LABELS.labOrderAcknowledgmentReq

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		; checkbox must be checked in these request types...
		REQUEST.REQUEST_TYPE in {VC, VC_CC, VC_PO} then
			set value true in PO_OrderAcknowledgmentReq

		REQUEST.COUNTRY is not GR then
			PO_OrderAcknowledgmentReq visible false

; ----------------------------------------------------------------------------	

Entity PO_GRBasedInvoiceVerification is CheckBox in frmMain
	with defaults
		visible true
		label LABELS.labPO_GRBasedInvoiceVerification
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false

; ----------------------------------------------------------------------------	

Entity PO_ReturnsVendor	is CheckBox in frmMain
	with defaults
		visible true
		label LABELS.labPO_ReturnsVendor


	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false

		REQUEST.REQUEST_TYPE is VM and PO_ReturnsVendor.Value is true and GD_Ctr_CustomerNumber.OldDisplayValue is empty then
			GD_Ctr_CustomerNumber mandatory
			GD_Ctr_CustomerNumber visible
			GD_Ctr_CustomerNumber enable true

		REQUEST.REQUEST_TYPE is VM and PO_ReturnsVendor.Value is true and GD_Ctr_CustomerNumber.OldDisplayValue is not empty then
			GD_Ctr_CustomerNumber mandatory false
			GD_Ctr_CustomerNumber visible
			GD_Ctr_CustomerNumber enable false

		REQUEST.REQUEST_TYPE is VM and PO_ReturnsVendor.Value is false then
			GD_Ctr_CustomerNumber enable false

		REQUEST.REQUEST_TYPE is not VM and PO_ReturnsVendor.Value is true then
			GD_Ctr_CustomerNumber visible
			GD_Ctr_CustomerNumber mandatory

		REQUEST.COUNTRY is GR then
			set value false in PO_ReturnsVendor
			this visible true

	with triggers
		this changes

; ----------------------------------------------------------------------------	

Entity PO_PurchaseOrderCurrency	is DropDownList in frmMain
	with defaults
		mandatory
		label LABELS.labPurchaseOrderCurrency
		; the company code country, not vendor's country
		load data from DATASOURCE.MDM_Currencies with arguments {"FlagActive" : true }
		value EUR
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
; ----------------------------------------------------------------------------	


Entity PO_TermsOfPaymentKey is DropDownList in frmMain
	with defaults
		mandatory
		label LABELS.lblPO_TermsOfPaymentKey
		; the company code country, not vendor's country
		load data from DATASOURCE.MDM_PaymentTerms with arguments {"FlagActive" : true, "Country" : REQUEST.COUNTRY}

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VC and REQUEST.COUNTRY is ES then
			set value 3M60 in PO_TermsOfPaymentKey
			set value 3M60 in PO_TermsOfPaymentKey.OldDisplayValue

		REQUEST.REQUEST_TYPE is VC and REQUEST.CURRENT_ROLE is ENQ and REQUEST.COUNTRY is IT then
			set value 5510 in PO_TermsOfPaymentKey
			set value 5510 in PO_TermsOfPaymentKey.OldDisplayValue
	
		REQUEST.REQUEST_TYPE is VC and REQUEST.COUNTRY is LU then
			set value 1113 in PO_TermsOfPaymentKey
			set value 1113 in PO_TermsOfPaymentKey.OldDisplayValue
	
		REQUEST.REQUEST_TYPE is VC and REQUEST.COUNTRY is BE then
			set value 1301 in PO_TermsOfPaymentKey
			set value 1301 in PO_TermsOfPaymentKey.OldDisplayValue

		REQUEST.REQUEST_TYPE is VC and REQUEST.COUNTRY is GR then
			set value 7A90 in PO_TermsOfPaymentKey
			set value 7A90 in PO_TermsOfPaymentKey.OldDisplayValue

		REQUEST.COUNTRY is PT and REQUEST.VENDOR_COUNTRY is PT then
			set value 4217 in PO_TermsOfPaymentKey
			set value 4217 in PO_TermsOfPaymentKey.OldDisplayValue
			
		REQUEST.COUNTRY is PT and REQUEST.VENDOR_COUNTRY is not PT then
			set value 4117 in PO_TermsOfPaymentKey
			set value 4117 in PO_TermsOfPaymentKey.OldDisplayValue

	with actions
		; ; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
; ----------------------------------------------------------------------------	

;	"26.5.14(MI), please, GSS, can you confirm the business rule for RC Greece?...No value by default is implemented for RC Greece.
;	05-06-2014(RG): rules confirmed
;	
;	04-07-2014 (MC)
;	By default mandatory
;	Values in dropdown are loaded hardcode
;	1)if company code Spain -> default value DAP (if exists)
;	2)if company code Italy -> default value EXW (if exists)
;	3)if company code Portugal/Belgium/Luxemburg -> default value DDP (if exists)
;	4)validation: if empty ->mandatory error message
;	6)if regional country France:
;	 if company 5140 -> DAP
;	 if company 5924/592F->DAP 
;	7)if comapny code 5150 -> CIF"

Entity PO_Incoterms	is DropDownList in frmMain
	with defaults
		label LABELS.labIncoterms
		load data from DATASOURCE.MDM_Incoterms with arguments {"FlagActive" : true}
		mandatory true

	with actions
		; whenever the value of this dropdown list changes, copy the text, not the value to PO_IncotermsPart2
		set value PO_Incoterms.Text in PO_IncotermsPart2
		; ; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  

		set value PO_Incoterms.SelectedText in PO_IncotermsPart2
		set value PO_Incoterms.SelectedText in PO_IncotermsPart2.OldDisplayValue

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE in {VC, VC_CC, VC_PO} and REQUEST.COUNTRY is ES then
			set value "DAP" in PO_Incoterms
			set value "DAP" in PO_Incoterms.OldDisplayValue
			set value PO_Incoterms.SelectedText in PO_IncotermsPart2
			set value PO_Incoterms.SelectedText in PO_IncotermsPart2.OldDisplayValue


		REQUEST.REQUEST_TYPE in {VC, VC_CC, VC_PO} and REQUEST.COUNTRY is IT then
			set value "EXW" in PO_Incoterms
			set value "EXW" in PO_Incoterms.OldDisplayValue
			set value PO_Incoterms.SelectedText in PO_IncotermsPart2
			set value PO_Incoterms.SelectedText in PO_IncotermsPart2.OldDisplayValue

		REQUEST.REQUEST_TYPE in {VC, VC_CC, VC_PO} and REQUEST.COUNTRY in {PT, BE, LU} then
			set value "DDP" in PO_Incoterms
			set value "DDP" in PO_Incoterms.OldDisplayValue
			set value PO_Incoterms.SelectedText in PO_IncotermsPart2
			set value PO_Incoterms.SelectedText in PO_IncotermsPart2.OldDisplayValue

		REQUEST.REQUEST_TYPE in {VC, VC_CC, VC_PO} and REQUEST.COMPANY_CODE is 5140 then
			set value "SAP" in PO_Incoterms
			set value "SAP" in PO_Incoterms.OldDisplayValue
			set value PO_Incoterms.SelectedText in PO_IncotermsPart2
			set value PO_Incoterms.SelectedText in PO_IncotermsPart2.OldDisplayValue

		REQUEST.REQUEST_TYPE in {VC, VC_CC, VC_PO} and REQUEST.COMPANY_CODE is 5150 then
			set value "CIF" in PO_Incoterms
			set value "CIF" in PO_Incoterms.OldDisplayValue
			set value PO_Incoterms.SelectedText in PO_IncotermsPart2
			set value PO_Incoterms.SelectedText in PO_IncotermsPart2.OldDisplayValue

		REQUEST.REQUEST_TYPE in {VC, VC_CC, VC_PO} and REQUEST.PURCHASE_ORGANIZATION in {65G0, 65Q0} then
			set value "FCA" in PO_Incoterms
			set value "FCA" in PO_Incoterms.OldDisplayValue
			set value PO_Incoterms.SelectedText in PO_IncotermsPart2
			set value PO_Incoterms.SelectedText in PO_IncotermsPart2.OldDisplayValue

	with triggers
		this changes

; ----------------------------------------------------------------------------	


;	By default mandatory (ROLES.ENQuirer can change)
;	1)if regional country Spain -> default value DAP (same as incoterms)
;	2)if regional country Italy -> default value EXW (same as incoterms)
;	3)if regional country Portugal/Belgium/Luxemburg -> default value DDP (same as incoterms)
;	4)validation: if empty ->mandatory error message
;	5)if regional country France:
;	 if company 5140 -> France Metropolitaine
;	 if company 5924/5924->Saint Denis
;	6.A)if regonal country Greece-> Athens
;	6.b)when change district in adress-> incoterms2=city2 (district is only visible for company code  greece or vendor country greece)

Entity PO_IncotermsPart2 is TextBox in frmMain
	with defaults
		label LABELS.labIncotermsPart2
		mandatory true

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COMPANY_CODE is 5150 then
			set value "ATHENS" in PO_IncotermsPart2
		REQUEST.COMPANY_CODE is 5150 and GD_Adr_City2 is not empty then
			set value GD_Adr_City2.Value in PO_IncotermsPart2
		REQUEST.COMPANY_CODE in {5924,592F} then
			set value "Saint Denis" in PO_IncotermsPart2
		REQUEST.COMPANY_CODE is 491E and REQUEST.PURCHASE_ORGANIZATION in {65G0, 65Q0} then
			set value "GRENOBLE" in PO_IncotermsPart2
		REQUEST.COMPANY_CODE is 491E and REQUEST.PURCHASE_ORGANIZATION not in {65G0, 65Q0} then
			set value "France Metropolitaine" in PO_IncotermsPart2
		REQUEST.COMPANY_CODE is 5140 then
			set value "France Metropolitaine" in PO_IncotermsPart2
		REQUEST.COUNTRY in {BE,LU} then
			set value "Brussels" in PO_IncotermsPart2.OldDisplayValue
			set value "Brussels" in PO_IncotermsPart2.Value
		REQUEST.COUNTRY is IT then
			set value "VS. MAGAZZINO" in PO_IncotermsPart2.OldDisplayValue
			set value "VS. MAGAZZINO" in PO_IncotermsPart2.Value

; ----------------------------------------------------------------------------	

Entity PO_ConfirmationControl is DropDownList in frmMain
	with defaults
		label LABELS.labConfirmationControl
		visible false
		load data from DATASOURCE.MDM_ConfirmationControl with arguments {"FlagActive" : true}

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COUNTRY is FR and PO_ConfirmationControl.Value is empty then
			set value Y601 in PO_ConfirmationControl
			PO_ConfirmationControl visible true

; ----------------------------------------------------------------------------	

Entity CostCenter is TextBox in frmMain
	with defaults
		label LABELS.labCostCenter
		
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
; ----------------------------------------------------------------------------	

; TODO: THIS TEXTBOX HAS A LOT OF LOGIC
; WHEN IT IS READIER.... PERFORM TESTS
Entity GD_SAPNumber is TextBox in frmMain
	with defaults
		label LABELS.labSAPNumber
		visible false
		; at least one number
		validation "^[0-9]+$"
		max length 10

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.COMPANY_CODE in {5101, 5109, 563M} then 
			GD_SAPNumber mandatory true

; ----------------------------------------------------------------------------	

; TODO: MISSING FUNCTIONALITY HERE ... QUITE SOME OF IT
Entity SAP_Message is TextBox in frmMain
	with defaults
		label LABELS.labSAP_Message
		; TODO: Search for divSAP_Message too...
		visible false

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_STATE is CLOSED then
			this enabled false
			this visible true


; ----------------------------------------------------------------------------	


Entity TS_IsUrgentRequest is CheckBox in frmMain
	with defaults
		label LABES.labUrgentRequest
		value ''
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is VM_BLK or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false

; --- CONTROLS IN BLOCKING DATA TAB -------------------------------------------

; TODO: THE DATASOURCE INDICATED DOES NOT EXIST, CURRENTLY VALUES ARE LOADED IN CODE, SO THE DATASOURCE HAS TO BE CREATED
; VALUES ARE
; "", ""
; "D - Unsubscribe", "D"
; "V - Unsubscribed from CMD", "V"
; which are the same as for GD_Ctr_UnsubscribeCMD
Entity BLK_GD_Ctr_UnsubscribeCMD is DropDownList in frmMain
	with defaults
		label LABELS.labUnsubscribeCMD
		load data from DATASOURCE.MDM_UnsubscribeCMD_Options

	with actions
		set value BLK_GD_Ctr_UnsubscribeCMD.Value in GD_Ctr_UnsubscribeCMD

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is not {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM_BLK then
			enabled true

	with triggers
		; when this controls change, change the value of GD_Ctr_UnsubscribeCMD
		this changes

; ----------------------------------------------------------------------------	

Entity BLK_CC_PT_PaymentBlock is DropDownList in frmMain
	with defaults
		label LABELS.labPTPaymentBlock
		load data from DATASOURCE.MDM_PaymentBlocks with arguments {"FlagActive" : true}

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is not {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM_BLK then
			enabled true
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change

; ----------------------------------------------------------------------------	

Entity BLK_CentralPO is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labCentralPostingBlock
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is not {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM_BLK then
			enabled true
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
; ----------------------------------------------------------------------------	

; this was not even in the field mapping, but is visible false as default, 
; so probably not used...
Entity BLK_24_hour is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labUnBlockFor24Hours
		visible false
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is not {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM_BLK then
			enabled true

; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFB1.SPERR
;	2)SEND data to SAP in field SPERB_B
Entity BLK_CompanyCode is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labUnBlockFor24Hours
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is not {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM_BLK then
			enabled true
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFA1.SPERM
;	2)SEND data to SAP in field SPERM_X
Entity BLK_Central is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labCentrallyPurchasingBlock
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is not {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM_BLK then
			enabled true
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFM1.SPERM
;	2)SEND data to SAP in field SPERM_M
Entity BLK_PO is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labPursachingBlockAtOrganization
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is not {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM_BLK then
			enabled true
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFA1.LOEVM
;	2)SEND data to SAP in field LOEVM_X
Entity BLK_MFD_Central is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_Central
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is not {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM_BLK then
			enabled true
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFB1.LOEVM
;	2)SEND data to SAP in field LOEVM_B
Entity BLK_MFD_CompanyCode is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_CompanyCode
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is not {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM_BLK then
			enabled true
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change

; ----------------------------------------------------------------------------	

; LFA1.LOEVM
; SEND TO SAP IN FIELD LOEVM_M
Entity BLK_MFD_PO is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_PO
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is not {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM_BLK then
			enabled true

	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
; ----------------------------------------------------------------------------	

; LFA1.NODEL
Entity BLK_MFD_DeletionBlockCentral	is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_DeletionBlockCentral
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is not {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM_BLK then
			enabled true
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
; ----------------------------------------------------------------------------	

; not sent to SAP, only retrieve from LFB1.NODEL
Entity BLK_MFD_DeletionBlockCompanyCode	is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_DeletionBlockCompanyCode
	
	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is not {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
			this enable false
		REQUEST.REQUEST_TYPE is VM_BLK then
			enabled true	
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  

	with triggers 
		on change

; --- BUTTON BLOCK -----------------------------------------------------------

; NOTE: REMOVED AS IT IS ALWAYS INVISIBLE
; Entity GD_Ctr_CapCostNumber	is Button in frmMain
; 	with defaults
; 		label LABELS.btnCaptureCostumerNumber
; 		visible false
; 	with rules
; 		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.REQUEST_TYPE is {VM_BLK,VM_UBLK} or REQUEST.CURRENT_ROLE in {ROLES.CPM, ROLES.UPM, ROLES.RCO} then
; 			this enable false
; ----------------------------------------------------------------------------	

; TODO: Pending more stuff
Entity btnSubmit is Button in frmMain
	with defaults
		label LABELS.btnSubmit

	with actions
		set value toupper(GD_Adr_Name.Value) in GD_Adr_Name
		set value toupper(GD_Adr_Name.Value) in    GD_Adr_Name
		set value toupper(GD_Adr_Name2.Value) in   GD_Adr_Name2
		set value toupper(GD_Adr_Name3.Value) in   GD_Adr_Name3
		set value toupper(GD_Adr_Name4.Value) in   GD_Adr_Name4
		set value toupper(GD_Adr_Street.Value) in  GD_Adr_Street
		set value toupper(GD_Adr_Street2.Value) in GD_Adr_Street2
		set value toupper(GD_Adr_Street3.Value) in GD_Adr_Street3
		set value toupper(GD_Adr_Street4.Value) in GD_Adr_Street4
		set value toupper(GD_Adr_Street5.Value) in GD_Adr_Street5
		set value toupper(GD_Adr_City.Value) 	in   GD_Adr_City

	with rules

		REQUEST.REQUEST_STATE is CLOSED then
			this visible false

		REQUEST.REQUEST_STATE is not CLOSED then
			this visible true

		REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false
		
		; --- validations when submitting

		DDLDCReqAction is empty then
			set value MESSAGES.ERRsubmitRequestAction in MESSAGE_POPUP

		
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.CURRENT_ROLE in {ROLES.ENQ,ROLES.CLERK} and CC_PT_PaymentMethods.Value is 2 and REQUEST.BANK_DETAILS is empty then		; 2 means CONFIRMING
			set value MESSAGES.ERRsubmitRequestGDFieldBank in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Ctr_IsNaturalPerson.Value is true and GD_Adr_Country.Value is IT and GD_NatP_DateOfBirth.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldData in MESSAGE_POPUP
	
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Ctr_IsNaturalPerson.Value is true and GD_Adr_Country.Value is IT and GD_NatP_PlaceOfBirth.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldPlace in MESSAGE_POPUP

		; TODO: GD_NatP_Exemption.Visible is true or GD_NatP_Exemption is visible?
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Ctr_IsNaturalPerson.Value is true and GD_Adr_Country.Value is IT and GD_NatP_Exemption.Value and GD_NatP_Exemption.Visible is true is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldExemption in MESSAGE_POPUP
		
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.PHONE_DETAILS is empty and REQUEST.COUNTRY is not BE then
			set value MESSAGES.ERRsubmitRequestGDFieldTelephone in MESSAGE_POPUP
			
		; TODO: HOW TO DEFINE THIS?
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.PHONE_DETAILS is not empty and REQUEST.PHONE_DETAILS.NO_DEFAULT_ENTRY is true then
			set value MESSAGES.ERRsubmitRequestGDFieldPhone in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and PO_ReturnsVendor.Value is true and GD_Ctr_CustomerNumber.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldCustomerNum in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.CURRENT_ROLE is ROLES.CLERK and GD_Procur_Supplier_ExpectedPVO >= 3 and REQUEST.COUNTRY is not IT and GD_PVO_Question1.Value is 0 then
			set value 'To submit the request fill all the mandatory fields: in General Data view the Procurement Data question 1 is empty' in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.CURRENT_ROLE is ROLES.CLERK and GD_Procur_Supplier_ExpectedPVO >= 3 and REQUEST.COUNTRY is not IT and GD_PVO_Question2.Value is 0 then
			set value 'To submit the request fill all the mandatory fields: in General Data view the Procurement Data question 2 is empty' in MESSAGE_POPUP
			
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.CURRENT_ROLE is ROLES.CLERK and GD_Procur_Supplier_ExpectedPVO >= 3 and REQUEST.COUNTRY is not IT and GD_PVO_Question3.Value is 0 then
			set value 'To submit the request fill all the mandatory fields: in General Data view the Procurement Data question 3 is empty' in MESSAGE_POPUP
	
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.CURRENT_ROLE is ROLES.CLERK and GD_Procur_Supplier_ExpectedPVO >= 3 and REQUEST.COUNTRY is not IT and GD_PVO_Question4.Value is 0 then
			set value 'To submit the request fill all the mandatory fields: in General Data view the Procurement Data question 4 is empty' in MESSAGE_POPUP
	
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.CURRENT_ROLE is ROLES.CLERK and GD_Procur_Supplier_ExpectedPVO >= 3 and REQUEST.COUNTRY is not IT and GD_PVO_Question5.Value is 0 then
			set value 'To submit the request fill all the mandatory fields: in General Data view the Procurement Data question 5 is empty' in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.VENDOR_COUNTRY in {FR,GP,YT,MC,RE,MQ,GF} and REQUEST.BANK_DETAILS > 0 and REQUEST.BANK_DETAILS.FIRST.GD_VB_COUNTRY in {FR,GP,YT,MC,RE,MQ,GF} and CC_PT_PaymentMethods.Value is Y then
			set value ERRsubmitRequestCCFieldPaymentMethodInvalid in MESSAGE_POPUP
	
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.VENDOR_COUNTRY in {FR,GP,YT,MC,RE,MQ,GF} and REQUEST.BANK_DETAILS > 0 and REQUEST.BANK_DETAILS.FIRST.GD_VB_COUNTRY not in {FR,GP,YT,MC,RE,MQ,GF} and CC_PT_PaymentMethods.Value is G then
			set value ERRsubmitRequestCCFieldInformPaymentInvalid in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.VENDOR_COUNTRY not in {FR,GP,YT,MC,RE,MQ,GF} and CC_PT_PaymentMethods.Value is G then
			set value ERRsubmitRequestCCFieldInformPaymentInvalid in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and CC_PT_ValidityDate.Value is not empty and CC_PT_ValidityDate.Value < DATE.TODAY then
			set value ERRsubmitRequestCCFielddateInv in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Country.Value is IT and GD_Ctr_CF is not empty and GD_Ctr_CF.Length < 9 then
			set value ERRsubmitRequestGDFieldCFShort in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Country.Value is PT and GD_Ctr_CF is not empty and GD_Ctr_CF.Length < 9 then
			set value ERRsubmitRequestGDFieldNIFShort in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Country.Value is IT and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_CF is empty and REQUEST.REQUEST_TYPE is VC then
			set value ERRsubmitRequestGDFieldCFEmpty in MESSAGE_POPUP
					   
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Ctr_VendorClassification.Value is empty then
			set value ERRsubmitRequestRHFieldVClass in MESSAGE_POPUP
					   
		REQUEST.REQUEST_TYPE in {VC,CC} and GD_Procur_SuppliersName is empty then			   
			set value ERRsubmitRequestRHFieldName in MESSAGE_POPUP
		
		REQUEST.REQUEST_TYPE in {VC,CC} and GD_Procur_ESNCode is empty then		   
			set value ERRsubmitRequestRHFieldESN in MESSAGE_POPUP			   
		
		REQUEST.REQUEST_TYPE in {VC,CC} and GD_Procur_Reason_Justification is empty then		   
			set value ERRsubmitRequestRHFieldJustification in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE in {VC,CC} and GD_Procur_GoodsToSiemens is empty then		   
			set value ERRsubmitRequestRHFieldGoods in MESSAGE_POPUP
		
		REQUEST.REQUEST_TYPE in {VC,CC} and GD_Procur_Supplier_ExpectedPVO is empty then		   
			set value ERRsubmitRequestRHFieldExpected in MESSAGE_POPUP			   
		
		REQUEST.REQUEST_TYPE in {VC,CC} and GD_Procur_Supplier_IsOneTimeVendor is empty then		   
			set value ERRsubmitRequestRHFieldOccasionalV in MESSAGE_POPUP			   

		REQUEST.REQUEST_TYPE in {VC,CC} and E_GD_VE_Grid is empty then		   
			set value ERRsubmitRequestRHFieldOccasionalV in MESSAGE_POPUP			   
		
		; REQUEST.CURRENT_ROLE in {ROLES.ENQ,ROLES.CLERK}

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Name.Value is empty then
			set value ERRsubmitRequestGDFieldVName in MESSAGE_POPUP	
					   
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Street.Value is empty then
			set value ERRsubmitRequestGDFieldVStreet in MESSAGE_POPUP
						   
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Region.Value is empty then
			set value ERRsubmitRequestGDFieldVRegion in MESSAGE_POPUP		
				   
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_City.Value is empty then
			set value ERRsubmitRequestGDFieldVCity in MESSAGE_POPUP			   
		
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Com_LanguageCode.Value is empty then
			set value ERRsubmitRequestGDFieldLanguage in MESSAGE_POPUP			   
		
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Com_Telebox.Value is empty and REQUEST.VENDOR_COUNTRY is WF then
			set value 'To submit the request fill all the mandatory fields: in General Data view the field Telebox is empty' in MESSAGE_POPUP			   
		
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Country.Value is not IT and REQUEST.ACCOUNT_GROUP not in {YCT6, YVT6} and GD_Ctr_TaxCode1.Value is empty and GD_Ctr_TaxCode1.IsFieldMandatory and REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} then
			set value ERRsubmitRequestGDFieldTaxCode1 in MESSAGE_POPUP			   
		
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Country.Value is PT and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_TaxCode1.Length < 9 then
			set value ERRsubmitRequestGDFieldTaxCode1Inv in MESSAGE_POPUP			   
		
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Country.Value is PT and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_TaxCode1.Length < 9 and REQUEST.COMPANY_CODE is 5240 and GD_Ctr_NIF.Value starts with {1,2} then
			; TODO: change label GD_Ctr_TaxCode2 to "NISS"
			; TODO: change label GD_NatP_PlaceOfBirth to "Nº Employees"
			set value ERRsubmitRequestRHFieldOccasionalV in MESSAGE_POPUP			   
		
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Country.Value is PT and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_TaxCode1.Length < 9 and REQUEST.COMPANY_CODE is 5240 and GD_Ctr_NIF.Value starts with {1,2} and GD_Ctr_TaxCode2 is empty then
			set value ERRsubmitRequestGDFieldNISS in MESSAGE_POPUP

		; TODO:                 if ( String.IsNullOrEmpty ( this.GD_NatP_PlaceOfBirth.Text ) || !int.TryParse ( this.GD_NatP_PlaceOfBirth.Text, out i ) )
        ;                       Error = Error + ( "To submit the request fill all the mandatory fields: in General Data view the field Nº Employees is mandatory and must be numeric.<br/> " );

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Country.Value is not IT and REQUEST.ACCOUNT_GROUP not in {YVT6, YVT9, YCT6, YCT9} and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_TaxCode2 is empty and GD_Ctr_TaxCode2 is mandatory then
			set value ERRsubmitRequestGDFieldTaxCode2Empty in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Country.Value is not IT and REQUEST.ACCOUNT_GROUP not in {YVT6, YVT9, YCT6, YCT9} and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_VATRegistrationNumber is empty and GD_Ctr_VATRegistrationNumber is mandatory then
			set value ERRsubmitRequestGDFieldVatReg in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Country.Value is IT and GD_Ctr_IsNaturalPerson.Value is true then
			GD_Ctr_TaxCode1 mandatory true
			GD_Ctr_TaxCode2 mandatory false

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Country.Value is IT and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_TaxCode1.Value is empty then
			set value ERRsubmitRequestGDFieldTaxCode1Empty in MESSAGE_POPUP			   

		; TODO: how to include this WEBSERVICE call in a condition like this?
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_POBox.Value is not empty and WEBSERVICE.VALIDATE_POSTAL_CODE with arguments {} and GD_Adr_Country.Value is not GR and REQUEST.ACCOUNT_GROUP not in {YVT6, YVT9, YCT6, YCT9} then
			set value ERRsubmitRequestGDPOinv in MESSAGE_POPUP			   
		
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Adr_Name.Value is empty then
			set value ERRsubmitRequestRHFieldOccasionalV in MESSAGE_POPUP			   


		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.CURRENT_ROLE in {ROLES.ENQ, ROLES.CLERK} and F_GD_VF_Grid.HasRows is true and F_GD_VF_Grid.HasDefaultRow is false then
			; TODO: DEFINE THESE THINGS
			; meaning, there must be one selected default row in the grid if there are rowsLERKC and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_PIVA.Value is empty and 	GD_Ctr_PIVA is mandatory then
			set value ERRsubmitRequestGDFieldSIRET in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.VENDOR_COUNTRY in {FR,GF,GP,RE,MQ,YT,NC,PF,PM,WF,MC,TF} and REQUEST.REQUEST_TYPE is VC and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_PIVA.Length is not 14 then
			set value ERRsubmitRequestGDFieldSIRET_14 in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.VENDOR_COUNTRY in {FR,GF,GP,RE,MQ,YT,NC,PF,PM,WF,MC,TF} and REQUEST.REQUEST_TYPE is VC and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_VATRegistrationNumber.Value is empty and GD_Ctr_VATRegistrationNumber is mandatory then
			set value "To submit the request fill all the mandatory fields: in General Data view the field VAT number is empty" in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.VENDOR_COUNTRY in {FR,GF,GP,RE,MQ,YT,NC,PF,PM,WF,MC,TF} and REQUEST.REQUEST_TYPE is VC and GD_Adr_POBoxLoc.Value is empty and GD_Adr_POBoxLoc is mandatory then
			set value ERRsubmitRequestPOBOXinformed in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.VENDOR_COUNTRY in {FR,GF,GP,RE,MQ,YT,NC,PF,PM,WF,MC,TF} and REQUEST.CURRENT_ROLE is ROLES.CLERK and GD_Ctr_GFORM.Value is empty and GD_Ctr_GFORM is mandatory then
			set value ERRsubmitRequestFieldLegalForm in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_SAPNumber.Visible is true and DDLDCReqAction.Value is STATES.SUBMITTED and REQUEST.COUNTRY in {BE,LU} and GD_SAPNumber.Value is empty then
			set value ERRsubmitRequestRHFieldSAPNEmpty in MESSAGE_POPUP
			
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_SAPNumber.Visible is true and DDLDCReqAction.Value is STATES.SUBMITTED and REQUEST.COUNTRY is BE and GD_SAPNumber.Value is not empty and GD_SAPNumber.Value < 1000000000 or GD_SAPNumber.Value > 1999999999 then
			set value ERRsubmitRequestRHFieldSAPInv in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_SAPNumber.Visible is true and DDLDCReqAction.Value is STATES.SUBMITTED and REQUEST.COUNTRY is LU and GD_SAPNumber.Value is not empty and GD_SAPNumber.Value < 2000000000 or GD_SAPNumber.Value > 2999999999 then
			set value ERRsubmitRequestRHFieldSAPInv2 in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and CC_AM_WithholdingTaxCode is mandatory and CC_AM_WithholdingTaxCode.Value is empty then
			set value "To submit the request, please choose a Withholding Tax Code in the Company Code Tab" in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and REQUEST.COUNTRY is IT and CC_AM_SubjectedToWHTax.Value is true and CC_AM_WithholdingTaxCode.Value is empty then
			set value "To submit the request, please choose a Withholding Tax Code in the Company Code Tab" in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Damex is mandatory and GD_Damex.Value is empty then
			set value "To submit the request fill all the mandatory fields: in Request Header view the field Damex E is empty" in MESSAGE_POPUP
		
		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and GD_Damex.Value is true and ATTACHMENT.Count is 0 then
			set value "To submit the request fill all the mandatory fields: insert at least one attachment" in  MESSAGE_POPUP

		REQUEST.CURRENT_ROLE is ROLES.ENQ and REQUEST.REQUEST_TYPE is VC and DDLDCComment.Value is empty then
			 set value ERRsubmitRequestComment in  MESSAGE_POPUP

		DDLDCComment.Value is not empty and DDLDCComment.Length > 2000 then
			 set value ERRcommentLenght in  MESSAGE_POPUP

		; some greece specific rules
		REQUEST.REQUEST_TYPE in {VC,CC} and GD_Adr_Country.Value is GR and GD_Adr_Name3.Value and is empty then
			set value ERRsubmitRequestGDFieldName3 in MESSAGE_POPUP
		
		REQUEST.REQUEST_TYPE in {VC,CC} and GD_Adr_Country.Value is GR and GD_Adr_Name4.Value is empty then
			set value ERRsubmitRequestGDFieldName4 in MESSAGE_POPUP

		GD_Adr_Country.Value is GR and GD_Ctr_IsNaturalPerson.Value is true and CC_AM_WithholdingTaxCode is mandatory and CC_AM_WithholdingTaxCode.Value is empty then
			set value ERRsubmitRequestCCWithholding in MESSAGE_POPUP
		
		GD_Adr_Country.Value is GR and and GD_Ctr_TaxCode2.Value is empty then
			set value "To submit the request fill all the mandatory fields: in General Data view the field TaxCode2 is empty" in MESSAGE_POPUP

		GD_Adr_Country.Value is GR and and GD_Ctr_TaxCode2.Value is not empty and GD_Ctr_TaxCode2.Length < 9 then
			set value "To submit the request fill all the mandatory fields: in General Data view the field TaxCode2 should have 9 characters" in MESSAGE_POPUP

		GD_Adr_Country.Value is GR and and PO_Incoterms.Value is empty then
			set value ERRsubmitRequestPOFieldIncoterms in MESSAGE_POPUP

		GD_Adr_Country.Value is GR and and PO_Incoterms2.Value is empty then
			set value ERRsubmitRequestPOFieldIncoterms2 in MESSAGE_POPUP

		GD_Adr_Country.Value is GR and GD_Adr_City2.Value is empty and GD_Adr_City2 is mandatory then
			set value ERRsubmitRequestGDFieldDistrict in MESSAGE_POPUP

		CC_AM_BPClassification.Value is empty then
			set value "To submit the request fill all the mandatory fields: in Header Request view the field Business Partner Classification is empty" in MESSAGE_POPUP

		REQUEST.COUNTRY is ES and CC_PT_PaymentMethods.Value is 2 and CC_PT_HouseBank.Value is empty then 
			set value ERRsubmitRequestCCHouseBank in MESSAGE_POPUP
			
		CC_AM_SortKey.Value is empty then
			set value ERRsubmitRequestCCFieldSortKey in MESSAGE_POPUP

		CC_PT_PaymentTerms is visible and CC_PT_PaymentTerms.Value is empty then 
			set value ERRsubmitRequestCCFieldPaymentTerm in MESSAGE_POPUP

		REQUEST.COUNTRY is ES and CC_DD_DunningProcedure.Value is not empty and CC_DD_LegalProceedings.Value is empty then
			set value ERRsubmitRequestCCFieldLegalDunnig in MESSAGE_POPUP

		REQUEST.COUNTRY not in {IT, PT} and REQUEST.CURRENT_ROLE in {ROLES.ENQ,ROLES.CLERK} and CC_PT_PaymentMethods is mandatory and CC_PT_PaymentMethods.Value is empty then
			set value ERRsubmitRequestCCViewFieldPaymentMethod in MESSAGE_POPUP
	 
		PO_PurchaseOrderCurrency.Value is empty and REQUEST.COMPANY_CODE is 563M then
			set value "To submit the request fill all the mandatory fields: in Purchase Organization Data view the field Purchase Order Currency is empty" in MESSAGE_POPUP

		PO_TermsOfPaymentKey.Value is empty and REQUEST.COMPANY_CODE is 563M then
			set value "To submit the request fill all the mandatory fields: in Purchase Organization Data view the field Terms of Payment Key is empty" in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE not in {VM_BLK, VM_UBLK} and CC_AM_BPClassification.Value is empty then
			set value ERRsubmitRequestValuePartnerRisk in MESSAGE_POPUP

		REQUEST.REQUEST_TYPE is VC then
			ATTACHMENT mandatory true

		; TODO: PENDING ALL THE MANDATORY ATTACHMENT EVAULATION ....


		GD_Adr_PostalCode.Value is empty and REQUEST.ACCOUNT_GROUP in {YVT6,YVT9,YCT6,YCT9} and GD_Adr_Region.Value not in {75,2A,2B} and GD_Adr_Region.Value is not SUBSTRING(GD_Adr_PostalCode.Value,0,2) then
			set value ERRsubmitRequestGDPostalCode in MESSAGE_POPUP

		GD_Adr_PostalCode.Value is empty and REQUEST.ACCOUNT_GROUP in {YVT6,YVT9,YCT6,YCT9} and GD_Adr_Region.Value is 75 and SUBSTRING(GD_Adr_PostalCode.Value,0,2) is not 00 then
			set value ERRsubmitRequestGDPostalCode in MESSAGE_POPUP

		GD_Adr_PostalCode.Value is empty and REQUEST.ACCOUNT_GROUP in {YVT6,YVT9,YCT6,YCT9} and GD_Adr_Region.Value in {2A, 2B} and SUBSTRING(GD_Adr_PostalCode.Value,0,2) is not 20 then
			set value ERRsubmitRequestGDPostalCode in MESSAGE_POPUP

		GD_Adr_CountryGD.Value is ES and GD_Adr_PostalCode.Length is not 5 and GD_Adr_PostalCode.Value >= 53000 then
			set value ERRspanishPostalCode in MESSAGE_POPUP

		GD_Adr_CountryGD.Value is GR and GD_Adr_PostalCode.Length is not 5  then
			set value ERRsubmitRequestGDPostalCode in MESSAGE_POPUP
		
		GD_Adr_CountryGD.Value is IT and GD_Adr_PostalCode.Length is not 5 then 
			set value ERRitalianPostalCode in MESSAGE_POPUP

		GD_Adr_CountryGD.Value is PT and GD_Adr_PostalCode.Length is not 8 then
			set value ERRportughesePostalCode in MESSAGE_POPUP

		; TODO: HOW TO EXPRESS PORTUGAL POST CODE 9999-999 other than with regulat expressions
		; TODO: something like 
		; GD_Adr_CountryGD.Value is PT and GD_Adr_PostalCode.Length is not 8 then

		; TODO: THINK ABOUT THIS ONE ADD IN_RANGE OPERATOR?
		GD_Adr_CountryGD.Value is BE and GD_Adr_Region.Value is 01 and GD_Adr_PostalCode.Value is number and GD_Adr_PostalCode.Value not in range {1500,3999} or GD_Adr_PostalCode.Value not in range {8000,9999} then 
			set value ERRregionCode in MESSAGE_POPUP

		GD_Adr_CountryGD.Value is BE and GD_Adr_Region.Value is 02 and GD_Adr_PostalCode.Value is number and GD_Adr_PostalCode.Value not in range {1300,1499} or GD_Adr_PostalCode.Value not in range {4000,7999} then 
			set value ERRregionCode in MESSAGE_POPUP

		GD_Adr_CountryGD.Value is BE and GD_Adr_Region.Value is 03 and GD_Adr_PostalCode.Value is number and GD_Adr_PostalCode.Value not in range {1000,1299} then
			set value ERRregionCode in MESSAGE_POPUP

		GD_Adr_CountryGD.Value is LU and GD_Adr_PostalCode.Length is not 4 then
			set value ERRsubmitRequestGDPostalCode in MESSAGE_POPUP
		
		GD_Adr_Country.Value is GR and GD_Adr_POBoxPostalCode.Value is not empty and GD_Adr_POBoxPostalCode.Length is not 5 then 
			set value ERRsubmitRequestGDPOBoxValid in MESSAGE_POPUP

		GD_Adr_Country.Value is GR and GD_Adr_POBoxPostalCode is mandatory and GD_Adr_POBoxPostalCode.Value is empty then
			set value ERRsubmitRequestGDPOBox in MESSAGE_POPUP

		GD_SAPNumber is Visible and DDLDCReqAction.Value is SUBMITTED and GD_Adr_CountryGD.Value is BE and REQUEST.REQUEST_TYPE is VC and GD_SAPNumber.Value is empty then
			set value ERRsubmitRequestRHFieldSAP in MESSAGE_POPUP

		GD_SAPNumber is Visible and DDLDCReqAction.Value is SUBMITTED and GD_Adr_CountryGD.Value is BE and REQUEST.REQUEST_TYPE is VC and GD_SAPNumber.Value is not empty and GD_SAPNumber.Value not in range {1000000000,1999999999} then
			set value ERRsubmitRequestRHFieldSAPInv in MESSAGE_POPUP

		GD_SAPNumber is Visible and DDLDCReqAction.Value is SUBMITTED and GD_Adr_CountryGD.Value is LU and REQUEST.REQUEST_TYPE is VC and GD_SAPNumber.Value is empty then
			set value ERRsubmitRequestRHFieldSAP in MESSAGE_POPUP									
																									
		GD_SAPNumber is Visible and DDLDCReqAction.Value is SUBMITTED and GD_Adr_CountryGD.Value is LU and REQUEST.REQUEST_TYPE is VC and GD_SAPNumber.Value is not empty and GD_SAPNumber.Value not in range {2000000000,2999999999} then
			set value ERRsubmitRequestRHFieldSAPInv2 in MESSAGE_POPUP

		CC_AM_WithholdingTaxCode is mandatory and CC_AM_WithholdingTaxCode.Value is empty then
			set value ERRsubmitRequestCCTaxCode in MESSAGE_POPUP

		REQUEST.COUNTRY is IT and CC_AM_WithholdingTaxCode.Value is empty then
			set value ERRsubmitRequestCCTaxCode in MESSAGE_POPUP

		GD_Damex is mandatory and GD_Damex.Value is emtpy then
			set value ERRsubmitRequestRHFieldDamexE in MESSAGE_POPUP

		GD_Damex.Value is true and ATTACHMENT.Count is 0 then
			set value ERRsubmitRequestAttachment in MESSAGE_POPUP

		REQUEST.CURRENT_ROLE is ROLES.ENQ and REQUEST.REQUEST_TYPE is not VC and DDLDCComment.Value is empty then
			set value ERRsubmitRequestComment in MESSAGE_POPUP

		DDLDCComment.Value is not empty and DDLDCComment.Length > 2000 then 
			set value ERRcommentLenght in MESSAGE_POPUP


		; TODO: ValidateBankDetails

		; TODO: CalculateExternalNumber

		
	with triggers

		this on click
			
; ----------------------------------------------------------------------------	
		
Entity btnClose	is Button in frmMain
	with defaults
		label LABELS.btnClose


; ----------------------------------------------------------------------------	

Entity btnSCClose is Button in frmMain
	with defaults
		label LABELS.btnClose

	with rules
		REQUEST.REQUEST_STATE is not CLOSED and btnSubmit.Visible is true then
			this visible true

		btnClose.Visible is true then
			this visible false
		else
			this visible true


; ----------------------------------------------------------------------------	

Entity btnBack2 is Button in frmMain
	with defaults
		label LABELS.btnBack

	with rules
		REQUEST.REQUEST_STATE is CLOSED then
			this visible false

; ----------------------------------------------------------------------------	

Entity btnSave is Button in frmMain
	with defaults
		label LABELS.btnSave

	with actions
		this enable false

	with rules
		REQUEST.STATE in {STATE.LOCKED, STATE.CLOSED} or REQUEST.CURRENT_ROLE in {ROLES.UPM, ROLES.CPM, ROLES.RCO} then
			this enable false	
		else
			this enable true

	with triggers
		this on click

; ----------------------------------------------------------------------------	

Entity btnCloseFinal is Button in frmMain
	with defaults
		label LABELS.btnClose

	with rules
		REQUEST.CURRENT_ROLE is ROLES.CLERK then
			this visible true
		else
			this visible false


; --- WORKFLOW RELATED CONTROLS ----------------------------------------------

; TODO: OMFG - THIS IS GOING TO BE A MESS - THIS NEEDS MORE STUFF.....
Entity DDLDCReqAction is DropDownList in frmMain
	with defaults
		mandatory true
		label LABELS.labSR_Action

		; TODO: the dataloading seems too complex
		; DDLDCReqAction.DataSource = _w4e.W4E_StateMap.Where ( GetActionFilter ( _sessionInfo.CurrentBPCode, flowtype, GeneralRequestData.WFRoleCode, GeneralRequestData.WFStatusCode, Evaluator ) );
		; Evaluator?????
        load data from DATASOURCE.W4E_StateMap with arguments {"BPCode" : REQUEST.BP_CODE, "FlowType" : REQUEST.REQUEST_TYPE, "CurrentRole" : REQUEST.CURRENT_ROLE, "Status" : REQUEST.REQUEST_STATUS }

	with rules

		REQUEST.REQUEST_STATE is CLOSED then
			this visible false

		REQUEST.COUNTRY is LU or REQUEST.COUNTRY is IT then
			; this needs a TEST and inclusion in the GRAMMAR
			; remove value 'Info Requested to ROLES.UPM' from DDLDCReqAction

		REQUEST.COUNTRY in {ES,IT,BE,LU} then
			remove "Info Requested to CPM" in DDLDCReqAction.Items

		REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false

	; with triggers
	; 	this.value changes

; ----------------------------------------------------------------------------	


; in spite of the name 'labNextRole' this is correct
; TODO: The data loading of this, is a total mess
Entity labNextRole is DropDownList in frmMain
	with defaults
		label LABELS.NextRole

	with rules
		REQUEST.REQUEST_STATE is CLOSED then
			this visible false

; ----------------------------------------------------------------------------	


; in spite of the name 'labNextAction' this is correct
; has no text label
Entity labNextAction is DropDownList in frmMain
	with defaults

	with rules
		REQUEST.REQUEST_STATE is CLOSED then
			this visible false

; ----------------------------------------------------------------------------	

; --- LIST OF PURCHASE ORGANIZATION SELECTION IN THE PURCHASE ORG TAB --------

Entity PO_lbxPODPursacheOrganization1 is ListBox in frmMain
	with defaults
		; this means load all purchase organizations for the company code except the current purchase organization
		; which is already loaded
		load data from DATASOURCE.MDM_ClusterPurchaseOrganizations with arguments {"CompanyCode" : REQUEST.COMPANY_CODE, "ExcludePurchaseOrganization" : REQUEST.PURCHASE_ORGANIZATION}

; ----------------------------------------------------------------------------	

Entity PO_lbxPODPursacheOrganization2 is ListBox in frmMain

; ----------------------------------------------------------------------------	

Entity btnPODAll is Button in frmMain
	with defaults
		label LABELS.lab_____		; this label is actually this -->    >>

; ----------------------------------------------------------------------------	

Entity PO_btnPODSelect is Button in frmMain
	with defaults
		label LABELS.lab_____		; this label is actually this -->    >

; ----------------------------------------------------------------------------	

Entity PO_btnPODRemove is Button in frmMain
	with defaults
		label LABELS.lab_____		; this label is actually this -->    <

; ----------------------------------------------------------------------------	

Entity btnPOClear is Button in frmMain
	with defaults
		label LABELS.lab_____		; this label is actually this -->    <<

; ----------------------------------------------------------------------------	



; --- the fucking end --------------------------------------------------------





