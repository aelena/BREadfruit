; -- RULES FOR VENDOR SEARCH FORM 

Entity TBVendorName is TextBox in frmSearch
	with defaults
		enabled true
		visible
		value   ''
		label LABELS.VENDOR.NAME


	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid

	with rules
		
	with triggers
		TBVendorName.value changes

; ----------------------------------------------------------------------------	

Entity TBVendorCity is TextBox in frmSearch
	with defaults
		visible true
		value ""
		label LABELS.VENDOR.CITY

	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid

	with triggers
		this.value on change


; ----------------------------------------------------------------------------	

Entity TBVendorNumber is TextBox in frmSearch
	with defaults
		visible true
		value ''
		max length 10
		min length 10
		label LABELS.VENDOR.NUMBER

	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid

	with rules
		; show this message "This partner is not managed by Madam. Please contact GSS master data team." if starting with 0
		TBVendorNumber.text starts with '0' then
			set value MESSAGES.VALIDATIONS.SEARCH.NOTMANAGED in ErrorMessage
		TBVendorNumber.text not starts with '0' then
			set value '' in ErrorMessage

	with triggers
		this.value changes

	with constraints
		only numbers
			
; ----------------------------------------------------------------------------	

Entity TBVendorIFA is TextBox in frmSearch
	with defaults
		visible true
		value ''
		label LABELS.VENDOR.TAXCODE4

	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid
	
	with rules
		; should this be moved to rules for the btnSearch button? maybe.....
		DDLVDCountry.value not is '' then DDLVDCountry not mandatory
		DDLVDCountry.value is '' then DDLVDCountry mandatory


	with triggers
		this.value changes
		
; ----------------------------------------------------------------------------	


 Entity DDLVDCountry is DropDownList in frmSearch
	with defaults
		visible true
		value USER.COUNTRY		; preselect user country if there is data in SCD for this user
		mandatory true
		load data from DATASOURCE.ENTERPRISE.WORLD_COUNTRIES
		label LABELS.GENERIC.COUNTRY

	with actions
		set value '' in ErrorMessage
		hide vendorSearchResultGrid
		hide btnCreateVendor
		load data from DATASOURCE.ENTERPRISE.WORLD_COUNTRIES ;{"Country":"ES","Active":true }


	with rules
		DDLVDCountry.value in {"FR","GF","GP","RE","MQ","YT","NC","PF","PM","WF","MC"} then set value LABELS.VENDOR.SPECIFICLOCALIZED.SIRET in TBVendorVAT
		DDLVDCountry.value in {"PT","ES"} then set value LABELS.VENDOR.SPECIFICLOCALIZED.NIF in TBVendorVAT
		DDLVDCountry.value is "IT" then set value LABELS.VENDOR.SPECIFICLOCALIZED.PARTITAIVA in TBVendorVAT
		DDLVDCountry.value not in {"PT","ES","IT","FR","GF","GP","RE","MQ","YT","NC","PF","PM","WF","MC"} then set value "VAT" in TBVendorVAT
	
	with triggers
		this.value changes 

; ----------------------------------------------------------------------------	

Entity TBVendorVAT is TextBox in frmSearch
	with defaults
		visible true
		value ''
		label LABELS.GENERIC.VAT

	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid

	with triggers
		this.value changes
		
; ----------------------------------------------------------------------------	


Entity DDLCDCountry is DropDownList in frmSearch
	with defaults
		visible true
		; we need to define these things too, let's calle them "data constants" for now...
		value User.Country
		load data from DATASOURCE.ACTIVE_COUNTRIES
		label LABELS.GENERIC.COUNTRY
	
	with actions
		; load active companies for this country
		load data from DATASOURCE.ACTIVE_CCs with arguments {"Country" : this.value} in DDLCDCompany
		; purge the data in this dropdownlist
		clear DDLCDPurchOrg

	with triggers
		this.value changes

; ----------------------------------------------------------------------------	


Entity DDLCDCompany is DropDownList in frmSearch
	with defaults
		visible true
		value USER_COST_LOCATION_UNIT			; another data constant
		label LABELS.GENERIC.COMPANY

	with actions
		; load active companies for this country
		load data from DATASOURCES.ACTIVE_POs with arguments {"Arg1": this.value} in DDLCDPurchOrg 

	with triggers
		this.value changes

; ----------------------------------------------------------------------------	


Entity DDLCDPurchOrg is DropDownList in frmSearch
	with defaults
		visible true
		value ''
		label LABELS.GENERIC.PURCHASEORG
		

; ----------------------------------------------------------------------------	

Entity btnSearch is Button in frmSearch
	with defaults
		visible true
		label LABELS.BUTTONS.SEARCH

	with actions
		; missing defining arguments here...
		load data from WEBSERVICE.SEARCH_VENDORS with arguments {"A" : "B"} in grid
		; this means the database has to be asked to see if current user has permissions for the selected combination
		; of COUNTRY + COMPANY + PURCHASE ORG. If the user has permission, then go ahead, but if not
		; show an error message or popup
		; maybe this has to be defined a bit better
		; would this be DATASOURCE or maybe WEBSERVICE call?
		; what properties should be passed to identify the user? or shall this be somehow managed or injected by environment?
		load data from DATASOURCE.USER_HAS_PERMISSIONS with arguments {"User" : USER.USER_ID, "Country" : DDLCDCountry, "Company" : DDLCDCompany, "PurchaseOrg" : DDLCDPurchOrg} in ErrorMessage
		

	with rules
		
		TBVendorIFA.value is not empty then DDLVDCountry mandatory

		DDLVDCountry is empty then
			set value MESSAGES.VALIDATIONS.SEARCH.FILL01 in ErrorMessage
		
		TBVendorName is empty and TBVendorCity is empty and TBVendorIFA is empty then
			set value MESSAGES.VALIDATIONS.SEARCH.FILL01 in ErrorMessage
	
		TBVendorName is empty and TBVendorCity is empty and TBVendorIFA is empty and DDLVDCountry is empty and TBVendorVAT is empty then
			set value MESSAGES.VALIDATIONS.SEARCH.FILL02 in ErrorMessage
		
		TBVendorName is empty and TBVendorCity is not empty and TBVendorName is empty and TBVendorIFA is empty and DDLVDCountry is empty and TBVendorVAT is empty then
			set value MESSAGES.VALIDATIONS.SEARCH.FILL01 in ErrorMessage
	
		DDLCDCountry is empty or DDLCDCompany is empty or DDLCDPurchOrg is empty then
			set value MESSAGES.VALIDATIONS.SEARCH.FILL03 in ErrorMessage
		
		TBVendorName is not empty and DDLVDCountry is empty then
			set value MESSAGES.VALIDATIONS.SEARCH.FILL01 in ErrorMessage

		TBVendorIFA.value is not empty then DDLVDCountry not mandatory

		TBVendorIFA.value is not empty then DDLVDCountry mandatory
						

	with triggers

		this on click

; ----------------------------------------------------------------------------	

Entity btnCreateVendor is Button in frmSearch
	with defaults
		visible false
		label LABELS.BUTTONS.CREATEVENDOR

	with actions
		; transition to the main form
		; guess we will have to pass some arguments here and map things to the conceptual model
		; this works already anyway
		change form to frmMain with arguments {"A" : "B"}

	with rules
		; how to specify all that happens server side here?
		; shall be express something like change form?

	with triggers
		this click

; ----------------------------------------------------------------------------	

Entity vendorSearchResultGrid is Grid in frmSearch
	with defaults
		visible false
	

	; TODO: DEFINE CONVENTIONS FOR GRID BETTER

; ----------------------------------------------------------------------------	
; BEGIN MAIN FORM CONTROL DEFINITION
; ----------------------------------------------------------------------------	

; -- RULES FOR VENDOR MAIN FORM (MDM.ASPX)


Entity GD_Ctr_RiskClassification is DropDownList in frmMain

	with defaults
		enabled true
		visible true
		value "00"
		; only two values, 00 and 09
		load data from DATASOURCE.RISK_CLASSIFICATIONS
		label LABELS.VENDOR.RISK_CLASSIFICATION

	with rules
		CURRENT_ROLE not in {"RCO","ENQ","CLERK"} then enabled false

	with triggers
		; TODO FIND A BETTER WAY TO EXPRESS THIS....
		; BANK_INSERTED EVALUATE -----

; ----------------------------------------------------------------------------	


Entity GD_Adr_Country is DropDownList in frmMain

	with defaults
		visible true
		enabled false					; this control is always disabled
		value USER.COUNTRY				; -- depends on country selected in search form, so this data has to be passed
		load data from DATASOURCE.WORLD_COUNTRIES
		mandatory true
		label LABELS.GENERIC.COUNTRY

; ----------------------------------------------------------------------------	

Entity GD_Ctr_VendorClassification is DropDownList in frmSearch

	with defaults
		visible true
		enabled true
		value "NG"
		; values G  and NG
		load data from DATASOURCE.VENDOR_CLASSIFICATIONS
		mandatory true
		label LABELS.VENDOR.VENDOR_CLASSIFICATION

	with rules
		CURRENT_ROLE in {"UPM", "CPM"} then enabled false
		Vendor.Country is "ES" and GD_Ctr_TaxCode1.Text starts with {"P","Q","S"} then set value "G" in GD_Ctr_VendorClassification
		Vendor.Country is "ES" and GD_Ctr_TaxCode1.Text starts with "X" then set value "NG" in GD_Ctr_VendorClassification

; ----------------------------------------------------------------------------	

Entity CC_AM_BPClassification is DropDownList in frmMain

	with defaults
		visible true
		enabled true
		value "NORM"
		load data from DATASOURCE.BP_CLASSIFICATIONS
		mandatory true
		label LABELS.VENDOR.BP_CLASSIFICATION

	with rules
		CC_AM_BPClassification.Value in {"BPHR", "BPMR"} then AttachManager mandatory 

; ----------------------------------------------------------------------------	

Entity GD_Damex is DropDownList in frmMain
	with defaults
		visible true
		enabled true
		value ''
		load data from DATASOURCE.YES_NO
		mandatory true
		label LABELS.VENDOR.HAVE_YOU_DONE_THE_DAMEX

	with rules
		REQUEST.FLOWTYPE not in {"VC", "VC_CC"} then 
			GD_Damex not mandatory
			GD_Damex not visible
; ----------------------------------------------------------------------------	

Entity labGD_DamexNote is CheckBox in frmMain
	with defaults
		visible true
		enabled true
		value LABELS.VENDOR.labGD_DamexNote

; ----------------------------------------------------------------------------	


Entity GD_Ctr_IsNaturalPerson is CheckBox in frmMain
	with defaults
		visible true
		enabled true
		value false		; unchecked

	with rules
		REQUEST.VENDOR.ACCOUNT_GROUP in {"YVT4", "YVT5"} then
			show this
			show DIV_ADDITIONAL_INFO_NATURAL_PERSON	
			; ALL FIELDS IN	DIV_ADDITIONAL_INFO_NATURAL_PERSON mandatory
		Vendor.Country is "ES" and GD_Ctr_TaxCode1.Text starts with {"P", "Q", "S"} then set value false GD_Ctr_IsNaturalPerson.Checked
		Vendor.Country is "ES" and GD_Ctr_TaxCode1.Text starts with "X" then set value true GD_Ctr_IsNaturalPerson.Checked 

		; CHECK THIS -> 5) If request type creation for company or creation for sales org. or modification->enabled

; ----------------------------------------------------------------------------	

Entity GD_Procur_SuppliersName is TextBox in frmMain
	with defaults
		; it seems to be 28 in the current application?!
		max length 35
		label DICTIONARY.LABELS.VENDOR.labGD_Procur_SuppliersName

; ----------------------------------------------------------------------------	

Entity GD_Procur_SuppliersName2 is TextBox in frmMain
	with defaults
		max length 35
		; actually they have no label text
		label ''

; ----------------------------------------------------------------------------	

Entity GD_Procur_SuppliersName3 is TextBox in frmMain
	with defaults
		max length 35
		label ''

; ----------------------------------------------------------------------------	

Entity GD_Procur_SuppliersName4 is TextBox in frmMain
	with defaults
		max length 35
		label ''

; ----------------------------------------------------------------------------	

Entity GD_Procur_Reason_Justification is TextBox in frmMain
	with defaults
		max length 1000
		mandatory true
		label DICTIONARY.LABELS.VENDOR.labGD_Procur_Reason_Justification

	with rules
		; make not mandatory in case of modification
		REQUEST.WORKFLOW_TYPE is REQUEST.REQUEST_TYPES.VM or REQUEST.WORKFLOW_TYPE is REQUEST.REQUEST_TYPES.VM_BLK then 
			mandatory false
			visible false

; ----------------------------------------------------------------------------	

Entity GD_Procur_MainActivity is TextBox in frmMain
	with defaults
		label DICTIONARY.LABELS.VENDOR.labGD_Procur_MainActivity

; ----------------------------------------------------------------------------	

Entity GD_Procur_Supplier_ExpectedPVO is DropDownList in frmMain
	with defaults
		label DICTIONARY.LABELS.VENDOR.labGD_Procur_Supplier_ExpectedPVO
		mandatory true
		; by default it shows the first item in the list which is blank
		value ''
		; the rest of values to show in the dropdown list are to be loaded from DB
		; I think this is hardcoded now in the app itself...
		load data from DATASOURCE.EXPECTED_PVO_RANGES

	with rules
		; 3 and 4 are the values for the last two values in the combo
		; if the value is one of those, a series of other controls have to be shown (GD_PVO_Question 1 to 5)
		GD_Procur_Supplier_ExpectedPVO.Value in {"3", "4"} then
			GD_PVO_Question1 visible
			GD_PVO_Question1 mandatory
			GD_PVO_Question2 visible
			GD_PVO_Question2 mandatory
			GD_PVO_Question3 visible
			GD_PVO_Question3 mandatory
			GD_PVO_Question4 visible
			GD_PVO_Question4 mandatory
			GD_PVO_Question5 visible
			GD_PVO_Question5 mandatory

; ----------------------------------------------------------------------------

Entity GD_PVO_Question1 is DropDownList in frmMain
	with defaults
		visible false
		label DICTIONARY.LABELS.VENDOR.labGD_PVO_Question1
		mandatory false
		value ''
		load data from DATASOURCE.YES_NO

	with rules
		GD_PVO_Question1.Value is "YES" then GD_PVO_Link1 visible
		GD_PVO_Question1.Value is "NO" then GD_PVO_Link1 not visible

; ----------------------------------------------------------------------------	

Entity GD_PVO_Question2 is DropDownList in frmMain
	with defaults
		visible false
		label DICTIONARY.LABELS.VENDOR.labGD_PVO_Question2
		mandatory false
		value ''
		; high risk country or low risk country
		load data from DATASOURCE.COUNTRY_RISK_CLASSIFICATION

	with rules
		GD_PVO_Question2.Value is "HR" then GD_PVO_Link2 visible
		GD_PVO_Question2.Value is "LR" then GD_PVO_Link2 not visible

; ----------------------------------------------------------------------------	
	
Entity GD_PVO_Question3 is DropDownList in frmMain
	with defaults
		visible false
		label DICTIONARY.LABELS.VENDOR.labGD_PVO_Question3
		mandatory false
		value ''
		; high risk country or low risk country
		load data from DATASOURCE.YES_NO

	with rules
		this.Value is "YES" then GD_PVO_Link3 visible
		this.Value is "NO" then GD_PVO_Link3 not visible

; ----------------------------------------------------------------------------	

Entity GD_PVO_Question4 is DropDownList in frmMain
	with defaults
		visible false
		label DICTIONARY.LABELS.VENDOR.labGD_PVO_Question4
		mandatory false
		value ''
		; values: low, average, high
		load data from DATASOURCE.LOW_AVERAGE_HIGH

	with rules
		GD_PVO_Question4.Value is "HR" then GD_PVO_Link4 visible
		GD_PVO_Question4.Value is not "HR" then GD_PVO_Link4 not visible

; ----------------------------------------------------------------------------	

Entity GD_PVO_Question5 is DropDownList in frmMain
	with defaults
		visible false
		label DICTIONARY.LABELS.VENDOR.labGD_PVO_Question5
		mandatory false
		value ''
		; high risk country or low risk country
		load data from DATASOURCE.YES_NO

	with rules
		GD_PVO_Question5.Value is "YES" then GD_PVO_Link5 visible
		GD_PVO_Question5.Value is "NO" then GD_PVO_Link5 not visible

; ----------------------------------------------------------------------------	

;  this.GD_PVO_Link1.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/1.-Basic%20Quality%20Requirements%20and%20Certificates.doc";
;            this.GD_PVO_Link2.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/2.-Corporate%20Responsibility%20Self%20Assessment.doc";
;            this.GD_PVO_Link3.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/3.-Security%20in%20the%20supply%20chain%20-%20customs%20security%20initiatives.doc";
;            this.GD_PVO_Link4.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/4.-Future%20influence%20in%20Siemens.xlsx";
;            this.GD_PVO_Link5.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/5.-Environmental%20Protection,%20Health%20Management%20and%20Safety.doc";


Entity GD_PVO_Link1 is HyperLink in frmMain
	with defaults
		label DICTIONARY.MDMFillDoc
		value "~/Resources/MDM/Templates/1.-Basic%20Quality%20Requirements%20and%20Certificates.doc"
		visible false

; ----------------------------------------------------------------------------	

Entity GD_PVO_Link2 is HyperLink in frmMain
	with defaults
		label DICTIONARY.MDMFillDoc
		value "https://workspace.swe.siemens.com/content/70000071/07/22978293/Docs/2.-Corporate%20Responsibility%20Self%20Assessment.doc"
		visible false

; ----------------------------------------------------------------------------	

Entity GD_PVO_Link3 is HyperLink in frmMain
	with defaults
		label DICTIONARY.MDMFillDoc
		value "https://workspace.swe.siemens.com/content/70000071/07/22978293/Docs/3.-Security%20in%20the%20supply%20chain%20-%20customs%20security%20initiatives.doc"
		visible false

; ----------------------------------------------------------------------------	

Entity GD_PVO_Link4 is HyperLink in frmMain
	with defaults
		label DICTIONARY.MDMFillDoc
		value "https://workspace.swe.siemens.com/content/70000071/07/22978293/Docs/4.-Future%20influence%20in%20Siemens.xlsx"
		visible false

; ----------------------------------------------------------------------------	

Entity GD_PVO_Link5 is HyperLink in frmMain
	with defaults
		label DICTIONARY.MDMFillDoc
		value "https://workspace.swe.siemens.com/content/70000071/07/22978293/Docs/5.-Environmental%20Protection,%20Health%20Management%20and%20Safety.doc"
		visible false

; ----------------------------------------------------------------------------	



Entity GD_Procur_GoodsToSiemens is TextBox in frmMain
	with defaults
		; bd field length
		max length 250
		mandatory true

; ----------------------------------------------------------------------------	


Entity GD_Procur_ESNCode  is TextBox in frmMain
	with defaults
		max length 3

	with rules
		REQUEST.FLOWTYPE in {"VC", "VC_CC"} then 
			GD_Procur_ESNCode mandatory

; ----------------------------------------------------------------------------	


Entity GD_Procur_ESNCode2 is TextBox in frmMain
	with defaults
		max length 3

; ----------------------------------------------------------------------------	

Entity GD_Procur_ESNCode3 is TextBox in frmMain
	with defaults
		max length 3

; ----------------------------------------------------------------------------	

Entity GD_Procur_ESNCode4 is TextBox in frmMain
	with defaults
		max length 3

; ----------------------------------------------------------------------------	
; 25 entities
; ----------------------------------------------------------------------------	


Entity GD_Adr_Name is TextBox in frmMain
	with defaults
		max length 32
		label LABELS.labName

; ----------------------------------------------------------------------------	

Entity GD_Adr_Name2 is TextBox in frmMain
	with defaults
		max length 32

; ----------------------------------------------------------------------------	

Entity GD_Adr_Street is TextBox in frmMain
	with defaults
		max length 32
		label LABELS.labHouseNumber

; ----------------------------------------------------------------------------	

Entity GD_Adr_Street2 is TextBox in frmMain
	with defaults
		max length 32

	with rules
		REGIONAL_COUNTRY is "FR" then GD_Adr_Street2 not visible
		
; ----------------------------------------------------------------------------	

Entity GD_Adr_Street3 is TextBox in frmMain
	with defaults
		max length 32

	with rules
		REGIONAL_COUNTRY is "FR" then GD_Adr_Street2 not visible
		
; ----------------------------------------------------------------------------	

; ----------------------------------------------------------------------------	
; 30 entities
; ----------------------------------------------------------------------------	

Entity GD_Adr_Region is DropDownList in frmMain
	with defaults
		enabled true
		visible true

	; "16-07-2014(RG): 1) In customer creation from scratch MADAM has to check in table in sheet “Mandatory Region List” if it is mandatory and MADAM has to show in DDL the values according to the customer country.
	 
	;	2) If customer country  belongs to YCT6 or YCT9 -> Region mandatory and the control generate postback
	;	3) if customer country belongs to YCT1 -> region mandatory /if region = 01 -> language = NL/If region = 02 OR 03 -> language = FR
	;	4) If customer country belongs to YCT6/YCT9: if region selected = ""2A"" -> Postal code begins with 20/if region selected = ""2B"" -> Postal code begins with 20 else Postal code begins with code region


; ----------------------------------------------------------------------------	


Entity GD_Adr_CountryGD is TextBox in frmMain
	with defaults
		enabled false		; always disabled
		value SEARCH_FORM_VALUES.DDLVDCountry			; Vendor country, country of the company code!!!!


; ----------------------------------------------------------------------------	

Entity GD_Adr_City is TextBox in frmMain
	with defaults
		visible true		
		enabled true
		mandatory true
		max length 35
		label LABELS.labCity

	with rules
		VENDOR_COUNTRY is "GR" then GD_Adr_City2 visible

; ----------------------------------------------------------------------------	


Entity GD_Adr_City2 is TextBox in frmMain
	with defaults
		visible false		; always disabled
		label LABELS.labDistrict

	with rules
		VENDOR_COUNTRY is "GR" then GD_Adr_City2 visible

; ----------------------------------------------------------------------------	


Entity GD_Adr_Name4 is TextBox in frmMain
	with defaults
		mandatory false
		enabled true

	with rules
		; for any company 
		CURRENT_ROLE is "MDM_CLERK" then mandatory true
		; mandatory for ENQ and in 5150 (the only Greece CoCD)
		COMPANY_CODE is 5150 and CURRENT_ROLE is "ENQ" then mandatory true


; ----------------------------------------------------------------------------	


Entity GD_Adr_Name3 is TextBox in frmMain
	with defaults
		max length 32

; ----------------------------------------------------------------------------	

Entity GD_Com_Comment is TextBox in frmMain
	with defaults
		max length 35
		label LABELS.labComment

; ----------------------------------------------------------------------------	

Entity GD_Adr_PostalCode is TextBox in frmMain
	with defaults
		max length 10
		mandatory true
		label LABELS.labPostalCode

	with rules

		;	IF vendor country belongs to YVT1/YVT2 -> Maxlength = 4 (only numbers - Format: XXXX)
		REQUEST.VENDOR.ACCOUNT_GROUP in {"YVT1", "YVT2"} then
			max length 4
			validation "^[0-9]{4}$"

		REQUEST.VENDOR.ACCOUNT_GROUP in {"YVT3", "YVT5", "YVT7"} then
			max length 5
			validation "^[0-9]{5}$"

		REQUEST.VENDOR.ACCOUNT_GROUP is "YVT4" then
			max length 8
			validation "^[0-9]{4}-[0-9]{3}$"

		; post code must be >=1500 and <=3999 OR >=8000 and <=9999
		; the regular expression covers the ranges
		REQUEST.VENDOR_COUNTRY is "BE" and GD_Adr_Region is "01" then
			max length 4
			validation "^(1[5-9][0-9]{2}){1}|((2|3)[0-9]{3}){1}|((8|9)[0-9]{3})$"
		
		; post code must be >=1300 and <=1499 OR >=4000 and <=7999
		REQUEST.VENDOR_COUNTRY is "BE" and GD_Adr_Region is "02" then
			max length 4
			validation "^(1[3-4][0-9]{2}){1}|([4-7][0-9]{3})$"

		; post code must be >=1000 and <=1299
		REQUEST.VENDOR_COUNTRY is "BE" and GD_Adr_Region is "03" then
			max length 4
			validation "^(1[0-2][0-9]{2})$"

		REQUEST.VENDOR_COUNTRY in {"FR", "GF", "GP", "MC", "MQ", "NC", "PF", "PM", "RE", "WF", "YT"} then
			max length 5
			validation "^[0-9]{5}$"
			set value substring(GD_Adr_PostalCode,2) in GD_Adr_Region



; ----------------------------------------------------------------------------	


Entity GD_Adr_Search is TextBox in frmMain
	with defaults
		enabled true
		visible true
		max length 20
		value  GD_Adr_Name1.Value
		label LABELS.Search


	with rules
		CURRENT_ROLE in {"UPM", "CPM", "RCO"} then disabled


; ----------------------------------------------------------------------------	

; TODO: REVIEW THIS FIELD IN ACTUAL CODE - FIELD MAPPING JUST SAYS "IT WORKS CORRECTLY"
; BECAUSE THE RULES ARE SO COMPLEX THEY DONT EVEN KNOW WHAT THE FUCK IS GOING ON
Entity GD_Adr_POBoxPostalCode is TextBox in frmMain
	with defaults
		enabled true
		visible true
		max length 5
		mandatory false
		label LABELS.labBoxPostalCode

	with rules
		; these rules are a bit special
		; this field is imbricated with GD_Adr_POBox and with GD_Adr_POBoxLoc
		; see code around lines 822 and following in MDM.aspx.cs
		VENDOR_COUNTRY in { COUNTRIES.FRENCH_GUAYANA, COUNTRIES.GUADELOUPE, COUNTRIES.MARTINIQUE, COUNTRIES.REUNION, COUNTRIES.FRANCE, COUNTRIES.MAYOTTE, COUNTRIES.NEW_CALEDONIA, COUNTRIES.FRENCH_POLYNESIA, COUNTRIES.STPIERMIQUEL, COUNTRIES.WALLIS_FORTUNA, COUNTRIES.MONACO, COUNTRIES.FRENCH_TERRITORIES } then GD_Adr_POBoxPostalCode mandatory

		VENDOR_COUNTRY is COUNTRIES.FRANCE then this max length 10
; ----------------------------------------------------------------------------	

Entity GD_Adr_POBoxLoc is TextBox in frmMain
	with defaults
		enabled true
		visible true
		max length 35
		mandatory false
		label LABELS.labPoBoxLoc

; ----------------------------------------------------------------------------	

Entity GD_Com_LanguageCode is DropDownList in frmMain
	with defaults
		enabled true
		visible true
		mandatory true
		; obtain the code for the vendor country, if there is no specific code, then 'EN' is default language
		load data from DATASOURCE.GET_COUNTRY_LANGUAGE_CODE		
		label LABELS.labLanguages


	with rules
		
		

; ----------------------------------------------------------------------------	

Entity GD_Com_Telebox is DropDownList in frmMain
	with defaults
		max length 40
		mandatory true
		load data from DATASOURCE.TELEBOX_VALUES	; these are "ADM - ADM", "MAIL - Mail", "PRT - Print", "SES - eInvoice" (value and text respectively)
		value 'PRT'		
		label LABELS.labTelebox

; ----------------------------------------------------------------------------	

Entity GD_Com_URL is TextBox in frmMain
	with defaults
		max length 120
		label LABELS.labURL

; ----------------------------------------------------------------------------	

Entity GD_Com_DataLine is TextBox in frmMain
	with defaults
		max length 14
		label LABELS.labDataLine

; ----------------------------------------------------------------------------	

Entity P_GD_VT_Country is DropDownList in frmMain
	with defaults
		load data from ENTERPRISE.WORLD_COUNTRIES
		value REQUEST.VENDOR_COUNTRY
		mandatory true
	
	with actions
		load data from DATASOURCE.ENTERPRISE.MDM_CountryTelephonePrefixes with arguments {"COUNTRY" : P_GD_VT_Country.Value } in P_GD_VT_CountryCode
	
	with triggers
		this changes

; ----------------------------------------------------------------------------	

Entity P_GD_VT_CountryCode is TextBox in frmMain
	with defaults
		enabled false
		mandatory true

; ----------------------------------------------------------------------------	

Entity P_GD_VT_Number is TextBox in frmMain
	with defaults
		max length 30
		label LABELS.labGD_VT_Number
		mandatory true

; ----------------------------------------------------------------------------	

Entity P_GD_VT_Extension is TextBox in frmMain
	with defaults
		max length 10
		label LABELS.lablabGD_VT_Extension


; ----------------------------------------------------------------------------	

Entity P_GD_VT_Notes is TextBox in frmMain
	with defaults
		max length 50
		label LABELS.labGD_VT_Notes
		

; ----------------------------------------------------------------------------	

Entity P_GD_VT_Default is TextBox in frmMain
	with defaults
		; by defaults appears checked and disabled
		value true
		label LABELS.labP_GD_VT_Default
		enabled false
		

; ----------------------------------------------------------------------------	

; TEST FOR THIS
; this name is going to be wrong
Entity btnInsert is Button in frmMain
	with defaults
		value LABELS.GENERIC.labInsert

	with actions
		; TODO DEFINE ACTION SUCH AS
		; save data to, similar to "load data from"
		save data to DATASOURCE.MDM_Requests_PhoneEntry with arguments {"Phone" : "123456"}

	with triggers
		this clicked


; ----------------------------------------------------------------------------	

Entity F_GD_VF_Country is DropDownList in frmMain
	with defaults
		load data from DATASOURCE.ENTERPRISE.WORLD_COUNTRIES
		value REQUEST.VENDOR_COUNTRY

	with actions
		load data from DATASOURCE.ENTERPRISE.MDM_CountryTelephonePrefixes with arguments {"COUNTRY" : F_GD_VF_Country.Value } in F_GD_VF_CountryCode
	
	with triggers
		this changes

; ----------------------------------------------------------------------------	

Entity F_GD_VF_Number is TextBox in frmMain
	with defaults
		max length 30
		label LABELS.labGD_VF_Number
		
		
; ----------------------------------------------------------------------------	


Entity F_GD_VF_Notes is TextBox in frmMain
	with defaults
		max length 50
		label LABELS.labGD_VF_Notes
		

; ----------------------------------------------------------------------------	

Entity F_GD_VF_Default is TextBox in frmMain
	with defaults
		value false
		label LABELS.labGD_VF_Default
		

; ----------------------------------------------------------------------------	

Entity E_GD_VE_SmtpAddr is TextBox in frmMain
	with defaults
		; move the tooltip text to the real dictionary
		tooltip "the email is used generally for all the automatic communication with the supplier - e.g. payment advice"
		label LABELS.labGD_VE_SmtpAddr
		max length 241
		mandatory true
		; IT'S ALMOST IMPOSSIBLE TO DO THE RIGHT REGEX FOR EMAIL, SO FOR THE MOMENT WE PUT NOTHING HERE -
	
	with rules
		; check this is true
		REQUEST.REQUEST_TYPE is "VC" then mandatory true
		
; ----------------------------------------------------------------------------	

Entity E_GD_VE_Notes is TextBox in frmMain
	with defaults
		max length 50
		label LABELS.labGD_VE_Notes
		

; ----------------------------------------------------------------------------	

Entity E_GD_VE_Default is TextBox in frmMain
	with defaults
		value false
		label LABELS.labGD_VE_Default
		
; ----------------------------------------------------------------------------	

Entity GD_NatP_DateOfBirth is Calendar in frmMain
	with defaults
		label LABELS.calBirthDate


; ----------------------------------------------------------------------------	


;BACKUP THIS WITH TESTS

Entity GD_NatP_PlaceOfBirth is TextBox in frmMain
	with defaults
		max length 25
		label LABELS.labPlaceOfBirth
		
	with rules
		REQUEST.COMPANY_CODE is "5240" and GD_Ctr_NIF.Value starts with {"1","2"} or GD_Ctr_TaxCode1.Value starts with {"1","2"} then 
			label "Nº Employees"
			mandatory true
		

; ----------------------------------------------------------------------------	

; TEST
Entity GD_NatP_Profession is TextBox in frmMain
	with defaults
		max length 30
		label LABELS.labProfession
	
	with rules
		REQUEST.VENDOR.ACCOUNT_GROUP in {"YVT6", "YVT9"} then visible false


; ----------------------------------------------------------------------------	

Entity GD_NatP_Sex is DropDownList in frmMain
	with defaults
		load data from DATASOURCE.GENERIC.MDM_Sex
		value ''
		label LABELS.labSex


; ----------------------------------------------------------------------------	


Entity GD_NatP_Exemption is DropDownList in frmMain
	with defaults
		; PUT INTO DATABASE 
		; this.GD_NatP_Exemption.Items.Add ( new ListItem ( "0 - No exemption", "0" ) );
		; this.GD_NatP_Exemption.Items.Add ( new ListItem ( "2 - Exemption", "2" ) );
		; does not exist in Customer
		load data from DATASOURCE.GENERIC.MDM_NaturalPersonExemptions
		value ''
		label LABELS.labExemption

; ----------------------------------------------------------------------------	

; PREPARE TEST FOR THIS
; THIS ENTITY HAS A LOT OF CODE AND NOTHING IN THE FIELD MAPPING
Entity GD_Ctr_CustomerNumber is TextBox in frmMain
	with defaults
		max length 18
		label LABELS.labCustomerNumber
		
	with rules
		REQUEST.STATUS is not REQUEST.CLOSED then
			enabled true
			visible true
		
		REQUEST.STATUS is not REQUEST.CLOSED and REQUEST.REQUEST_TYPE is "VM" and PO_ReturnsVendor.Checked is true and GD_Ctr_CustomerNumber.OldDisplayValue is empty then
			mandatory true
			
		REQUEST.STATUS is not REQUEST.CLOSED and REQUEST.REQUEST_TYPE is "VM" and PO_ReturnsVendor.Checked is true and GD_Ctr_CustomerNumber.OldDisplayValue is not empty then
			this mandatory
			
		REQUEST.STATUS is not REQUEST.CLOSED and REQUEST.REQUEST_TYPE is "VM" and PO_ReturnsVendor.Checked is false then
			this not mandatory
			GD_Abc_DEMO mandatory
			
		REQUEST.STATUS is not REQUEST.CLOSED and REQUEST.REQUEST_TYPE is not "VM" then
			mandatory true	


; ----------------------------------------------------------------------------	


Entity GD_Ctr_Industry is DropDownList in frmMain
	with defaults
		mandatory false
		visible true
		label LABELS.labIndustries
		; if there are no specific data for this specific country, data for "EN" should be loaded
		load data from DATASOURCE.MDM_Industries with arguments {"FlagActive": true, "Country" : REQUEST.VENDOR_COUNTRY}

	with rules
		REQUEST.VENDOR.ACCOUNT_GROUP in {"YCT6", "YVT6"} then
			load data from DATASOURCE.MDM_Industries with arguments {"FlagActive": true, "Country" : "FR"}
			; this equals to this line in original code
			; this.m_mdmSessionInfo.IndustryCountry = Business.Constants.Countries.France;
			set value "FR" in REQUEST.INDUSTRY_COUNTRY
			; can or should we do something like this?
			set width 680px		

		REQUEST.VENDOR.ACCOUNT_GROUP in {"YCT9", "YVT9"} then
			load data from DATASOURCE.MDM_Industries with arguments {"FlagActive": true, "Country" : "EN"}
			; this.m_mdmSessionInfo.IndustryCountry = Business.Constants.Countries.France;
			set value "EN" in REQUEST.INDUSTRY_COUNTRY
			mandatory false
			; TODO: can or should we do something like this?
			; set width 680px		
			
; ----------------------------------------------------------------------------	

Entity GD_Ctr_GFORM is DropDownList in frmMain
	with defaults
		label LABELS.labLegalForm
		visible false
		; data source is same for vendors and customers
		load data from DATASOURCE.MDM_LegalForms with arguments {"FlagActive" : true }

	with rules
		REQUEST.VENDOR.ACCOUNT_GROUP in {"YCT6", "YVT6"} then
			visible true

		REQUEST.VENDOR.ACCOUNT_GROUP in {"YCT6", "YVT6"} and REQUEST.ROLE is REQUEST.ROLES.CLERK then
			mandatory true

; ----------------------------------------------------------------------------	

; this is one of the most sensitive and complex controls 
; there are quite a few rules

;	
;	By default visible = false
;	Label:Local Tax Code

;	2) if vendor country France->maxlength 14, label = SIRET, visible true
;	3)if vendor country france -> only numbers
;	4) when PIVA postback: if vendor country belongs to YVT6-> complete piva wiht 0 on left until 14,tax code 1=piva, tax code 2=firts 9 digits of piva , vatnumber=tax code 2
;	else -> if vendor country belongs to EU ->tax code 1 = PIVA
;		if vendor country is not Spain->  vat registration number = tax code 2
;		if regional country is France and vendor country belongs to YVT6->complete piva wiht 0 on left until 14,tax code 1=piva, tax code 2=firts 9 digits of piva , vatnumber=tax code 2
;		if regional country is Greece and vendor country is Greece-> vatregistrationnumber = tax code 2 , tax code 2 remove letters
;	5) If vendor country belongs to YVT6 and tax code1 is informed -> piva = tax code 1
;	6)if vendor country Portugal->visible false
;	7)if vendor country Italy->visible for  vendor creation from scratch and mandatory
;	8)if vendor country Spain->visible false
;	9)enabled for vendors creations from scratch
;	10)if vendor country France->enabled
;	11)if vendor creation from scratch and vendor country Belgium or Luxemburg->visible true and mandatory if role is not clerk
;	12)if vendor country Greece ->maxlength 9
;	13)if vendor country belongs to YVT1->maxlength 10
;	14)if vendor country belongs to YVT2->maxlength 8
;	15)if vendor country belongs to YVT3->maxlength 16
;	16)if vendor country belongs to YVT4->maxlength 10
;	17)if vendor country belongs to YVT5->maxlength 11
;	18)if vendor country belongs to YVT6: 
;		if cleck->mandatory false else mandatory for not natural person
;		enabled for clerck and enquirer
;	19)if vendor country belongs to YVT9:
;		mandatory false
;		enabled for clerk and enquirer

Entity GD_Ctr_PIVA is TextBox in frmMain
	with defaults
		; I doubt this
		visible false
		label LABELS.labPIVA ;Local Tax Code
		mandatory false

	with rules
		; this means companycode country
		;	1) if regional country Greece and not vendor creation from scratch->NO mandatory else If vendor country doesn't belong to YVT6 or YVT9 -> mandatory
		REQUEST.COUNTRY is "GR" and REQUEST.REQUEST_TYPE is not "VC"
			mandatory false
		REQUEST.COUNTRY is "GR" and REQUEST.REQUEST_TYPE is not "VC" and VENDOR.ACCOUNT_GROUP not in {"YVT6", "YVT9"} then
			mandatory true
		
		; if vendor country France->maxlength 14, label = SIRET, visible true, only numbers
		REQUEST.VENDOR_COUNTRY is "FR" then
			visible true
			label LABEL.labSIRET	; see this
			max length 14
			; validate with this regex
			validation regex ^[0-9]{1,14}

		REQUEST.VENDOR.ACCOUNT_GROUP is "YVT6" then
			; new rule to be tested and parsed
			; complete piva wiht 0 on left until 14
			pad left 0,14
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			; new rule to be tested and parsed
			set value substring GD_Ctr_PIVA.Value, 9 in GD_Ctr_TaxCode2
			set value GD_Ctr_TaxCode2.Value in GD_Ctr_IFANumber

		REQUEST.VENDOR_COUNTRY is "FR" and REQUEST.VENDOR.ACCOUNT_GROUP is "YVT6" then
			pad left 0,14
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			set value substring GD_Ctr_PIVA.Value, 9 in GD_Ctr_TaxCode2
			set value GD_Ctr_TaxCode2.Value in GD_Ctr_IFANumber

		;any EU country ; finish the list....
		REQUEST.VENDOR.ACCOUNT_GROUP is not "YVT6" and REQUEST.VENDOR_COUNTRY in {"ES", "IT", "PT", "GR" } then
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1

		REQUEST.VENDOR_COUNTRY is not "ES" then
			set value GD_Ctr_TaxCode2.Value in GD_Ctr_IFANumber

		REQUEST.VENDOR_COUNTRY is "GR" and REQUEST.COUNTRY is "GR" then
			set value GD_Ctr_TaxCode2.Value in GD_Ctr_IFANumber
			remove letters GD_Ctr_TaxCode2.Value
			



; ----------------------------------------------------------------------------	

Entity GD_Ctr_NIF is TextBox in frmMain

Entity GD_Ctr_CF is TextBox in frmMain

Entity GD_Ctr_TaxCode1 is TextBox in frmMain

Entity GD_Ctr_TaxCode2 is TextBox in frmMain

Entity GD_Ctr_VATRegistrationNumber is TextBox in frmMain

Entity GD_Ctr_SalesPurTax is CheckBox in frmMain

Entity GD_Ctr_IFANumber is TextBox in frmMain

Entity GD_Ctr_RepresentiveName is TextBox in frmMain

Entity GD_Ctr_TaxNumber	is TextBox in frmMain

Entity GD_Ctr_CreditInfoNo is TextBox in frmMain
	
Entity GD_Ctr_UnsubscribeCMD is DropDownList in frmMain

Entity V_Country is DropDownList in frmMain

Entity V_VATNumber	 is TextBox in frmMain

Entity B_GD_VB_Country	is DropDownList in frmMain

Entity B_GD_VB_BankKey	 is TextBox in frmMain

Entity B_GD_VB_BankAccount	 is TextBox in frmMain

Entity B_GD_VB_BankControlKey	 is TextBox in frmMain

Entity B_GD_VB_IBAN	 is TextBox in frmMain

Entity B_GD_VB_PartBankType	 is TextBox in frmMain

Entity B_GD_VB_BankReferDetails	 is TextBox in frmMain

Entity B_GD_VB_SWIFT	 is TextBox in frmMain

Entity B_GD_VB_AccountHolder is TextBox in frmMain

Entity CC_CO_ReconAccount	 is TextBox in frmMain

Entity LFB1_LNRZE	 is TextBox in frmMain

Entity LFB1_REPRF	 is TextBox in frmMain

Entity CC_AM_SortKey	is DropDownList in frmMain

Entity CC_AM_SubjectedToWHTax	is CheckBox in frmMain

Entity CC_AM_WithholdingTaxCode	is DropDownList in frmMain

Entity CC_AM_ExemptionNumber	 is TextBox in frmMain

Entity CC_AM_ExemptionNumber	is DropDownList in frmMain

Entity CC_PT_ValidityDate is Calendar in frmMain

Entity CC_AM_CashManagementGroup	is DropDownList in frmMain

Entity CC_PT_PaymentTerms	is DropDownList in frmMain

	with actions
		set value CC_PT_PaymentTerms.Value in PO_TermsOfPaymentKey.Value

	with triggers
		this changes



Entity CC_PT_PaymentBlock	is DropDownList in frmMain

Entity CC_PT_PaymentMethods	is DropDownList in frmMain

Entity CC_PT_ClearingWithCustomer	is CheckBox in frmMain

Entity CC_PT_AlternativePayee	Field with conversion routines

Entity CC_PT_IndividualPayment	is CheckBox in frmMain

Entity CC_PT_HouseBank	 is TextBox in frmMain

Entity CC_PT_ForCreditMemos	is DropDownList in frmMain

Entity CC_DD_DunningProcedure	is DropDownList in frmMain

Entity CC_DD_LegalProceedings is Calendar in frmMain

Entity CC_DD_LastDunnedOn is Calendar in frmMain

Entity CC_DD_DunningBlock	is DropDownList in frmMain

Entity CC_DD_Level is TextBox in frmMain

; ----------------------------------------------------------------------------	

; TODO: PENDING TESTS
Entity CC_DD_DunningClerk is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labDDDunningClerk
		load data from DATASOURCE.MDM_AccountingClerks with arguments {"FlagActive" : true, "CompanyCode" : REQUEST.COMPANY_CODE}

	with rules
		REQUEST.COMPANY_CODE in {5101, 563M, 5109} then
			set value 10 in CC_DD_DunningClerk.Value
			this disabled
			; show this

		REQUEST.COUNTRY not in {PT, GR, IT, BE, LU} then
			show this

; ----------------------------------------------------------------------------	

; TODO: THIS FIELD IS TOO COMPLICATED - REVIEW BETTER - SEE FIELDMAPPING FILE
Entity CC_CO_AccountingClerk is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labCOAccountingClerk
		load data from DATASOURCE.MDM_AccountingClerks with arguments {"FlagActive" : true, "CompanyCode" : REQUEST.COMPANY_CODE}

	with rules
		REQUEST.VENDOR_COUNTRY in {PT, FR} then
			show CC_CO_AccountingClerk

		REQUEST.COMPANY_CODE in {5101, 563M} then
			show CC_CO_AccountingClerk
			

; ----------------------------------------------------------------------------	

; has to be saved and resent from SAP in any case
Entity CC_CO_AccountingClerkTel	is TextBox in frmMain
	with defaults
		visible false

; ----------------------------------------------------------------------------	

; has to be saved and resent from SAP in any case
Entity CC_CO_AccountingClerkFax	is TextBox in frmMain
	with defaults
		visible false

; ----------------------------------------------------------------------------	

; has to be saved and resent from SAP in any case
Entity CC_CO_AccountingClerkInternet is TextBox in frmMain
	with defaults
		visible false

; ----------------------------------------------------------------------------	


Entity CC_CO_OurAccountWithVendor is TextBox in frmMain
	with defaults
		; this is only in schema
		max length 50
		label LABELS.labCOOurAccountWithVendor

; ----------------------------------------------------------------------------	

Entity PO_AutomaticGenerationPO	is CheckBox in frmMain
	with defaults
		visible true
		label LABELS.labAutomaticGenerationPO

	with rules
		REQUEST.COUNTRY is GR then
			PO_AutomaticGenerationPO visible true
			set value false in PO_AutomaticGenerationPO

		REQUEST.COUNTRY is not GR then
			PO_AutomaticGenerationPO visible false

		REQUEST.REQUEST_TYPE in {VC, VC_CC, VC_PO} then
			set value true in PO_OrderAcknowledgmentReq

; ----------------------------------------------------------------------------	

Entity PO_OrderAcknowledgmentReq is CheckBox in frmMain
	with defaults
		visible true
		label LABELS.labOrderAcknowledgmentReq

	with rules
		; checkbox must be checked in these request types...
		REQUEST.REQUEST_TYPE in {VC, VC_CC, VC_PO} then
			set value true in PO_OrderAcknowledgmentReq

		REQUEST.COUNTRY is not GR then
			PO_OrderAcknowledgmentReq visible false

; ----------------------------------------------------------------------------	

Entity PO_GRBasedInvoiceVerification is CheckBox in frmMain
	with defaults
		visible true
		label LABELS.labPO_GRBasedInvoiceVerification

; ----------------------------------------------------------------------------	

Entity PO_ReturnsVendor	is CheckBox in frmMain
	with defaults
		visible true
		label LABELS.labPO_ReturnsVendor

	with rules
		REQUEST.REQUEST_TYPE is "VM" and PO_ReturnsVendor.Value is true and GD_Ctr_CustomerNumber.OldDisplayValue is empty then
			GD_Ctr_CustomerNumber mandatory
			GD_Ctr_CustomerNumber enable true

		REQUEST.REQUEST_TYPE is "VM" and PO_ReturnsVendor.Value is true and GD_Ctr_CustomerNumber.OldDisplayValue is not empty then
			GD_Ctr_CustomerNumber mandatory false
			GD_Ctr_CustomerNumber enable false

		REQUEST.REQUEST_TYPE is "VM" and PO_ReturnsVendor.Value is false then
			GD_Ctr_CustomerNumber enable false

		REQUEST.REQUEST_TYPE is not "VM" and PO_ReturnsVendor.Value is true then
			GD_Ctr_CustomerNumber mandatory

		REQUEST.COUNTRY is GR then
			set value false in PO_ReturnsVendor

	with triggers
		this changes

; ----------------------------------------------------------------------------	

Entity PO_PurchaseOrderCurrency	is DropDownList in frmMain
	with defaults
		mandatory
		label LABELS.labPurchaseOrderCurrency
		; the company code country, not vendor's country
		load data from DATASOURCE.MDM_Currencies with arguments {"FlagActive" : true }
		value EUR


; ----------------------------------------------------------------------------	


Entity PO_TermsOfPaymentKey	is DropDownList in frmMain
	with defaults
		mandatory
		label LABELS.lblPO_TermsOfPaymentKey
		; the company code country, not vendor's country
		load data from DATASOURCE.MDM_PaymentTerms with arguments {"FlagActive" : true, "Country" : REQUEST.COUNTRY}

	with rules
		REQUEST.COUNTRY is "ES" then
			set value 3M60 in PO_TermsOfPaymentKey

		REQUEST.COUNTRY is "IT" then
			set value 5510 in PO_TermsOfPaymentKey
	
		REQUEST.COUNTRY is "LU" then
			set value 1113 in PO_TermsOfPaymentKey
	
		REQUEST.COUNTRY is "BE" then
			set value 1301 in PO_TermsOfPaymentKey

		REQUEST.COUNTRY is "GR" then
			set value 7A90 in PO_TermsOfPaymentKey

		REQUEST.COUNTRY is "PT" and REQUEST.VENDOR_COUNTRY is "PT" then
			set value 4217 in PO_TermsOfPaymentKey
			
		REQUEST.COUNTRY is "PT" and REQUEST.VENDOR_COUNTRY is not "PT" then
			set value 4117 in PO_TermsOfPaymentKey

; ----------------------------------------------------------------------------	

;	"26.5.14(MI), please, GSS, can you confirm the business rule for RC Greece?...No value by default is implemented for RC Greece.
;	05-06-2014(RG): rules confirmed
;	
;	04-07-2014 (MC)
;	By default mandatory
;	Values in dropdown are loaded hardcode
;	1)if company code Spain -> default value DAP (if exists)
;	2)if company code Italy -> default value EXW (if exists)
;	3)if company code Portugal/Belgium/Luxemburg -> default value DDP (if exists)
;	4)validation: if empty ->mandatory error message
;	6)if regional country France:
;	 if company 5140 -> DAP
;	 if company 5924/592F->DAP 
;	7)if comapny code 5150 -> CIF"

Entity PO_Incoterms	is DropDownList in frmMain
	with defaults
		label LABELS.labIncoterms
		load data from DATASOURCE.MDM_Incoterms with arguments {"FlagActive" : true}
		mandatory true

	with actions
		; whenever the value of this dropdown list changes, copy the text, not the value to PO_IncotermsPart2
		set value PO_Incoterms.Text in PO_IncotermsPart2

	with rules
		REQUEST.COUNTRY is "ES" then
			set value "DAP" in PO_Incoterms

		REQUEST.COUNTRY is "IT" then
			set value "EXW" in PO_IncotermsPart2

		REQUEST.COUNTRY in {"PT", "BE", "LU"} then
			set value "DDP" in PO_IncotermsPart2

		REQUEST.COMPANY_CODE is 5140 then
			set value "FRANCE METROPOLITAINE" in PO_IncotermsPart2
				
		REQUEST.COMPANY_CODE in {5924, 592F} then
			set value "SAINT DENIS" in PO_IncotermsPart2

		REQUEST.COMPANY_CODE is 5150 then
			set value "CIF" in PO_Incoterms
			set value "Athens" in PO_IncotermsPart2

			
	with triggers
		this changes

; ----------------------------------------------------------------------------	


;	By default mandatory (enquirer can change)
;	1)if regional country Spain -> default value DAP (same as incoterms)
;	2)if regional country Italy -> default value EXW (same as incoterms)
;	3)if regional country Portugal/Belgium/Luxemburg -> default value DDP (same as incoterms)
;	4)validation: if empty ->mandatory error message
;	5)if regional country France:
;	 if company 5140 -> France Metropolitaine
;	 if company 5924/5924->Saint Denis
;	6.A)if regonal country Greece-> Athens
;	6.b)when change district in adress-> incoterms2=city2 (district is only visible for company code  greece or vendor country greece)

Entity PO_IncotermsPart2 is TextBox in frmMain
	with defaults
		label LABELS.labIncotermsPart2
		mandatory true

	with rules
		REQUEST.COMPANY_CODE is 5150 then
			set value "ATHENS" in PO_IncotermsPart2
			

; ----------------------------------------------------------------------------	

Entity PO_ConfirmationControl is DropDownList in frmMain
	with defaults
		label LABELS.labConfirmationControl
		visible false

	with rules
		REQUEST.COUNTRY is "FR" and PO_ConfirmationControl.Value is empty then
			set value "Y601" in PO_ConfirmationControl
			PO_ConfirmationControl visible true

; SPECIAL KIND OF COMPOSITE CONTROL
; TODO: DECIDE WHAT TO DO WITH THEM
Entity Multiple_Purchase_Organizations is DropDownList in frmMain


; --- CONTROLS IN BLOCKING DATA TAB -------------------------------------------

; TODO: THE DATASOURCE INDICATED DOES NOT EXIST, CURRENTLY VALUES ARE LOADED IN CODE, SO THE DATASOURCE HAS TO BE CREATED
; VALUES ARE
; "", ""
; "D - Unsubscribe", "D"
; "V - Unsubscribed from CMD", "V"
; which are the same as for GD_Ctr_UnsubscribeCMD
Entity BLK_GD_Ctr_UnsubscribeCMD is DropDownList in frmMain
	with defaults
		label LABELS.labUnsubscribeCMD
		load data from DATASOURCE.MDM_UnsubscribeCMD_Options

	with actions
		set value BLK_GD_Ctr_UnsubscribeCMD.Value in GD_Ctr_UnsubscribeCMD

	with rules
		REQUEST.REQUEST_TYPE is "VM_BLK" then
			enabled true

	with triggers
		; when this controls change, change the value of GD_Ctr_UnsubscribeCMD
		this changes

; ----------------------------------------------------------------------------	

Entity BLK_CC_PT_PaymentBlock
	with defaults
		label LABELS.labPTPaymentBlock
		load data from DATASOURCE.MDM_PaymentBlocks with arguments {"FlagActive" : true}

	with rules
		REQUEST.REQUEST_TYPE is "VM_BLK" then
			enabled true

; ----------------------------------------------------------------------------	

Entity BLK_CentralPO is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labCentralPostingBlock
	
	with rules
		REQUEST.REQUEST_TYPE is "VM_BLK" then
			enabled true

; ----------------------------------------------------------------------------	

; this was not even in the field mapping, but is visible false as default, 
; so probably not used...
Entity BLK_24_hour is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labUnBlockFor24Hours
		visible false
	
	with rules
		REQUEST.REQUEST_TYPE is "VM_BLK" then
			enabled true

; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFB1.SPERR
;	2)SEND data to SAP in field SPERB_B
Entity BLK_CompanyCode is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labUnBlockFor24Hours
	
	with rules
		REQUEST.REQUEST_TYPE is "VM_BLK" then
			enabled true

; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFA1.SPERM
;	2)SEND data to SAP in field SPERM_X
Entity BLK_Central is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labCentrallyPurchasingBlock
	
	with rules
		REQUEST.REQUEST_TYPE is "VM_BLK" then
			enabled true

; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFM1.SPERM
;	2)SEND data to SAP in field SPERM_M
Entity BLK_PO is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labPursachingBlockAtOrganization
	
	with rules
		REQUEST.REQUEST_TYPE is "VM_BLK" then
			enabled true

; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFA1.LOEVM
;	2)SEND data to SAP in field LOEVM_X
Entity BLK_MFD_Central is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_Central
	
	with rules
		REQUEST.REQUEST_TYPE is "VM_BLK" then
			enabled true
; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFB1.LOEVM
;	2)SEND data to SAP in field LOEVM_B
Entity BLK_MFD_CompanyCode is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_CompanyCode
	
	with rules
		REQUEST.REQUEST_TYPE is "VM_BLK" then
			enabled true

; ----------------------------------------------------------------------------	

; LFA1.LOEVM
; SEND TO SAP IN FIELD LOEVM_M
Entity BLK_MFD_PO is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_PO
	
	with rules
		REQUEST.REQUEST_TYPE is "VM_BLK" then
			enabled true
; ----------------------------------------------------------------------------	

; LFA1.NODEL
Entity BLK_MFD_DeletionBlockCentral	is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_DeletionBlockCentral
	
	with rules
		REQUEST.REQUEST_TYPE is "VM_BLK" then
			enabled true
; ----------------------------------------------------------------------------	

; not sent to SAP, only retrieve from LFB1.NODEL
Entity BLK_MFD_DeletionBlockCompanyCode	is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_DeletionBlockCompanyCode
	
	with rules
		REQUEST.REQUEST_TYPE is "VM_BLK" then
			enabled true	

; --- the fucking end --------------------------------------------------------
