; -- RULES FOR VENDOR SEARCH FORM 
; -- TODO: PENDING PORTING UNEXPLICIT RULES SUCH AS THOSE IN METHOD ApplyAccountGroupRules
; -- TODO: MANY THINGS MISSING SUCH AS THE COMPOSITE CONTROLS, TEH ATTCHMENTS, buttons iN COMPOSITE CONTROLS....
; 

; TESTGEN : DEFAULTS=2, ACTIONS=1, RULES=1, TRIGGERS=1
Entity frmSearch is Form
	with defaults
		visible true

	with actions
		; TODO: this property has to be populated by framework, it is an ambient property that precedes the form
		; if the property is present and has a value it means the user opened an existing request from the BP HOME
		; then it remais to determine the final syntax for accessing this property from the rules
		; or either, hardcode the rule in xtml
		load data from DATASOURCE.W4E_GetUserInfo with arguments {UserAccount : REQUEST.USER_ACCOUNT} with output {HF_UserCostLocationUnit.Value : CostLocationUnit, HF_UserCountry: UserCountry}

	with triggers
		this loads
; ----------------------------------------------------------------------------	


; ----------------------------------------------------------------------------	
; BEGIN HIDDEN FIELDS DEFINITION
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_UserCountry is TextEnBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_UserCostLocationUnit is TextBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_UserAccount is TextBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_CurrentRole is TextBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_RequestState is TextBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_RequestType is TextBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_RegionalCountry is TextBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_CompanyCode is TextBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_PurchaseOrg is TextBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_VendorCountry is TextBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_AccountGroup is TextBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_RegionIsMandatory is CheckBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_Language is TextBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_IsEU is CheckBox in frmMain 
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_MandatoryIBAN is CheckBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_IsTaxHeaven is CheckBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_TaxCode1Mandatory is CheckBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_TaxCode2Mandatory is CheckBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_VATMandatory is CheckBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_FlagUserCanSearch is CheckBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_FlagSearchCriteriaIncomplete is CheckBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3
Entity HF_RiskClassification is TextBox in frmMain
	with defaults
		enabled false
		visible false
		hiddenfield
; ----------------------------------------------------------------------------	
; ----------------------------------------------------------------------------	
;     END OF HIDDEN FIELDS DEFINITION
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=2, ACTIONS=1, RULES=1, TRIGGERS=1
Entity frmMain is Form
	with defaults
		; TODO: when application starts, this is hidden, except when coming from choosing an existing request in BP HOme page
		visible false

	with actions
		; TODO: this property has to be populated by framework, it is an ambient property that precedes the form
		; if the property is present and has a value it means the user opened an existing request from the BP HOME
		; then it remais to determine the final syntax for accessing this property from the rules
		; or either, hardcode the rule in xtml
		load data from DATASOURCE.W4E_GetUserInfo with arguments {UserAccount : REQUEST.USER_ACCOUNT} with output {HF_UserCostLocationUnit.Value : CostLocationUnit, HF_UserCountry: UserCountry}

	with rules
		; TODO: this property has to be populated by framework, it is an ambient property that precedes the form
		; if the property is present and has a value it means the user opened an existing request from the BP HOME
		; then it remais to determine the final syntax for accessing this property from the rules
		; or either, hardcode the rule in xtml
		REQUEST.REQUEST_ID is not empty then
			load data from DATASOURCE.MDMV3_GetBasicRequestData with arguments {RequestID : REQUEST.REQUEST_ID} with output {HF_CurrentRole.Value : CurrentRole, HF_RequestState.Value : RequestState, HF_RequestType.Value : RequestType, HF_RegionalCountry.Value : RegionalCountry, HF_CompanyCode.Value : CompanyCode, HF_PurchaseOrg.Value : PurchaseOrg, HF_VendorCountry.Value : VendorCountry}
			; TODO: This must come from REQUEST loaded from DB
			load data from DATASOURCE.MDMV3_GetCountryData with arguments {CountryCode : REQUEST.REGIONAL_COUNTRY } with output {HF_RiskClassification.Value : RiskClassification, HF_AccountGroup.Value : AccountGroup, HF_Language.Value : DefaultLanguage, HF_MandatoryIBAN.Value : MandatoryIBAN, HF_IsTaxHeaven.Value : TaxHeavenBlackList_Source, HF_RegionIsMandatory.Value : Region_IsMandatory, HF_TaxCode1Mandatory.Value : TaxCode1IsMandatory, HF_TaxCode2Mandatory.Value : TaxCode2IsMandatory, HF_VATMandatory.Value : VATIsMandatory, HF_IsEU.Value : IsEU }
		else
			load data from DATASOURCE.MDMV3_GetCountryData with arguments {CountryCode : DDLCDCountry.Value } with output {HF_RiskClassification.Value : RiskClassification, HF_AccountGroup.Value : AccountGroup, HF_Language.Value : DefaultLanguage, HF_MandatoryIBAN.Value : MandatoryIBAN, HF_IsTaxHeaven.Value : TaxHeavenBlackList_Source, HF_RegionIsMandatory.Value : Region_IsMandatory, HF_TaxCode1Mandatory.Value : TaxCode1IsMandatory, HF_TaxCode2Mandatory.Value : TaxCode2IsMandatory, HF_VATMandatory.Value : VATIsMandatory, HF_IsEU.Value : IsEU }

	with triggers
		this loads

; ----------------------------------------------------------------------------	


; -- AccountGroup	DisplayName
;	 'YVT1'	Belgium/Belgique
;	 'YVT2'	Luxembourg
;	 'YVT3'	Spain/Espagne
;	 'YVT4'	Portugal/Portugal
;	 'YVT5'	Italy/Italie
;	 'YVT6'	Reunion/Réunion
;	 'YVT6'	Martinique/Martinique
;	 'YVT6'	France Metropolitaine
;	 'YVT6'	French Guayana/Guyane franç.
;	 'YVT6'	Guadeloupe
;	 'YVT7'	Greece/Grèce


; ----------------------------------------------------------------------------	
;     SEARCH FORM 
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4
Entity rbSpiridon is RadioButton in frmSearch
	with defaults
		enabled false
		label "Spiridon"
		value true				; means checked

; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=4
Entity rbEPass is RadioButton in frmSearch
	with defaults
		enabled false
		label "Epass"
		value false				; means unchecked

; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=4, ACTIONS=3, TRIGGERS=1
Entity TBVendorName is TextBox in frmSearch
	with defaults
		enabled true
		visible
		value ''
		label LABELS.NAME
		
	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid
		clear vendorSearchResultGrid
		; TODO: CHECK WITH SEB IF THIS IS NEEDED
		; set value '' in MESSAGE_POPUP

	with triggers
		this changes

; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=4, ACTIONS=3, TRIGGERS=1

Entity TBVendorCity is TextBox in frmSearch
	with defaults
		value ''
		label LABELS.labVendorCity

	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid
		clear vendorSearchResultGrid

	with triggers
		this changes

; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=7, ACTIONS=3, RULES=2, CONSTRAINTS=0,TRIGGERS=1
Entity TBVendorNumber is TextBox in frmSearch
	with defaults
		visible true
		value ''
		max length 10
		min length 10
		label LABELS.labVendorNumber
		validation ^[0-9]{10}$


	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid
		clear vendorSearchResultGrid

	with rules
		; show this message "This partner is not managed by Madam. Please contact GSS master data team." if starting with 0
		TBVendorNumber.text starts with 0 then
			set value MESSAGES.ERRPartnerNotManaged in MESSAGE_POPUP
	with triggers
		this changes
			
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=1, ACTIONS=3, TRIGGERS=1
Entity TBVendorIFA is TextBox in frmSearch
	with defaults
		visible true
		value ''
		label LABELS.labVendorIFA

	with actions
		hide btnCreateVendor
		hide vendorSearchResultGrid
		clear vendorSearchResultGrid
	
	with rules
		TBVendorIFA.value is empty then 
			DDLVDCountry mandatory
		else 
			DDLVDCountry not mandatory

	with triggers
		this changes
				
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=7, RULES=4, ACTIONS=4, TRIGGERS=1
Entity DDLVDCountry is DropDownList in frmSearch
	with defaults
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_Countries with arguments {FlagActive : true}
		value HF_UserCountry.Value		; preselect user country if there is data in SCD for this user
		label LABELS.labCountry

	with actions
		set value '' in MESSAGE_POPUP
		hide vendorSearchResultGrid
		hide btnCreateVendor
		clear vendorSearchResultGrid

	with rules
		DDLVDCountry.value in {'FR','GF','GP','RE','MQ','YT','NC','PF','PM','WF','MC','TF'} then label LABELS.labSIRET in TBVendorVAT
		DDLVDCountry.value in {'PT','ES'} then label LABELS.labNIF in TBVendorVAT
		DDLVDCountry.value is 'IT' then label LABELS.labPartitaIVA in TBVendorVAT
		DDLVDCountry.value not in {'PT','ES','IT','FR','GF','GP','RE','MQ','YT','NC','PF','PM','WF','MC'} then label LABELS.labVAT in TBVendorVAT
	
	with triggers
		this changes 

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, ACTIONS=3, RULES=0, TRIGGERS=1
Entity TBVendorVAT is TextBox in frmSearch
	with defaults
		visible true
		value ''
		label LABELS.labVendorVAT

	with actions
		hide btnCreateVendor
		set hidden vendorSearchResultGrid
		clear vendorSearchResultGrid

	with triggers
		this changes
		
; ----------------------------------------------------------------------------	


; TESTGEN : DEFAULTS=8, ACTIONS=5, RULES=0, TRIGGERS=1
Entity DDLCDCountry is DropDownList in frmSearch
	with defaults
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_ClusterCountries
		value HF_UserCountry.Value		; preselect user country if there is data in SCD for this user
		label LABELS.labCountry
		mandatory true
	
	with actions
		; load active companies for this country
		load data from DATASOURCE.MDMV3_ClusterCompanies with arguments {FlagActive : true, CountryCode : DDLCDCountry.Value} in DDLCDCompany
		clear vendorSearchResultGrid
		set hidden vendorSearchResultGrid
		hide btnCreateVendor
		clear DDLCDPurchOrg

	with triggers
		this changes

; ----------------------------------------------------------------------------	


; TESTGEN : DEFAULTS=6,ACTIONS=5, RULES=0, TRIGGERS=1
Entity DDLCDCompany is DropDownList in frmSearch
	with defaults
		label LABELS.labCompany
		mandatory true
		data field DisplayName
		value field Code

	with actions
		; load active companies for this country
		load data from DATASOURCE.MDMV3_ClusterPurchaseOrganizations with arguments {FlagActive : true, ClusterCompanyCode: DDLCDCompany.Value} in DDLCDPurchOrg 
		set value HF_UserCostLocationUnit.Value in DDLCDCompany			; another data constant
		clear vendorSearchResultGrid
		set hidden vendorSearchResultGrid
		hide btnCreateVendor

	with triggers
		this changes

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=7, ACTIONS=4, RULES=0, TRIGGERS=1
Entity DDLCDPurchOrg is DropDownList in frmSearch
	with defaults
		data field DisplayName
		value field Code
		value ''
		label LABELS.labPURCHASEORG
		mandatory true

	with actions
		clear vendorSearchResultGrid
		hide vendorSearchResultGrid
		hide btnCreateVendor

	with triggers
		this changes	

; ----------------------------------------------------------------------------	

; replacing HF_RequestState.Value 
; TODO: Pending on SEB and FD input?
; Entity HF_RequestState is TextBox in frmMain
; 	with defaults
; 		visible false
; 
; Entity HF_SearchOKFlag is CheckBox in frmMain
; 	with defaults
; 		visible false
; Entity AAA is TextBox in frmMain
;	with defaults
;		visible false
;		hiddenfield true
;  TODO: also declare lilke this conceptual model replacements
; ----------------------------------------------------------------------------	



; TESTGEN : DEFAULTS=3, ACTIONS=1, RULES=10, TRIGGERS=1
; hidden field 1 -> HF_FlagUserCanSearch, to see if user is allowed to do that search
; hidden field 2 -> HF_FlagSearchCriteriaIncomplete -> means that a validation to make sure the search can be done has failed, not enough parameters

Entity btnSearch is Button in frmSearch

	with defaults
		label LABELS.btnSearch

	with actions
		; always perform this conditionless action when the button is clicked
		; arguments might vary from search to search so it makes sense to run it everytime
		load data from DATASOURCE.IsUserInROLE with arguments { UserAccount : HF_UserAccount.Value, RoleCode : USER.CURRENT_ROLE, ClusterCountryCode : DDLCDCountry.Value, ClusterCompanyCode : DDLCDCompany.Value, ClusterPOCode : DDLCDSalesOrg.Value, IsIndirectMaterial : 0} in HF_FlagUserCanSearch
        
	with rules

		; if hidden field’s value, which is a checkbox is false, then show no auth message
		HF_FlagUserCanSearch.Value is false then 
			set value MESSAGES.ERRauthCCPO in MESSAGE_POPUP

        ; since we cannot exit rule block we need to involve the flag in every successive rule as a guard for all of them
		HF_FlagUserCanSearch.Value is true and TBVendorNumber is not empty and TBVendorNumber.Value.Length is not 10 then
			set value MESSAGES.ERRVendorNumeber10 in MESSAGE_POPUP
            ; missing mandatory parameters for search, so set to true this second flag
			set value true in HF_FlagSearchCriteriaIncomplete

        
		HF_FlagUserCanSearch.Value is true and TBVendorNumber is not empty and TBVendorNumber.Value.Length is not 10 then
			set value MESSAGES.ERRVendorNumeber10 in MESSAGE_POPUP
			set value true in  HF_FlagSearchCriteriaIncomplete

		HF_FlagUserCanSearch.Value is true and DDLVDCountry is empty then
			add value MESSAGES.ERRfieldVCountry in MESSAGE_POPUP
			set value true in  HF_FlagSearchCriteriaIncomplete

        
		HF_FlagUserCanSearch.Value is true and TBVendorName is empty and TBVendorCity is empty and TBVendorIFA is empty then
			add value MESSAGES.ERRKeyTaxField in MESSAGE_POPUP
			set value true in  HF_FlagSearchCriteriaIncomplete

		HF_FlagUserCanSearch.Value is true and TBVendorName is empty and TBVendorCity is empty and TBVendorIFA is empty and DDLVDCountry is empty and TBVendorVAT is empty then
			add value MESSAGES.ERRKeyTaxField in MESSAGE_POPUP
			set value true in  HF_FlagSearchCriteriaIncomplete

		HF_FlagUserCanSearch.Value is true and TBVendorName is empty and TBVendorCity is not empty and TBVendorName is empty and TBVendorIFA is empty and DDLVDCountry is empty and TBVendorVAT is empty then
			add value MESSAGES.ERRKeyTaxField in MESSAGE_POPUP
			set value true in  HF_FlagSearchCriteriaIncomplete

		HF_FlagUserCanSearch.Value is true and DDLCDCountry is empty or DDLCDCompany is empty or DDLCDPurchOrg is empty then
			add value MESSAGES.ERRfieldCCPO in MESSAGE_POPUP
			set value true in  HF_FlagSearchCriteriaIncomplete
                                       
		HF_FlagUserCanSearch.Value is true and HF_FlagSearchCriteriaIncomplete.Value is false then
			load data from WEBSERVICE.VENDOR_SEARCH_SERVICE with arguments {VendorName:TBVendorName.Value, VendorCity:TBVendorCity, VendorNumber:TBVendorNumber.Value, VendorCountry:DDLVDCountry.Value,TaxCode1:TBVendorVAT.Value,TaxCode4:TBVendorIFA.Value, Country:DDLVDCountry.Value, CompanyCode:DDLCDCompany.Value, SalesOrganization:DDLCDSalesOrg.Value, Division:DDLCDivision } in vendorSearchResultGrid
                
		HF_FlagUserCanSearch.Value is true and HF_FlagSearchCriteriaIncomplete.Value is false and vendorSearchResultGrid.Items.Count = 0 then
			set value MESSAGES.MSGNoValuesFound in MESSAGE_POPUP
			btnCreateVendor visible true
			VendorSearchResultGrid_sec visible false

		HF_FlagUserCanSearch.Value is true and HF_FlagSearchCriteriaIncomplete.Value is false and vendorSearchResultGrid.Items.Count > 0 then
			btnCreateVendor visible false
			VendorSearchResultGrid_sec visible true


	with triggers
		this on click

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, ACTIONS=7, RULES=0, TRIGGERS=1
Entity btnCreateVendor is Button in frmSearch
	with defaults
		visible false
		label LABELS.btnCreateVendor

	with actions
		
		set value DDLCDCountry.Value in HF_RegionalCountry
		set value DDLCDCompany.Value in HF_CompanyCode
		set value DDLCDSalesOrg.Value in HF_SalesOrg
		set value DDLVDCountry.Value in HF_VendorCountry
		set value TBCustomerName.Value in GD_Adr_Name

		frmMain visible true
		frmSearch visible false

	with triggers
		this on click

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3
Entity VendorSearchResultGrid_sec is Div in frmSearch
	with defaults
		visible false
		label LABELS.lblResult

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=27, RULES=0, TRIGGERS=0
Entity vendorSearchResultGrid is Grid in frmSearch
	with defaults
		visible false
		define column Country with arguments {  DataField: Country, Header : LABELS.lblCountry, Visible : true }
		define column Vat with arguments {  DataField: VAT, Header : LABELS.lblVatRegNo, Visible : true }
		define column Customer with arguments {  DataField: CustomerNumber, Header : LABELS.lblCustomer, Visible : true }
		define column Vendor with arguments {  DataField: VendorNumber, Header : LABELS.lblVendor, Visible : true }  
		define column NaturalPerson with arguments {  DataField: IsNaturalPerson, Header : LABELS.labGD_Ctr_IsNaturalPerson, Visible : true }
		define column name1 with arguments {  DataField: Name1, Header : LABELS.lblName, Visible : true }  
		define column name3 with arguments {  DataField: Name3, Header : LABELS.lblComment, Visible : true }  
		define column Street with arguments {  DataField: Street, Header : LABELS.lblStreet, Visible : true }  
		define column City with arguments {  DataField: City, Header : LABELS.lblCity, Visible : true }  
		define column Taxcode with arguments {  DataField: Taxcode, Header : LABELS.lblLocal_Tax_Code, Visible : true }  
		define column Risk with arguments {  DataField: RiskClassification, Header : LABELS.lblRiskClass, Visible : true }
		define column LFA1_SPERR with arguments {  DataField: HasCentralPostingBlock, Header : LABELS.lblCentralPostingBlock , Visible : true }
		define column LFA1_SPERM with arguments {  DataField: HasCentralPurchasingBlock, Header : LABELS.lblCentralPurchBlock , Visible : true }
		define column LFB1_LOEVM with arguments {  DataField: HasDeletionFlagForCompanyCode, Header : LABELS.lblCentralDelFlag   , Visible : true }
		define column LFM1_LOEVM with arguments {  DataField: HasCentralDeletionBlock, Header : LABELS.lblCentralDelBlock, Visible : true }  
		define column Company with arguments {  DataField: Company, Header : LABELS.lblCompany   , Visible : true }
		define column KNB1_FRGRP with arguments {  DataField: ReleaseGroup, Header : LABELS.lblBusinessPartnerClass  , Visible : true }
		define column KNB1_ZTERM with arguments {  DataField: TermsOfPaymentKeyAtCompanyCodeLevel, Header : LABELS.labPTPaymentTerms  , Visible : true }
		define column KNB1_SPERR with arguments {  DataField: HasCompanyCodePostingBlock, Header : LABELS.lblPostingBlock1  	, Visible : true }
		define column LFB1_LOEVM2 with arguments {  DataField: HasDeletionFlagForCompanyCode, Header : LABELS.lblDeletionFlag   , Visible : true }
		define column PO with arguments {  DataField: PO, Header : LABELS.lblPurchOrganiz, Visible : true }
		define column LFM1_LOEVM2 with arguments {  DataField: HasPurchOrgDeletionBlock, Header : LABELS.lblDelBlock, Visible : true }  
		define column LFM1_SPERM with arguments {  DataField: HasPurchasingBlockAtPurchasingOrganizationLevel, Header : LABELS.lblPurcOBlock , Visible : true }
		define column LFM1_NODEL with arguments {  DataField: HasPurchOrgDeletionBlock, Header : LABELS.lblPurchODelFlag, Visible : true }
		; button columns
		define column CreateButton with arguments { DisplayAs : Button,  Header : LABELS.lblAction, Text: LABELS.lblCreate, Visible: false}
		define column ModifyButton with arguments { DisplayAs : Button, Header : LABELS.lblAction, Text: LABELS.lblModify, Visible: false}
		define column BlockButton with arguments { DisplayAs : Button, Header : LABELS.lblAction, Text: LABELS.lblBlock, Visible: false}

	with rules
		
	
		; these rules have to be applied row by row of course
		; Company.Value is empty then
		; 	CreateButton visible true
		; 	set value LABELS.lblToBeCreated in Company
		; 
		; PO.Value is empty then
		; 	CreateButton visible true
		; 	set value LABELS.lblToBeCreated in PO
		; 	
		; Company.Value is not empty and PO.Value is not empty then
		; 	ModifyButton visible true
		; 	BlockButton visible true

	; with triggers
	; 	; TODO: ASK SEB is this form.load but then what about grid load?
	; 	this loads

; ----------------------------------------------------------------------------	
;     END OF SEARCH FORM DEFINITION
; ----------------------------------------------------------------------------	




; ----------------------------------------------------------------------------	
; BEGIN MAIN FORM CONTROL DEFINITION
; ----------------------------------------------------------------------------	

; -- RULES FOR VENDOR MAIN FORM (MDM.ASPX)

; ----------------------------------------------------------------------------	


; TESTGEN : DEFAULTS=8, RULES=4, ACTIONS=1, TRIGGERS=2
Entity GD_Ctr_RiskClassification is DropDownList in frmMain

	with defaults
		data field DisplayName
		value field Code
		; only two values, 00 and 09
		load data from DATASOURCE.MDMV3_RiskClassifications
		value '00'
		label LABELS.labGD_Ctr_RiskClassification
		mandatory true

	with rules
		
		GD_Ctr_RiskClassification.Value is empty then
			GD_Ctr_RiskClassification enabled true

		CC_AM_BPClassification is enabled then
			GD_Ctr_RiskClassification enabled true

		HF_CurrentRole.Value in {'MDMV3_ENQ', 'MDMV3_RCO', 'MDMV3_CLERK'} then 
			this enabled true
		else
			this enabled false

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM'} then
			this enable false

	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
		this loads

; ----------------------------------------------------------------------------	


; TESTGEN : DEFAULTS=8, RULES=1, ACTIONS=0, TRIGGERS=3
Entity GD_Adr_Country is DropDownList in frmMain

	with defaults
		data field DisplayName
		value field Code
		enabled false					; this control is always disabled
		load data from DATASOURCE.MDMV3_Countries
		value HF_UserCountry.Value				; -- depends on country selected in search form, so this data has to be passed
		mandatory true
		label LABELS.labGD_GD_Adr_Country

	with rules
		GD_Adr_Country.Value is 'ES' and GD_Ctr_VendorClassification is not 'G' and GD_Ctr_TaxCode1.Value starts with {'P','Q','S'} then
			set value 'G' in GD_Ctr_VendorClassification

	with triggers
		this loads
		GD_Ctr_VendorClassification changes
		GD_Ctr_TaxCode1 changes
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=8, RULES=4, ACTIONS=1, TRIGGERS=2
Entity GD_Ctr_VendorClassification is DropDownList in frmMain

	with defaults
		data field DisplayName
		value field Code
		visible true
		enabled true
		load data from DATASOURCE.MDMV3_PartnerClassification
		value 'NG'
		mandatory true
		label LABELS.labGD_Ctr_VendorClassification

	with rules
		
		HF_VendorCountry.Value is 'ES' and GD_Ctr_TaxCode1.Text starts with {'1','2','3','4','5','6','7','8','9','X'} then
			set value true in GD_Ctr_IsNaturalPerson			
			set value 'ES' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_TaxCode1.Value in GD_Ctr_VATRegistrationNumber
			set value 'NG' in GD_Ctr_VendorClassification

		HF_VendorCountry.Value is 'ES' and GD_Ctr_TaxCode1.Text starts with {'P','Q','S'} then 
			set value 'G' in GD_Ctr_VendorClassification

		HF_VendorCountry.Value is 'ES' and GD_Ctr_TaxCode1.Text starts with X then 
			set value 'NG' in GD_Ctr_VendorClassification
		
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM'} then
			this enable false

	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=8, RULES=4, ACTIONS=1, TRIGGERS=2
Entity CC_AM_BPClassification is DropDownList in frmMain

	with defaults
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_ReleaseGroups
		value 'NORM'
		mandatory true
		label LABELS.labCC_AM_BPClassification

	with rules

		CC_AM_BPClassification.Value in {'BPHR','BPMR'} then 
			ATTACHMENT mandatory true

		HF_CurrentRole.Value is 'MDMV3_RCO' and HF_RegionalCountry.Value in {'IT', 'GR'} then
			this enabled 

		HF_CurrentRole.Value in {'MDMV3_ENQ', 'MDMV3_RCO', 'MDMV3_CLERK'} then 
			this enabled true

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM'} then
			this enable false

	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=8, RULES=2, ACTIONS=1, TRIGGERS=2
Entity GD_Damex is DropDownList in frmMain
	with defaults
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_YES_NO
		value ''
		mandatory true
		label LABELS.labGD_Damex

	with actions
		ATTACHMENT mandatory true

	with rules

		HF_RequestType.Value not in {'VC', 'VC_CC'} then 
			this not mandatory
			this not visible

		; not any more, apparently
		; HF_RegionalCountry.Value in {'GR','BE'} then
		; 	this not mandatory
		; 	this not visible
		
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this changes
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=2, TRIGGERS=2
Entity GD_DamexNote is CheckBox in frmMain
	with defaults
		visible true
		enabled true
		value LABELS.labGD_DamexNote

	with rules
		GD_DamexNote.Value is true then
			ATTACHMENT mandatory true

		; not any more, apparently
		; HF_RegionalCountry.Value in {'GR','BE'} then
		; 	this not mandatory
		; 	this not visible
		
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this changes
		this loads

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=17, ACTIONS=1, TRIGGERS=2
Entity GD_Ctr_IsNaturalPerson is CheckBox in frmMain
	with defaults
		value false		; unchecked
		label LABELS.labGD_Ctr_IsNaturalPerson

	with rules

		HF_AccountGroup.Value in {'YVT4', 'YVT5'} and GD_Ctr_IsNaturalPerson.Value is true then
			GD_NatP_DateOfBirth visible true
			GD_NatP_DateOfBirth mandatory true
			GD_NatP_PlaceOfBirth visible true
			GD_NatP_PlaceOfBirth mandatory true
			GD_NatP_Profession visible true
			GD_NatP_Sex visible true
			GD_NatP_Sex mandatory true
			GD_NatP_Exemption visible true
			GD_NatP_Exemption mandatory true

		HF_AccountGroup.Value in {'YVT4', 'YVT5'} and GD_Ctr_IsNaturalPerson.Value is false then
			GD_NatP_DateOfBirth visible false
			GD_NatP_DateOfBirth mandatory false
			GD_NatP_PlaceOfBirth visible false
			GD_NatP_PlaceOfBirth mandatory false
			GD_NatP_Profession visible false
			GD_NatP_Sex visible false
			GD_NatP_Sex mandatory false
			GD_NatP_Exemption visible false	
			GD_NatP_Exemption mandatory false

		HF_RegionalCountry.Value in {'GR','BE','LU'} and GD_Ctr_IsNaturalPerson.Value is true then
			GD_NatP_DateOfBirth visible true
			GD_NatP_PlaceOfBirth visible true
			GD_NatP_Profession visible true
			GD_NatP_Sex visible true
			GD_NatP_Exemption visible true

		HF_RegionalCountry.Value in {'GR','BE','LU'} and GD_Ctr_IsNaturalPerson.Value is false then
			GD_NatP_DateOfBirth visible false
			GD_NatP_PlaceOfBirth visible false
			GD_NatP_Profession visible false
			GD_NatP_Sex visible false
			GD_NatP_Exemption visible false

		HF_RegionalCountry.Value is 'PT' and GD_Ctr_IsNaturalPerson.Value is true then
			GD_NatP_DateOfBirth visible true
			GD_NatP_PlaceOfBirth visible true
			GD_NatP_Profession visible true
			GD_NatP_Sex visible true
			GD_NatP_Exemption visible true
			GD_NatP_Exemption mandatory true

		HF_RegionalCountry.Value is 'PT' and GD_Ctr_IsNaturalPerson.Value is false then
			GD_NatP_DateOfBirth visible false
			GD_NatP_PlaceOfBirth visible false
			GD_NatP_Profession visible false
			GD_NatP_Sex visible false
			GD_NatP_Exemption visible false
			GD_NatP_Exemption mandatory false

		HF_CurrentRole.Value is 'MDMV3_RCO' and HF_RegionalCountry.Value in {'IT', 'GR'} then
			this enabled true

		HF_RegionalCountry.Value is 'ES' and GD_Ctr_TaxCode1.Value starts with {'P', 'Q','S'} then
			set value false in GD_Ctr_IsNaturalPerson

		HF_VendorCountry.Value is 'ES' and GD_Ctr_TaxCode1.Text starts with {'1','2','3','4','5','6','7','8','9','X'} then
			set value true in GD_Ctr_IsNaturalPerson			
			set value 'ES' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_TaxCode1.Value in GD_Ctr_VATRegistrationNumber
			set value 'NG' in GD_Ctr_VendorClassification

		GD_Adr_Country.Value is 'ES' then
			set value GD_Ctr_IsNaturalPerson.Value in CC_AM_SubjectedToWHTax.Value

		GD_Ctr_IsNaturalPerson.Value is true then
			GD_Ctr_CF enable true
		else
			GD_Ctr_CF enable false

		GD_Ctr_IsNaturalPerson.Value is true and GD_Adr_Country.Value is 'IT' then
			GD_NatP_DateOfBirth mandatory true

		GD_NatP_DateOfBirth.IsMandatory is true or GD_NatP_DateOfBirth.IsMandatory is true then
			GD_NatP_PlaceOfBirth mandatory true
		else
			GD_NatP_PlaceOfBirth mandatory false
			
		GD_NatP_DateOfBirth.IsMandatory is true then
			GD_NatP_Sex mandatory true
		else
			GD_NatP_Sex mandatory false 

		GD_Adr_Country.Value is 'IT' and GD_Ctr_IsNaturalPerson.Value is true then
			GD_Ctr_TaxCode1 mandatory true
			GD_Ctr_TaxCode2 mandatory true

		GD_Adr_Country.Value is 'IT' and GD_Ctr_IsNaturalPerson.Value is false then
			GD_Ctr_TaxCode1 mandatory false
			GD_Ctr_TaxCode2 mandatory false

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM'} then
			this enable false

	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
		this loads

; ----------------------------------------------------------------------------	

; TESTGEN : RULES=2, DEFAULTS=4, TRIGGERS=1
Entity GD_Procur_SupplierDunsNumber is TextBox in frmMain
	with defaults
		max length 20
		label LABELS.labGD_Procur_SupplierDunsNumber

	with rules
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers 
		this loads

		
; ----------------------------------------------------------------------------	

;TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_Procur_Reason_Supplier is TextBox in frmMain
	with defaults
		max length 35
		label LABELS.labGD_Procur_Reason_Supplier

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers 
		this loads
; ----------------------------------------------------------------------------	

;TESTGEN : DEFAULTS=7, RULES=2, TRIGGERS=1
Entity GD_Procur_Supplier_OnContractBasis is DropDownList in frmMain
	with defaults
		data field DisplayName
		value field Code
		label LABELS.labGD_Procur_Supplier_OnContractBasis
		load data from DATASOURCE.MDMV3_YES_NO
		value ''
		
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers 
		this loads
; ----------------------------------------------------------------------------	

;TESTGEN : DEFAULTS=7, RULES=2, TRIGGERS=1
Entity GD_Procur_Supplier_IsOneTimeVendor is DropDownList in frmMain
	with defaults
		data field DisplayName
		value field Code
		label LABELS.labGD_Procur_Supplier_IsOneTimeVendor
		load data from DATASOURCE.MDMV3_YES_NO
		value ''

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers 
		this loads
; ----------------------------------------------------------------------------	

; TODO: TELL SEB THIS FIELD IS TO 'BE' DELETED FROM PROCUREMENT DATA
; Entity GD_Procur_Supplier_ContactPhone is TextBox in frmMain
; 	with defaults
; 		label LABELS.labGD_Procur_Supplier_ContactPhone
; 		max length 26
; 
; 	with actions
; 		; move to phone control
; 
; 	with triggers
; 		this exit
; 
; 	with rules
; 		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
; 			this enable false
; 		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
; 			this visible false

; TODO: ALSO TELL SEB PROCUREMENT DATA IS TO 'BE' HIDDEN ENTIRELY OR NOT DEPENDING ON FLOWTYPE

; ----------------------------------------------------------------------------	

; TODO: TELL SEB THIS FIELD IS TO 'BE' DELETED FROM PROCUREMENT DATA
; Entity GD_Procur_Supplier_ContactPerson is TextBox in frmMain
; 	with defaults
; 		label LABELS.labGD_Procur_Supplier_ContactPerson
; 		max length 47		
; 
; 	with rules
; 		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
; 			this enable false
; 		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
; 			this visible false
; 
; ----------------------------------------------------------------------------	

; TODO: TELL SEB THIS FIELD IS TO 'BE' DELETED FROM PROCUREMENT DATA
; Entity GD_Procur_Supplier_ContactEmail is TextBox in frmMain
; 	with defaults
; 		label LABELS.labGD_Procur_Supplier_ContactEmail
; 		max length 47		
; 
; 	with actions
; 		; move to email control
; 
;	with triggers
;		this exit
;
;	with rules
;		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
;			this enable false
;		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
;			this visible false

; ----------------------------------------------------------------------------	

; TESTGEN : RULES=2, DEFAULTS=3, TRIGGERS=1
Entity GD_Procur_MainProducts is TextBox in frmMain
	with defaults
		label LABELS.labGD_Procur_MainProducts

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, ACTIONS=1, TRIGGERS=2
Entity GD_Procur_SuppliersName is TextBox in frmMain
	with defaults
		max length 32
		label LABELS.labGD_Procur_SuppliersName

	with actions
		set value GD_Procur_SuppliersName.Value in GD_Adr_Name
	with rules
	
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this changes
		this loads

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_Procur_SuppliersName2 is TextBox in frmMain
	with defaults
		max length 32
		; actually they have no label text
		label ''

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_Procur_SuppliersName3 is TextBox in frmMain
	with defaults
		max length 32
		label ''

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads			

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_Procur_SuppliersName4 is TextBox in frmMain
	with defaults
		max length 32
		label ''
		
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads			

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=5, RULES=2, TRIGGERS=1
Entity GD_Procur_Reason_Justification is TextBox in frmMain
	with defaults
		max length 1000
		mandatory true
		label LABELS.labGD_Procur_Reason_Justification

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
			this mandatory false
	with triggers
		this loads			

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_Procur_MainActivity is TextBox in frmMain
	with defaults
		label LABELS.labGD_Procur_MainActivity
		max length 255
		
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads			

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=8, RULES=4, TRIGGERS=2
Entity GD_Procur_Supplier_ExpectedPVO is DropDownList in frmMain
	with defaults
		label LABELS.labGD_Procur_Supplier_ExpectedPVO
		mandatory true
		; by default it shows the first item in the list which is blank
		data field DisplayName
		value field Code
		load data from DATASOURCE.YearlyTurnover
		value ''

	with rules

		; 3 and 4 are the values for the last two values in the combo
		; if the value is one of those, a series of other controls have to be shown (GD_PVO_Question 1 to 5)
		GD_Procur_Supplier_ExpectedPVO.Value in {'3', '4'} then
			GD_PVO_Question1 visible
			GD_PVO_Question1 mandatory
			GD_PVO_Question2 visible
			GD_PVO_Question2 mandatory
			GD_PVO_Question3 visible
			GD_PVO_Question3 mandatory
			GD_PVO_Question4 visible
			GD_PVO_Question4 mandatory
			GD_PVO_Question5 visible
			GD_PVO_Question5 mandatory

		GD_Procur_Supplier_ExpectedPVO.Value not in {'3', '4'} then
			GD_PVO_Question1 visible false
			GD_PVO_Question1 mandatory false
			GD_PVO_Question2 visible false
			GD_PVO_Question2 mandatory false
			GD_PVO_Question3 visible false
			GD_PVO_Question3 mandatory false
			GD_PVO_Question4 visible false
			GD_PVO_Question4 mandatory false
			GD_PVO_Question5 visible false
			GD_PVO_Question5 mandatory false

		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
			this mandatory false
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this changes
		this loads
; ----------------------------------------------------------------------------

; TESTGEN : DEFAULTS=8, RULES=4, TRIGGERS=2
Entity GD_PVO_Question1 is DropDownList in frmMain
	with defaults
		data field DisplayName
		value field Code
		visible false
		label LABELS.labGD_PVO_Question1
		mandatory false
		load data from DATASOURCE.MDMV3_YES_NO
		value ''

	with rules

		GD_PVO_Question1.Value is true then GD_PVO_Link1 visible
		GD_PVO_Question1.Value is false then GD_PVO_Link1 not visible
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false			

	with triggers
		this changes
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=8, RULES=4, TRIGGERS=2
Entity GD_PVO_Question2 is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labGD_PVO_Question2
		mandatory false
		; high risk country or low risk country
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_PVO_Question2_Options
		value ''


	with rules

		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false

		GD_PVO_Question2.Value is 'HR' then GD_PVO_Link2 visible
		GD_PVO_Question2.Value is 'LR' then GD_PVO_Link2 not visible

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this changes
		this loads
		
; ----------------------------------------------------------------------------	
	
; TESTGEN : DEFAULTS=8, RULES=4, TRIGGERS=2
Entity GD_PVO_Question3 is DropDownList in frmMain
	with defaults
		data field DisplayName
		value field Code
		visible false
		label LABELS.labGD_PVO_Question3
		mandatory false
		; high risk country or low risk country
		load data from DATASOURCE.MDMV3_YES_NO
		value ''
		
	with rules

		this.Value is true then GD_PVO_Link3 visible
		this.Value is false then GD_PVO_Link3 not visible
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this changes
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=8, RULES=4, TRIGGERS=2
Entity GD_PVO_Question4 is DropDownList in frmMain
	with defaults
		data field DisplayName
		value field Code
		visible false
		label LABELS.labGD_PVO_Question4
		mandatory false
		; values: low, average, high
		load data from DATASOURCE.MDMV3_PVO_Question4_Options
		value ''
		

	with rules

		GD_PVO_Question4.Value is 'HR' then GD_PVO_Link4 visible
		GD_PVO_Question4.Value is not 'HR' then GD_PVO_Link4 not visible

		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this changes
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=8, RULES=4, TRIGGERS=2
Entity GD_PVO_Question5 is DropDownList in frmMain
	with defaults
		data field DisplayName
		value field Code
		visible false
		label LABELS.labGD_PVO_Question5
		mandatory false
		load data from DATASOURCE.MDMV3_YES_NO
		value ''

	with rules

		GD_PVO_Question5.Value is true then GD_PVO_Link5 visible
		GD_PVO_Question5.Value is false then GD_PVO_Link5 not visible

		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this changes
		this loads

; ----------------------------------------------------------------------------	

;  this.GD_PVO_Link1.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/1.-Basic%20Quality%20Requirements%20and%20Certificates.doc";
;            this.GD_PVO_Link2.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/2.-Corporate%20Responsibility%20Self%20Assessment.doc";
;            this.GD_PVO_Link3.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/3.-Security%20in%20the%20supply%20chain%20-%20customs%20security%20initiatives.doc";
;            this.GD_PVO_Link4.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/4.-Future%20influence%20in%20Siemens.xlsx";
;            this.GD_PVO_Link5.HRef = "~/Resources/MDM/Templates/" + this.m_mdmSessionInfo.RegionalCountry + "/5.-Environmental%20Protection,%20Health%20Management%20and%20Safety.doc";


; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_PVO_Link1 is HyperLink in frmMain
	with defaults
		label LABELS.MDMFillDoc
		value "~/Resources/MDM/Templates/1.-Basic%20Quality%20Requirements%20and%20Certificates.doc"
		visible false
		
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_PVO_Link2 is HyperLink in frmMain
	with defaults
		label LABELS.MDMFillDoc
		value "https://workspace.swe.siemens.com/content/70000071/07/22978293/Docs/2.-Corporate%20Responsibility%20Self%20Assessment.doc"
		visible false

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_PVO_Link3 is HyperLink in frmMain
	with defaults
		label LABELS.MDMFillDoc
		value "https://workspace.swe.siemens.com/content/70000071/07/22978293/Docs/3.-Security%20in%20the%20supply%20chain%20-%20customs%20security%20initiatives.doc"
		visible false

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_PVO_Link4 is HyperLink in frmMain
	with defaults
		label LABELS.MDMFillDoc
		value "https://workspace.swe.siemens.com/content/70000071/07/22978293/Docs/4.-Future%20influence%20in%20Siemens.xlsx"
		visible false

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_PVO_Link5 is HyperLink in frmMain
	with defaults
		label LABELS.MDMFillDoc
		value "https://workspace.swe.siemens.com/content/70000071/07/22978293/Docs/5.-Environmental%20Protection,%20Health%20Management%20and%20Safety.doc"
		visible false

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_Procur_GoodsToSiemens is TextBox in frmMain
	with defaults
		; bd field length
		max length 250
		mandatory true

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
			this mandatory false
	with triggers
		this loads
; ----------------------------------------------------------------------------	


; TESTGEN : DEFAULTS=4, RULES=2, RULES=3, TRIGGERS=1
Entity GD_Procur_ESNCode  is TextBox in frmMain
	with defaults
		max length 3
		label LABELS.labGD_Procur_ESN

	with rules

		HF_RequestType.Value in {'VC', 'VC_CC'} then 
			GD_Procur_ESNCode mandatory

		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
			this mandatory false
			
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=2, TRIGGERS=1
Entity GD_Procur_ESNCode2 is TextBox in frmMain
	with defaults
		max length 3

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=2, TRIGGERS=1
Entity GD_Procur_ESNCode3 is TextBox in frmMain
	with defaults
		max length 3

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=2, TRIGGERS=1
Entity GD_Procur_ESNCode4 is TextBox in frmMain
	with defaults
		max length 3

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value in {'VM', 'VC_PO', 'VM_BLK', 'VM_UBLK'} then 
			this visible false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=5, RULES=1, ACTIONS=4, TRIGGERS=2
Entity GD_Adr_Name is TextBox in frmMain
	with defaults
		max length 32		
		label LABELS.labName
		mandatory true

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		ATTACHMENT mandatory  true 
		; _COMMENT_ mandatory  false
		set value SUBSTRING(GD_Adr_Name.Value,20) in GD_Adr_Search
		set value GD_Adr_Name.Value in B_GD_VB_AccountHolder
		set value GD_Adr_Name.Value in GD_Procur_SuppliersName

	with triggers 
		this changes
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=1, ACTIONS=1, TRIGGERS=2
Entity GD_Adr_Name2 is TextBox in frmMain
	with defaults
		max length 32

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		ATTACHMENT mandatory  true 
		; _COMMENT_ mandatory  false  

	with triggers 
		this changes
		this loads

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=4, TRIGGERS=1
Entity GD_Adr_Name3 is TextBox in frmMain
	with defaults
		max length 32
		; has no label

	with rules

		HF_AccountGroup.Value is 'YVT7' and HF_RequestType.Value in {'VC', 'VC_CC'} then
			mandatory true

		HF_RegionalCountry.Value is 'GR' and CURRENT_ROLE is 'MDMV3_ENQ' and HF_RequestType.Value not in {'VC','VC_CC'} then
			this mandatory false

		HF_CurrentRole.Value is 'MDMV3_CLERK' then
			this mandatory true

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers 
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=4, TRIGGERS=1
Entity GD_Adr_Name4 is TextBox in frmMain
	with defaults
		max length 32

	with rules

		HF_CompanyCode.Value is '5150' and HF_CurrentRole.Value is 'MDMV3_ENQ' and HF_RequestType.Value in {'VC','VC_CC'} then 
			GD_Adr_Name4 mandatory true
		
		HF_AccountGroup.Value is 'YVT7' and HF_RequestType.Value in {'VC', 'VC_CC'} then
			mandatory true

		HF_CurrentRole.Value is 'MDMV3_CLERK' then
			this mandatory true

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers 
		this loads
; ----------------------------------------------------------------------------

; TESTGEN : DEFAULTS=4, RULES=1, ACTIONS=2, TRIGGERS=2
Entity GD_Adr_Search is TextBox in frmMain
	with defaults
		enabled true
		visible true
		max length 20
		label LABELS.Search

	with actions
		ATTACHMENT mandatory true
		; set value toupper(GD_Adr_Name4.Value) in GD_Adr_Name4
		set value GD_Adr_Name4.Value in GD_Adr_Name4

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this changes
		this loads
; ----------------------------------------------------------------------------		

; TESTGEN : DEFAULTS=4, RULES=1, TRIGGERS=1
Entity GD_Com_Comment is TextBox in frmMain
	with defaults
		max length 35
		label LABELS.labComment
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=5, RULES=2, TRIGGERS=2, ACTIONS=1
Entity GD_Adr_Street is TextBox in frmMain
	with defaults
		max length 32
		label LABELS.labHouseNumber
		mandatory true

	with actions
		ATTACHMENT mandatory true

	with rules
		HF_RegionalCountry.Value is 'FR' then
			this mandatory false
			this visible false
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this changes
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=2, TRIGGERS=2, ACTIONS=1
Entity GD_Adr_Street2 is TextBox in frmMain
	with defaults
		max length 32
	with actions
		ATTACHMENT mandatory true
	with rules
		HF_RegionalCountry.Value is 'FR' then
			this mandatory false
			this visible false
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this changes
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=2, TRIGGERS=2, ACTIONS=1
Entity GD_Adr_Street3 is TextBox in frmMain
	with defaults
		max length 32
	with rules
		HF_RegionalCountry.Value is 'FR' then 
			GD_Adr_Street3 not visible
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=2, TRIGGERS=2, ACTIONS=1
Entity GD_Adr_Street4 is TextBox in frmMain
	with defaults
		max length 32
	with rules
		HF_RegionalCountry.Value is 'FR' then 
			GD_Adr_Street4 not visible
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
		this loads
; ----------------------------------------------------------------------------	

; TODO: TELL SEB THIS FIELD IS TO 'BE' DELETED
; Entity GD_Adr_Street5 is TextBox in frmMain
; 	with defaults
; 		max length 35
; 
; 	with rules
; 		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
; 			this enable false
; 		HF_RegionalCountry.Value is 'FR' then GD_Adr_Street5 not visible
		
; ----------------------------------------------------------------------------	


; TESTGEN : DEFAULTS=5, RULES=5, TRIGGERS=2
Entity GD_Adr_Region is DropDownList in frmMain
	with defaults
		enabled true
		visible true
		load data from DATASOURCE.MDMV3_Regions with arguments {FlagActive : true, CountryCode : HF_VendorCountry.Value }
		data field DisplayName
		value field Code

	with rules

		HF_AccountGroup.Value is 'YVT1' then
			this mandatory true

		HF_AccountGroup.Value is 'YVT1' and GD_Adr_Region.Value is '01' then
			set value 'NL' in GD_Com_Language

		HF_AccountGroup.Value is 'YVT1' and GD_Adr_Region.Value in {'02','03'} then
			set value 'FR' in GD_Com_Language

		HF_RegionalCountry.Value is 'FR' then
			set value GD_Adr_Region.SelectedValue in GD_Adr_PostalCode

		HF_AccountGroup.Value in {'YVT6','YVT9'} and HF_RegionIsMandatory.Value is true and HF_RequestType.Value is not 'VM_BLK' then
			this mandatory true

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this changes
		this loads
; ----------------------------------------------------------------------------	


; TESTGEN : DEFAULTS=9
Entity GD_Adr_CountryGD is DropDownList in frmMain

	with defaults
		label LABELS.labCountry
		mandatory true
		enabled false		; always disabled
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_Countries
		value HF_VendorCountry.Value

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=5, RULES=1, ACTIONS=1, TRIGGERS=2
Entity GD_Adr_City is TextBox in frmMain
	with defaults
		visible true		
		enabled true
		mandatory true
		max length 32
		label LABELS.labCity

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		on change
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=3, ACTIONS=1, TRIGGERS=2
; NOTE: NOT IN FM
Entity GD_Adr_City2 is TextBox in frmMain
	with defaults
		visible false		
		label LABELS.labDistrict
		max length 35

	with actions
		set value GD_Adr_City2.Value in PO_IncotermsPart2

	with rules
		
		HF_VendorCountry.Value is 'GR' and HF_RegionalCountry.Value is 'GR' then
			GD_Adr_City2 visible true

		HF_VendorCountry.Value is 'GR' and HF_RegionalCountry.Value is not 'GR' and HF_RequestType.Value is not 'VM_BLK' then
			GD_Adr_City2 visible true
			GD_Adr_City2 mandatory true

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers 
		on change
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=5, RULES=15, TRIGGERS=1
Entity GD_Adr_PostalCode is TextBox in frmMain
	with defaults
		max length 10
		mandatory true
		label LABELS.labPostalCode

	with rules

		;	IF vendor country belongs to 'YVT1'/'YVT2' -> Maxlength = 4 (only numbers - Format: XXXX)
		HF_AccountGroup.Value in {'YVT1', 'YVT2'} then
			max length 4
			validation ^[0-9]{4}$

		HF_AccountGroup.Value in {'YVT3', 'YVT5', 'YVT7'} then
			max length 5
			validation ^[0-9]{5}$

		GD_Adr_CountryGD.Value is 'PT' then
			max length 8
			validation ^[0-9]{4}-[0-9]{3}$

		HF_VendorCountry.Value is 'ES' then
			max length 5
			validation ^[0-5]{1}[1-2]{1}[0-9]{3}$

		HF_VendorCountry.Value in {IT, GR} then
			max length 5

		; post code must be >=1500 and <=3999 OR >=8000 and <=9999
		; the regular expression covers the ranges
		HF_VendorCountry.Value is 'BE' and GD_Adr_Region is 01 then
			max length 4
			validation ^(1[5-9][0-9]{2}){1}|((2|3)[0-9]{3}){1}|((8|9)[0-9]{3})$
		
		; post code must be >=1300 and <=1499 OR >=4000 and <=7999
		HF_VendorCountry.Value is 'BE' and GD_Adr_Region is 02 then
			max length 4
			validation ^(1[3-4][0-9]{2}){1}|([4-7][0-9]{3})$

		; post code must be >=1000 and <=1299
		HF_VendorCountry.Value is 'BE' and GD_Adr_Region is 03 then
			max length 4
			validation ^(1[0-2][0-9]{2})$

		HF_VendorCountry.Value in {FR, GF, GP, MC, MQ, NC, PF, PM, RE, WF, YT} then
			max length 5
			validation ^[0-9]{5}$
			set value SUBSTRING(GD_Adr_PostalCode.Value,2) in GD_Adr_Region

		GD_Adr_CountryGD.Value is 'ES' then
			tooltip MESSAGES.ERRSpanishPC5

		GD_Adr_CountryGD.Value is 'PT' then
			tooltip MESSAGES.ERRPortuguesePCFormat

		GD_Adr_CountryGD.Value is 'IT' then
			tooltip MESSAGES.ERRItalianPC5

		HF_CompanyCode.Value is 5150 then	
			this mandatory true

		HF_CurrentRole.Value is 'MDMV3_CLERK' then
			this mandatory true

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=5, TRIGGERS=2, ACTIONS=0
Entity GD_Adr_POBox is TextBox in frmMain
	with defaults
		label LABELS.labPOBox


	with rules
		HF_RegionalCountry.Value is 'FR' then
			max length 10
			this mandatory true

		HF_RegionalCountry.Value is 'GR' then
			max length 5
		
		GD_Adr_POBoxLoc.Value is not empty then
			set value '.' in GD_Adr_POBox

		GD_Adr_POBoxPostalCode.Value is not empty and GD_Adr_POBox.Value is empty then 
			set value '.' in GD_Adr_POBox

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
		this changes


; ----------------------------------------------------------------------------	


; TESTGEN : DEFAULTS=4, RULES=8, TRIGGERS=2
Entity GD_Adr_POBoxPostalCode is TextBox in frmMain
	with defaults
		enabled true
		visible true
		max length 10
		label LABELS.labBoxPostalCode

	with rules

		HF_VendorCountry.Value in {'FR','GF','GP','MC','MQ','NC','PF','PM','RE','WF','YT'} and GD_Adr_POBox is not empty and GD_Adr_POBox.Value is not '.' then
			GD_Adr_POBoxPostalCode mandatory true
			GD_Adr_POBoxLoc mandatory true
			GD_Adr_POBox mandatory true

		HF_VendorCountry.Value in {'FR','GF','GP','MC','MQ','NC','PF','PM','RE','WF','YT'} and GD_Adr_POBox is empty or GD_Adr_POBox.Value is '.' and GD_Adr_POBoxPostalCode is not empty then
			GD_Adr_POBoxLoc mandatory true

		HF_VendorCountry.Value in {'FR','GF','GP','MC','MQ','NC','PF','PM','RE','WF','YT'} and GD_Adr_POBox is empty or GD_Adr_POBox.Value is '.' and GD_Adr_POBoxLoc is not empty then
			GD_Adr_POBoxPostalCode mandatory true
			GD_Adr_POBoxLoc mandatory true

		HF_VendorCountry.Value in {'FR','GF','GP','MC','MQ','NC','PF','PM','RE','WF','YT'} and GD_Adr_POBox is empty or GD_Adr_POBox.Value is '.' then
			GD_Adr_POBoxPostalCode mandatory false
			GD_Adr_POBoxLoc mandatory false
			GD_Adr_POBox mandatory false

		HF_VendorCountry.Value is 'FR' then 
			max length 10

		HF_VendorCountry.Value is 'ES' then 
			max length 5

		HF_AccountGroup.Value is 'YVT7' then
			max length 5

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this changes
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=5, RULES=6, TRIGGERS=1
Entity GD_Adr_POBoxLoc is TextBox in frmMain
	with defaults
		enabled true
		visible true
		mandatory false
		label LABELS.labPoBoxLoc
		max length 100

	with rules
		HF_VendorCountry.Value in {'FR','GF','GP','MC','MQ','NC','PF','PM','RE','WF','YT'} and GD_Adr_POBox is not empty and GD_Adr_POBox.Value is not '.' then
			GD_Adr_POBoxPostalCode mandatory true
			GD_Adr_POBoxLoc mandatory true
			GD_Adr_POBox mandatory true

		HF_VendorCountry.Value in {'FR','GF','GP','MC','MQ','NC','PF','PM','RE','WF','YT'} and GD_Adr_POBox is empty or GD_Adr_POBox.Value is '.' and GD_Adr_POBoxPostalCode is not empty then
			GD_Adr_POBoxLoc mandatory true

		HF_VendorCountry.Value in {'FR','GF','GP','MC','MQ','NC','PF','PM','RE','WF','YT'} and GD_Adr_POBox is empty or GD_Adr_POBox.Value is '.' and GD_Adr_POBoxLoc is not empty then
			GD_Adr_POBoxPostalCode mandatory true
			GD_Adr_POBoxLoc mandatory true

		HF_VendorCountry.Value in {'FR','GF','GP','MC','MQ','NC','PF','PM','RE','WF','YT'} and GD_Adr_POBox is empty or GD_Adr_POBox.Value is '.' then
			GD_Adr_POBoxPostalCode mandatory false
			GD_Adr_POBoxLoc mandatory false
			GD_Adr_POBox mandatory false

		HF_RegionalCountry.Value is 'FR' then
			max length 40

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
		GD_Adr_POBox changes
		GD_Adr_POBoxPostalCode changes
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=8, RULES=5, ACTIONS=0, TRIGGERS=1
Entity GD_Com_LanguageCode is DropDownList in frmMain
	with defaults
		mandatory true
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_Languages	with arguments {FlagActive : true}	
		value EN		; default is English
		label LABELS.labLanguages

	with rules

		HF_VendorCountry.Value in {'FR','GF','GP','MC','MQ','NC','PF','PM','RE','WF','YT'} then
			set value 'FR' in GD_Com_LanguageCode

		HF_AccountGroup.Value is 'YVT1' and GD_Adr_Region is '01' then
			set value NL in GD_Com_LanguageCode
	
		HF_AccountGroup.Value is 'YVT1' and GD_Adr_Region in {'02', '03'} then
			set value 'FR' in GD_Com_LanguageCode

		; this should come from the MODEL (from the MDMV3_Countries table) where "country configuration" is set
		HF_Language.Value is not empty then
			set value HF_Language.Value in GD_Com_LanguageCode

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
		this changes
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=8, RULES=2, ACTIONS=0, TRIGGERS=1
Entity GD_Com_Telebox is DropDownList in frmMain
	with defaults
		label LABELS.labTelebox
		mandatory true
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_Telebox with arguments {FlagActive : true, AccountGroup : HF_AccountGroup.Value}
		value 'PRT'
	with rules
		HF_RequestType.Value is 'VC' then
			set value PRT in GD_Com_Telebox
			this enable false
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=1, ACTIONS=0, TRIGGERS=1
Entity GD_Com_URL is TextBox in frmMain
	with defaults
		max length 120
		label LABELS.labURL
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=1, ACTIONS=0, TRIGGERS=1
Entity GD_Com_DataLine is TextBox in frmMain
	with defaults
		max length 14
		label LABELS.labDataLine
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=7, RULES=0, ACTIONS=1, TRIGGERS=1
Entity GD_VT_Country is DropDownList in GD_VT_Grid
	with defaults
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_Countries
		value HF_VendorCountry.Value
		mandatory true
	with actions
		; select the specific country code and put it on the next field
		load data from DATASOURCE.MDMV3_CountryTelephonePrefixes with arguments {Code : GD_VT_Country.Value } in GD_VT_CountryCode
	with triggers
		this changes

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VT_CountryCode is TextBox in GD_VT_Grid
	with defaults
		enabled false
		label LABELS.labGD_VT_CountryCode
		mandatory true
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=6, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VT_Number is TextBox in GD_VT_Grid
	with defaults
		max length 30
		label LABELS.labGD_VT_Number
		validation ^[0-9\-\.()\+\s]+
		mandatory true
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VT_Extension is TextBox in GD_VT_Grid
	with defaults
		max length 10
		label LABELS.lablabGD_VT_Extension
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VT_Notes is TextBox in GD_VT_Grid
	with defaults
		max length 50
		label LABELS.labGD_VT_Notes
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VT_Default is CheckBox in GD_VT_Grid
	with defaults
		; by defaults appears checked and disabled
		value true
		label LABELS.labP_GD_VT_Default
		enabled false
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VT_ConsNumber is TextBox in GD_VT_Grid
	with defaults
		visible false
		label LABELS.labGD_VT_ConsNumber
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VT_btnInsert is Button in GD_VT_Grid
	with defaults
		label LABELS.labInsert

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=9, RULES=1, ACTIONS=0, TRIGGERS=3
Entity GD_VT_Grid is Grid in frmMain
	with defaults
		define column GRID_GD_VT_Country with arguments     { DataField : GD_VT_Country, ControlID : GD_VT_Country, Header : LABELS.labCountry, Visible : true}
		define column GRID_GD_VT_CountryCode with arguments { DataField : GD_VT_CountryCode, ControlID : GD_VT_CountryCode, Header : LABELS.labPrefix, Enabled : false, Visible : true}
		define column GRID_GD_VT_Number	 with arguments     { DataField : GD_VT_Number, ControlID : GD_VT_Number, Header : LABELS.labNumber,  Visible : true}
		define column GRID_GD_VT_Extension with arguments   { DataField : GD_VT_Extension, ControlID : GD_VT_Extension, Header : LABELS.labExtension,  Visible : true}
		define column GRID_GD_VT_Notes	with arguments      { DataField : GD_VT_Notes, ControlID : GD_VT_Notes, Header : LABELS.labNotes, Visible : true}
		define column GRID_GD_VT_Default with arguments     { DataField : GD_VT_Default, ControlID : GD_VT_Default, Header : LABELS.labDefault,  Visible : true}
		define column GRID_GD_VT_ConsNumber	with arguments  { DataField : GD_VT_ConsNumber, ControlID : GD_VT_ConsNumber, Visible : false}

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		on row inserted
		on row deleted
		on row updated
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=6, RULES=0, ACTIONS=1, TRIGGERS=1
Entity GD_VF_Country is DropDownList in GD_VF_Grid
	with defaults
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_Countries
		value HF_VendorCountry.Value
	with actions
		load data from DATASOURCE.MDMV3_CountryTelephonePrefixes with arguments {Code : GD_VF_Country.Value } in GD_VF_CountryCode
	with triggers
		this changes

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VF_CountryCode is TextBox in GD_VF_Grid
	with defaults
		enabled false
		mandatory true
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=5, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VF_Number is TextBox in GD_VF_Grid
	with defaults
		max length 30
		validation ^[0-9\-\.()\+\s]+
		label LABELS.labGD_VF_Number
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VF_Extension is TextBox in GD_VF_Grid
	with defaults
		max length 10
		label LABELS.labGD_VF_CountryCode
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VF_Notes is TextBox in GD_VF_Grid
	with defaults
		max length 50
		label LABELS.labGD_VF_Notes
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VF_ConsNumber is TextBox in GD_VF_Grid

	with defaults
		visible false
		label LABELS.labGD_VF_ConsNumber

; ----------------------------------------------------------------------------
; TESTGEN : DEFAULTS=4, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VF_Default is CheckBox in GD_VF_Grid
	with defaults
		value false
		label LABELS.labGD_VF_Default
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=0, ACTIONS=0, TRIGGERS=0
Entity GD_VF_btnInsert is Button in GD_VF_Grid
	with defaults
		label LABELS.labInsert
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=9, RULES=1, ACTIONS=0, TRIGGERS=3
Entity GD_VF_Grid is Grid in frmMain
	with defaults
		define column GRID_GD_VF_Country		with arguments {ControlID : GD_VF_Country,   DataField : GD_VF_Country, Header : LABELS.labCountry, Visible : true}
		define column GRID_GD_VF_CountryCode	with arguments {ControlID : GD_VF_CountryCode,	DataField : GD_VF_CountryCode, Header : LABELS.labPrefix, Enabled : false, Visible : true}
		define column GRID_GD_VF_Number		with arguments {	ControlID : GD_VF_Number,	DataField : GD_VF_Number, Header : LABELS.labNumber,  Visible : true}
		define column GRID_GD_VF_Extension	with arguments {	ControlID : GD_VF_Extension,	DataField : GD_VF_Extension, Header : LABELS.labExtension,  Visible : true}
		define column GRID_GD_VF_Notes		with arguments {	ControlID : GD_VF_Notes,	DataField : GD_VF_Notes, Header : LABELS.labNotes, Visible : true}
		define column GRID_GD_VF_Default		with arguments {ControlID : GD_VF_Default,	DataField : GD_VF_Default, Header : LABELS.labDefault,  Visible : true}
		define column GRID_GD_VF_ConsNumber	with arguments {	ControlID : GD_VF_ConsNumber,	DataField : GD_VF_ConsNumber, Visible : false}

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		; on row inserted
		; on row deleted
		; on row updated
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=6, RULES=1, ACTIONS=0, TRIGGERS=0
Entity GD_VE_SmtpAddr is TextBox in GD_VE_Grid
	with defaults
		tooltip MESSAGES.MSGEmailSupplier
		label LABELS.labGD_VE_SmtpAddr
		max length 241
		mandatory true
	
	with rules
		HF_RequestType.Value is 'VC' then 
			this mandatory true
		
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=1, ACTIONS=0, TRIGGERS=0
Entity GD_VE_Notes is TextBox in GD_VE_Grid
	with defaults
		max length 50
		label LABELS.labGD_VE_Notes
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=1, ACTIONS=0, TRIGGERS=0
Entity GD_VE_Default is CheckBox in GD_VE_Grid
	with defaults
		value false
		label LABELS.labGD_VE_Default
; ----------------------------------------------------------------------------	
; TESTGEN : DEFAULTS=3, RULES=1, ACTIONS=0, TRIGGERS=0
Entity GD_VE_ConsNumber is TextBox in GD_VE_Grid
 	with defaults
 		visible false
 		label LABELS.labGD_VE_ConsNumber
; ---------------------------------------------------------------------------- 
; TESTGEN : DEFAULTS=3, RULES=1, ACTIONS=0, TRIGGERS=0
Entity GD_VE_btnInsert is Button in GD_VE_Grid
	with defaults
		label LABELS.labInsert
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=6, RULES=1, ACTIONS=0, TRIGGERS=0
Entity GD_VE_Grid is Grid in frmMain
	with defaults
		define column GRID_GD_VE_SmtpAddr		with arguments {ControlID : GD_VE_SmtpAddr,		DataField : GD_VE_SmtpAddr, Header : LABELS.labNumber,  Visible : true}
		define column GRID_GD_VE_Notes		with arguments {	ControlID : GD_VE_Notes,	DataField : GD_VE_Notes, Header : LABELS.labNotes, Visible : true}
		define column GRID_GD_VE_Default		with arguments {ControlID : GD_VE_Default,		DataField : GD_VE_Default, Header : LABELS.labDefault,  Visible : true}
		define column GRID_GD_VE_ConsNumber	with arguments {	ControlID : GD_VE_ConsNumber ,	DataField : GD_VE_ConsNumber, Visible : false}

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		; on row inserted
		; on row deleted
		; on row updated
		this loads
; ----------------------------------------------------------------------------	

Entity GD_NatP_DateOfBirth is Calendar in frmMain
	with defaults
		label LABELS.calBirthDate
		visible false 

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
; ----------------------------------------------------------------------------	

; backed by test 034
Entity GD_NatP_PlaceOfBirth is TextBox in frmMain
	with defaults
		max length 25
		label LABELS.labPlaceOfBirth
		visible false 
		
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_CompanyCode.Value is '5240' and GD_Ctr_NIF.Value starts with {'1','2'} or GD_Ctr_TaxCode1.Value starts with {'1','2'} then 
			; IT's A bad idea to use the same field for two different things!!
			label LABELS.MSGNEmployess
			make mandatory
		
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : RULES=2, DEFAULTS=4, TRIGGERS=1, ACTIONS=0
Entity GD_NatP_Profession is TextBox in frmMain
	with defaults
		max length 30
		label LABELS.labProfession
		visible false 
	with rules

		HF_AccountGroup.Value in {'YVT6', 'YVT9'} then 
			this visible false
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : RULES=1, DEFAULTS=7, TRIGGERS=1, ACTIONS=0
Entity GD_NatP_Sex is DropDownList in frmMain
	with defaults
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_Sex
		value ''
		label LABELS.labSex
		visible false
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; PREPARE TEST FOR THIS
; THIS ENTITY HAS A LOT OF CODE AND NOTHING IN THE FIELD MAPPING
Entity GD_Ctr_CustomerNumber is TextBox in frmMain
	with defaults
		max length 18
		label LABELS.labCustomerNumber
		
	with rules

		
		HF_RequestState.Value is not 'Closed' and HF_RequestType.Value is 'VM' and PO_ReturnsVendor.Checked is true and GD_Ctr_CustomerNumber.OldDisplayValue is empty then
			mandatory true
			
		HF_RequestState.Value is not 'Closed' and HF_RequestType.Value is 'VM' and PO_ReturnsVendor.Checked is true and GD_Ctr_CustomerNumber.OldDisplayValue is not empty then
			this mandatory
			
		HF_RequestState.Value is not 'Closed' and HF_RequestType.Value is 'VM' and PO_ReturnsVendor.Checked is false then
			this not mandatory
			GD_Abc_DEMO mandatory
			
		HF_RequestState.Value is not 'Closed' and HF_RequestType.Value is not 'VM' then
			mandatory true	

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=8, RULES=4, TRIGGERS=1
Entity GD_Ctr_Industry is DropDownList in frmMain
	with defaults
		mandatory false
		visible true
		label LABELS.labIndustries
		; if there are no specific data for this specific country, data for EN should be loaded
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_Industries with arguments {FlagActive: true, Country : HF_VendorCountry.Value}
		value ''
	with rules
			
		HF_AccountGroup.Value in {'YCT6', 'YVT6'} then
			load data from DATASOURCE.MDMV3_Industries with arguments {FlagActive: true, Country : FR}
			; this equals to this line in original code
			; this.m_mdmSessionInfo.IndustryCountry = Business.Constants.Countries.France;

		HF_AccountGroup.Value in {'YCT6', 'YVT6'} and HF_CurrentRole.Value is 'MDMV3_CLERK' then
			this mandatory true

		HF_AccountGroup.Value in {'YCT9', 'YVT9'} then
			load data from DATASOURCE.MDMV3_Industries with arguments {FlagActive: true, Country : EN}
			; this.m_mdmSessionInfo.IndustryCountry = Business.Constants.Countries.France;
			this mandatory false

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false			

	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TODO: FINISH THIS PART

Entity GD_Ctr_GFORM is DropDownList in frmMain
	with defaults
		label LABELS.labLegalForm
		visible false
		; data source is same for vendors and customers
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_LegalForms with arguments {FlagActive : true, ClusterCountryCode : HF_RegionalCountry.Value }
		
	with rules

		HF_AccountGroup.Value in {'YCT6', 'YVT6'} then
			this visible true

		HF_AccountGroup.Value in {'YCT6', 'YVT6'} and HF_CurrentRole.Value is 'MDMV3_CLERK' then
			this mandatory true

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
; ----------------------------------------------------------------------------	


	; if vendor country France->maxlength 14, label = SIRET, visible true, only numbers

		if vendor country is not Spain->  vat registration number = tax code 2
;		if regional country is France and vendor country belongs to 'YVT6'->complete piva wiht 0 on left until 14,tax code 1=piva, tax code 2=firts 9 digits of piva , vatnumber=tax code 2
;		if regional country is Greece and vendor country is Greece-> vatregistrationnumber = tax code 2 , tax code 2 remove letters
;	5) If vendor country belongs to 'YVT6' and tax code1 is informed -> piva = tax code 1


; TESTGEN : DEFAULTS=3, ACTIONS=0
Entity GD_Ctr_PIVA is TextBox in frmMain
	with defaults
		visible false
		label LABELS.labPIVA
		
	with rules

		HF_RequestType.Value in {'VC','VC_CC'} then
			this enabled true
		else
			this enabled false

		HF_RegionalCountry.Value is 'IT' and HF_RequestType.Value is 'VC' then
			this mandatory true

		HF_RegionalCountry.Value in {'BE','LU'} and HF_RequestType.Value is 'VC' then
			this visible true

		; this means companycode country
		;	1) if regional country Greece and not vendor creation from scratch->NO mandatory else If vendor country doesn't belong to 'YVT6' or 'YVT9' -> mandatory
		HF_RegionalCountry.Value is 'GR' and HF_RequestType.Value is not 'VC' then
			this mandatory false
		HF_RegionalCountry.Value is 'GR' and HF_RequestType.Value is not 'VC' and HF_AccountGroup.Value not in {'YVT6', 'YVT9'} then
			this mandatory true

		; 'YVT1' is BELGIUM
		HF_AccountGroup.Value is 'YVT1' then
			this mandatory true
			validation ^[0-9]{1,10}$			; always 10 digits
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			set value GD_Ctr_PIVA.Value in GD_Ctr_VATRegistrationNumber
			set value 'BE' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_PIVA.Value in GD_Ctr_VATRegistrationNumber
			
		HF_AccountGroup.Value is 'YVT2' then
			validation ^[0-9]{1,8}$			; always 10 digits
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			GD_Ctr_TaxCode2 enabled false
			set value 'LU' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_PIVA.Value in GD_Ctr_VATRegistrationNumber

		HF_AccountGroup.Value is 'YVT3' then
			validation ^[A-Za-z0-9]{1,16}$
			set value 'ES' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_PIVA.Value in GD_Ctr_VATRegistrationNumber
		
		HF_AccountGroup.Value is 'YVT3' and GD_Ctr_TaxCode1.Text starts with {'P','Q','S'} then
			set value 'G' in GD_Ctr_VendorClassification
	
		HF_AccountGroup.Value is 'YVT3' and GD_Ctr_TaxCode1.Text starts with 'X' then
			set value 'NG' in GD_Ctr_VendorClassification
		
		HF_AccountGroup.Value is 'YVT6' then
			visible true
			label LABEL.labSIRET
			max length 14
			validation regex ^[0-9]{1,14}$
			GD_Ctr_TaxCode2 enabled false
			; do padding via sql server ugh
			load data from DATASOURCE.MDMV3_StringPadLeft with arguments {String : GD_Ctr_PIVA.Value, Length : 14, Char : 0} in GD_Ctr_PIVA
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			set value 'BE' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_PIVA.Value in GD_Ctr_VATRegistrationNumber
			set value SUBSTRING(GD_Ctr_PIVA.Value,9) in GD_Ctr_TaxCode2
			set value GD_Ctr_TaxCode2.Value in GD_Ctr_IFANumber

		HF_VendorCountry.Value is 'FR' and HF_AccountGroup.Value is 'YVT6' then
			; pad left 0,14
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			set value SUBSTRING(GD_Ctr_PIVA.Value,9) in GD_Ctr_TaxCode2
			set value GD_Ctr_TaxCode2.Value in GD_Ctr_IFANumber

		; ny EU country ; finish the list....
		HF_AccountGroup.Value is not 'YVT6' and HF_VendorCountry.Value in {'ES', 'IT', 'PT', 'GR' } then
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1

		HF_VendorCountry.Value is not 'ES' then
			set value GD_Ctr_TaxCode2.Value in GD_Ctr_IFANumber

		HF_VendorCountry.Value is 'GR' and HF_RegionalCountry.Value is 'GR' then
			set value GD_Ctr_TaxCode2.Value in GD_Ctr_IFANumber
			remove letters GD_Ctr_TaxCode2.Value
		
		HF_AccountGroup.Value is 'YVT4' then
			max length 10
			validation regex ^[0-9]{9}$			; always 9 digits
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			set value 'PT' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_PIVA.Value in GD_Ctr_VATRegistrationNumber

		HF_AccountGroup.Value is 'YVT4' and  GD_Ctr_PIVA.Value starts with {'1','2','3'} then
			set value true in GD_Ctr_IsNaturalPerson
			GD_Ctr_TaxCode2 mandatory true
			GD_Ctr_TaxCode2 enabled true

		HF_AccountGroup.Value is 'YVT5' then
			max length 16
			validation regex ^[A-Za-z0-9]{16}$
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode2
			set value 'IT' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_PIVA.Value in GD_Ctr_VATRegistrationNumber
			this visible true
			this mandatory true

		HF_AccountGroup.Value is 'YVT5' and GD_Ctr_IsNaturalPerson.Value is false then
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			set value '' in GD_Ctr_CF

		HF_AccountGroup.Value is 'YVT6' and HF_CurrentRole.Value is 'MDMV3_CLERK' then
			this mandatory false 

		HF_AccountGroup.Value is 'YVT6' and GD_Ctr_IsNaturalPerson.Value is false and HF_CurrentRole.Value is not 'MDMV3_CLERK' then
			this mandatory true

		HF_RequestType.Value in {'VC','VC_CC'} and HF_RegionalCountry.Value in {'BE','LU'} and HF_CurrentRole.Value is not 'MDMV3_CLERK' then
			this mandatory true
		
		HF_AccountGroup.Value is 'YVT5' and GD_Ctr_PIVA.Value is '00000000000' then
			set value '' in GD_Ctr_VATRegistrationNumber
			
		HF_AccountGroup.Value is 'YVT7' then
			max length 9
			validation regex ^[0-9]{9}$			; always 9 digits
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode2
			set value 'GR' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_PIVA.Value in GD_Ctr_VATRegistrationNumber

		HF_RegionalCountry.Value is 'ES' then
			this visible false

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=6, TRIGGERS=2
Entity GD_Ctr_NIF is TextBox in frmMain
	with defaults
		label LABELS.labNIF
		max length 9
		visible false

	with rules
		HF_RegionalCountry.Value is 'PT' and GD_Ctr_NIF.Value starts with {'1','2'} then
			set value true in GD_Ctr_IsNaturalPerson
			GD_NatP_DateOfBirth visible true
			GD_NatP_PlaceOfBirth visible true
			GD_NatP_Profession visible true
			GD_NatP_Sex visible true
			GD_NatP_Exemption visible true
			GD_NatP_Exemption mandatory true

		HF_RegionalCountry.Value is 'PT' and GD_Ctr_NIF.Value not starts with {'1','2'} then
			set value false in GD_Ctr_IsNaturalPerson
			GD_NatP_DateOfBirth visible false
			GD_NatP_PlaceOfBirth visible false
			GD_NatP_Profession visible false
			GD_NatP_Sex visible false
			GD_NatP_Exemption visible false
			GD_NatP_Exemption mandatory false

		HF_RegionalCountry.Value is 'PT' and HF_RequestType.Value is 'VC' then
			this mandatory true
			this visible true

		HF_RegionalCountry.Value is 'PT' then
			set value 'PT' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_NIF.Value in GD_Ctr_VATRegistrationNumber

		HF_RegionalCountry.Value is 'PT' and HF_RequestType.Value is not 'VC' then
			this mandatory false
			this visible false

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
		this changes
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=3, TRIGGERS=2, ACTIONS=0
Entity GD_Ctr_CF is TextBox in frmMain
	with defaults
		label LABELS.labCF
		visible false
		max length 16

	with rules
		HF_RegionalCountry.Value is 'IT' and HF_RequestType.Value is 'VC' then
			visible true
			enabled false

		HF_RegionalCountry.Value is 'IT' and HF_RequestType.Value is 'VC' and GD_Ctr_IsNaturalPerson.Value is true then
			enabled true
			set value GD_Ctr_CF.Value in GD_Ctr_TaxCode1

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
		this changes
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=2
Entity GD_Ctr_TaxCode1 is TextBox in frmMain
	with defaults
		label LABELS.labTaxCode2
		max length 9

	with rules
		
		HF_RegionalCountry.Value in {'BE','LU'} then
			max length 10
			this mandatory true
		
		HF_RegionalCountry.Value is {'PT','IT'} then
			this enabled false
			this mandatory false

		
		HF_RegionalCountry.Value in {'BE','LU'} and HF_CurrentRole.Value is not 'MDMV3_CLERK' then
			this mandatory true

		HF_RegionalCountry.Value is 'GR' then
			this mandatory false
			this visible false

		HF_VendorCountry.Value is 'ES' and GD_Ctr_TaxCode1.Text starts with {'1','2','3','4','5','6','7','8','9','X'} then
			set value true in GD_Ctr_IsNaturalPerson			
			set value 'ES' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_TaxCode1.Value in GD_Ctr_VATRegistrationNumber
			set value 'NG' in GD_Ctr_VendorClassification

		HF_AccountGroup.Value is 'YVT1' then
			validation regex ^[0-9]{10}$			; always 10 digits
			set value 'BE' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_PIVA.Value in GD_Ctr_VATRegistrationNumber
			mandatory true
			max length 10

		HF_AccountGroup.Value is 'YVT2' then
			set value GD_Ctr_PIVA.Value in GD_Ctr_TaxCode1
			set value 'LU' in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_PIVA.Value in GD_Ctr_VATRegistrationNumber
			max length 10

		HF_AccountGroup.Value is 'YVT7' then
			mandatory false
			visible false

		HF_AccountGroup.Value is 'YVT5' then
			max length 16

		HF_AccountGroup.Value is 'YVT6' then
			max length 14
			validation ^[0-9]+$

		HF_AccountGroup.Value is 'YVT6' and GD_Ctr_TaxCode1 is not empty then
			padleft

		HF_AccountGroup.Value is 'YVT9' then
			max length 14
			validation ^[0-9]+$

		HF_AccountGroup.Value is 'YVT9' and HF_RequestType.Value is 'VC' then
			this enabled true
			this mandatory false

		HF_AccountGroup.Value is 'YVT6' and HF_RequestType.Value is 'VC' and GD_Ctr_IsNaturalPerson.Value is false then
			this mandatory true
		
		HF_AccountGroup.Value in {'YVT6', 'YCT6', 'YVT9', 'YCT9'} and HF_RequestType.Value is 'VC' and REQUEST.TaxCode1_IsMandatory then
			this mandatory true

		HF_RegionalCountry.Value in {'ES','FR','IT','PT'} and HF_RequestType.Value is not 'VC' then
			this mandatory false
			this enabled false

		HF_RegionalCountry.Value is 'LU' and HF_RequestType.Value in {'VC_CC',VC_PO} then
			this mandatory false
			this enabled true

		HF_RegionalCountry.Value in {'BE','LU'} and HF_CurrentRole.Value is 'MDMV3_CLERK' and HF_RequestType.Value is not 'VM_BLK' then
			this mandatory false
			this enable true

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
; ----------------------------------------------------------------------------	

Entity GD_Ctr_TaxCode2 is TextBox in frmMain
	with defaults
		label LABELS.labTaxCode2

	with rules
		HF_RegionalCountry.Value is 'ES' then
			max length 14

		HF_AccountGroup.Value is 'YVT7' then
			max length 9
			set value EL in GD_Ctr_VATRegistrationNumber
			add value GD_Ctr_TaxCode2.Value in GD_Ctr_VATRegistrationNumber

		HF_AccountGroup.Value is 'YVT5' then
			max length 11
		HF_RegionalCountry.Value in {'BE','LU'} then
			enabled false

		HF_AccountGroup.Value in {'YVT6', 'YCT6', 'YVT9', 'YCT9'} and HF_RequestType.Value is 'VC' and REQUEST.TaxCode2_IsMandatory then
			this mandatory true

		HF_RegionalCountry.Value in {'ES','FR','IT','BE','GR','LU'} and HF_RequestType.Value in {'VC_CC','VC_PO'} then
			this mandatory false
			this enabled false

		HF_RegionalCountry.Value in {'BE','LU'} and HF_CurrentRole.Value is 'MDMV3_CLERK' and HF_RequestType.Value is not 'VM_BLK' then
			this mandatory false
			this enable true

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
		this changes
; ----------------------------------------------------------------------------	


; TODO: PENDING ANALYZE WHAT THE METHOD CalculateVATNumber DOES
; 1) if vendor country france -> enabled
; 2)if vendor country NOT belongs to 'YVT6'/'YVT9'-> vatregnumber mandatory if vendor country has mandatory vatregnumber in table countries
; 3)if vendor country NOT belongs to 'YVT6'/'YVT9'-> enabled if mandatory and vendor creation from scratch
; 4)if vendor country belgiun/luxemburg and role is 'MDMV3_CLERK' ->nor mandatory
; 5)if regional country Greece->not mandatory and not enabled
; 6)if regional country France->enabled
; 7)enabled for creations from scratch
; 8)if vendor country Portugal ->enable false, not mandatory
; 9)if vendor country Italy ->enable false, not mandatory 
; 10)if regional country Belgium/Luxemburg->if 'MDMV3_CLERK' and not request block/unblock-> enabled
; 11)if vendor country Portugal-> enabled false, mandatory false
; 12)if vendor country Italy-> enabled false, mandatory false
; 13)if vendor country Portugal-> Vat registration number = PT+NIF
; 14)if vendor country belongs to 'YVT6'->maxlength 14,enabled, if not natural person and vendor creation from scratch->mandatory
; 15)if vendor country belongs to 'YVT9'->not mandatory,enabled

Entity GD_Ctr_VATRegistrationNumber is TextBox in frmMain
	with defaults
		label LABELS.labVATRegistrationNumber

	with rules

		HF_RequestType.Value is 'VC' and REQUEST.VAT_IS_MANDATORY_FOR_COUNTRY is true then
			GD_Ctr_VATRegistrationNumber mandatory
			GD_Ctr_VATRegistrationNumber enabled

		HF_RegionalCountry.Value in {'BE', 'LU'} and HF_CurrentRole.Value is 'MDMV3_CLERK' then
			GD_Ctr_VATRegistrationNumber mandatory true
			GD_Ctr_VATRegistrationNumber enabled true

		HF_RegionalCountry.Value in {'BE', 'LU'} and HF_RequestType.Value is 'VM' then
			enabled false

		HF_RegionalCountry.Value in {'GR','ES'} then
			GD_Ctr_VATRegistrationNumber mandatory false
			GD_Ctr_VATRegistrationNumber enabled false

		HF_RegionalCountry.Value is 'FR' then
			GD_Ctr_VATRegistrationNumber mandatory true
			GD_Ctr_VATRegistrationNumber enabled true

		HF_AccountGroup.Value is 'YVT7' then
			this enable false
			this mandatory false

		HF_AccountGroup.Value in {'YVT6', 'YCT6', 'YVT9', 'YCT9'} and HF_RequestType.Value is 'VC' and REQUEST.VAT_IsMandatory then
			this mandatory true
			this enable true

		REQUEST.VAT_IsMandatory and HF_RequestType.Value is 'VC' then
			this enable true
			this mandatory true

		HF_RegionalCountry.Value is {'ES','IT','BE','GR','LU'} and HF_RequestType.Value in {'VC_CC','VC_PO'} then
			this mandatory false
			this enabled false
		
		HF_RegionalCountry.Value in {'BE','LU'} and HF_CurrentRole.Value is 'MDMV3_CLERK' and HF_RequestType.Value is not 'VM_BLK' then
			this mandatory false
			this enable true

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=5, TRIGGERS=1
Entity GD_Ctr_SalesPurTax is CheckBox in frmMain
	with defaults
		label LABELS.chkSales
		visible false
		value REQUEST.GD_Ctr_SalesPurTax_SAP
	
	with rules

		HF_AccountGroup.Value in {'YVT1', 'YVT2'} then
			GD_Ctr_SalesPurTax visible true

		HF_AccountGroup.Value in {'YVT1', 'YVT2'} and HF_RequestType.Value is 'VC' then
			set value true in GD_Ctr_SalesPurTax

		HF_AccountGroup.Value in {'YVT1', 'YVT2'} and REQUEST.GD_Ctr_SalesPurTax is empty then
			set value true in GD_Ctr_SalesPurTax

		HF_CompanyCode.Value in {'5101','563M','5109'} and HF_AccountGroup.Value is 'YVT1' and HF_RequestType.Value is 'VC' then
			set value true ; check the checkbox

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=3, TRIGGERS=1
Entity GD_Ctr_IFANumber is TextBox in frmMain
	with defaults
		max length 20
		label LABELS.labIFANumber
		visible false
		enabled false
	
	with rules

		HF_RequestType.Value is not 'VC' then
			this visible true
			this enable true

		HF_RequestType.Value is 'VC' and HF_RegionalCountry.Value in {'BE','LU'} then
			this visible true
			this enable true
	
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_Ctr_RepresentiveName is TextBox in frmMain
	with defaults
		max length 10
		label LABELS.labRepresenNumber
		visible false
	
	with rules
		HF_RequestType.Value is 'VM' then
			this visible true
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
					
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=2, TRIGGERS=1
Entity GD_Ctr_TaxNumber	is TextBox in frmMain
	with defaults
		visible false
		label LABELS.labTaxNumber

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value is 'VM' then
			this visible true
	with triggers
		this loads		
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity GD_Ctr_CreditInfoNo is TextBox in frmMain
	with defaults
		max length 11
		visible false
		label LABELS.labCreditInfo

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RequestType.Value is 'VM' then
			this visible true
	with triggers
		this loads	
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=7, RULES=2, ACTIONS=1, TRIGGERS=2
Entity GD_Ctr_UnsubscribeCMD is DropDownList in frmMain
	with defaults
		label LABELS.labUnsubscribeCMD
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_UnsubscribeOptions
		value ''
	with actions
		set value GD_Ctr_UnsubscribeCMD.Value in BLK_GD_Ctr_UnsubscribeCMD
	with rules
		HF_RequestType.Value is 'VC' then
			this enable false
			this visile false
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		; when this controls change, change the value of BLK_GD_Ctr_UnsubscribeCMD
		this changes
		this loads

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=6, ACTIONS=1, TRIGGERS=1
Entity V_Country is DropDownList in V_Grid
	with defaults
		data field DisplayName
		value field Code
		label LABELS.labCountry
		load data from DATASOURCE.MDMV3_Countries
		
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		this changes
; ---------------------------------------------------------------------------- 

; TESTGEN : DEFAULTS=3, ACTIONS=1, TRIGGERS=1
Entity V_VATNumber is TextBox in V_Grid
	with defaults
		label LABELS.labNumber
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		this changes
; ---------------------------------------------------------------------------- 

; TESTGEN : DEFAULTS=3,  ACTIONS=0, TRIGGERS=0
Entity V_btnInsert is Button in V_Grid
	with defaults
		label LABELS.labInsert
; ---------------------------------------------------------------------------- 

; TESTGEN : DEFAULTS=4, RULES=1, ACTIONS=0, TRIGGERS=1
Entity V_Grid is Grid in frmMain
	with defaults
		define column GRID_V_Country		with arguments { ControlID : V_Country, DataField : V_Country, Header : LABELS.labCountry, Visible : true}
		define column GRID_V_VATNumber		with arguments { ControlID : V_VATNumber, DataField : V_VATNumber, Header : LABELS.labVATNumber, Visible : true}
		
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		; on row inserted
		; on row deleted
		; on row updated
		this loads
; ----------------------------------------------------------------------------	

; THIS IS THE BANK DETAILS

; TESTGEN : DEFAULTS=7, RULES=1, ACTIONS=1, TRIGGERS=1
Entity GD_VB_Country is DropDownList in GD_VB_Grid

	with defaults
		label LABELS.labCountry
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_Countries
		mandatory true
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with rules
		; call SP to find out if selected value is Tax Haven
		DATASOURCE.MDMV3_IsCountryATaxHaven with arguments {CountryCode: B_GD_VB_Country.Value} is true then
			set value '09' in GD_Ctr_RiskClassification
	with triggers 
		this changes

; ---------------------------------------------------------------------------- 

; TESTGEN : DEFAULTS=4, RULES=1, ACTIONS=1, TRIGGERS=3
Entity GD_VB_BankKey is TextBox in GD_VB_Grid
	with defaults
		label LABELS.labGD_VD_BankKey
		max length 10
	with rules
		HF_AccountGroup.Value in {'YCT6','YCT9','YVT6','YVT9'} then
			max length 10
		else
			max length 15
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		this changes
		GD_VB_Country changes
		this loads
; ---------------------------------------------------------------------------- 

; TESTGEN : DEFAULTS=4, RULES=2, ACTIONS=1, TRIGGERS=3
Entity GD_VB_BankAccount is TextBox in GD_VB_Grid

	with defaults
		label LABELS.labGD_VD_BankAccount
		max length 11
	with rules
		HF_AccountGroup.Value in {'YCT6','YCT9','YVT6','YVT9'} then
			max length 11
		else
			max length 18
		B_GD_VB_Country.Value is 'BE' and GD_VB_BankAccount.Value.Length >= 3 then
			set value SUBSTRING(GD_VB_BankKey,0,3) in GD_VB_BankKey
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		this changes
		this loads
		B_GD_VB_Country changes
; ---------------------------------------------------------------------------- 

; TESTGEN : DEFAULTS=4, RULES=0, ACTIONS=1, TRIGGERS=1
Entity GD_VB_BankControlKey is TextBox in GD_VB_Grid

	with defaults
		label LABELS.labGD_VD_BankControlKey
		max length 2
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		this changes
; ---------------------------------------------------------------------------- 

; TODO: CHECK VENDOR SPECIFIC BANK RULES IN VENDOR FIELDMAPPING FILE

; TESTGEN : DEFAULTS=3, RULES=1, ACTIONS=1, TRIGGERS=3
Entity GD_VB_IBAN is TextBox in GD_VB_Grid

	with defaults
		label LABELS.labGD_VD_IBAN
	with actions
		; TODO: POPULATION FOR THE UNDERLYING TABLE HAS TO BE FINISHED
		load data from DATASOURCE.MDMC_GetIBANConfigurationForCountry with arguments {CountryCode:B_GD_VB_Country.Value, IBAN:B_GD_VB_IBAN.Value} with output {B_GD_VB_BankKey:BankKey,B_GD_VB_BankAccount:BankAccount,B_GD_VB_BankControlKey:BankControlKey}

	with rules
		HF_AccountGroup.Value in {'YCT6','YCT9','YVT6','YVT9'} then
			max length 27
		else
			max length 35
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		this changes
		GD_VB_Country changes
		this loads
; ---------------------------------------------------------------------------- 

; TODO: TO 'BE' CONNECTED IN THE WEB SERVICES TO AND FROM SAP
; TESTGEN : DEFAULTS=3, RULES=1, Triggers=1
Entity GD_VB_SWIFT is TextBox in GD_VB_Grid
	with defaults
		label LABELS.labGD_VD_SWIFT
		visible false
	with rules
		HF_RequestType.Value is 'VC' then
			this visible true
	with triggers 
		this loads
			
; ---------------------------------------------------------------------------- 

; TESTGEN : DEFAULTS=4, RULES=0, ACTIONS=1, TRIGGERS=1
Entity GD_VB_AccountHolder is TextBox in GD_VB_Grid

	with defaults
		label LABELS.labGD_VD_AccountHolder
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		this changes

; ---------------------------------------------------------------------------- 

; TESTGEN : DEFAULTS=4
Entity GD_VB_BankCity is TextBox in GD_VB_Grid

	with defaults
		label LABELS.labGD_VD_BankCity
		max length 20
; ---------------------------------------------------------------------------- 

; TESTGEN : DEFAULTS=3, RULES=1, TRIGGERS=1
Entity GD_VB_PartBankType is TextBox in GD_VB_Grid

	with defaults
		label LABELS.labGD_VB_PartBankType
	with rules
		HF_AccountGroup.Value not in {'YCT6','YCT9','YVT6','YVT9'} then
			max length 4
	with triggers
		this loads
		
; ---------------------------------------------------------------------------- 

; TESTGEN : DEFAULTS=3, RULES=1, TRIGGERS=1
Entity GD_VB_BankReferDetails is TextBox in GD_VB_Grid

	with defaults
		label LABELS.labGD_VB_BankReferDetails
	with rules
		HF_AccountGroup.Value not in {'YCT6','YCT9','YVT6','YVT9'} then
			max length 20
	with triggers
		this loads
		
; ---------------------------------------------------------------------------- 

; TODO: FINISH ALL RULES
; TESTGEN : DEFAULTS=3, TRIGGERS=1
Entity GD_VB_btnInsert is Button in GD_VB_Grid

	with defaults
		label LABELS.btnInsert
	with rules

		HF_RegionalCountry.Value is 'IT' and B_GD_VB_Country.Value is 'IT' and B_GD_VB_SWIFT.Value.Length is not 11 then
			set value MESSAGES.ERRfieldSWIFT in MESSAGE_POPUP
		B_GD_VB_IBAN is empty and B_GD_VB_BankAccount is empty then
			set value MESSAGES.ERRfieldIban in MESSAGE_POPUP

		; --- validations on bank insert

		HF_RegionalCountry.Value is 'ES' and GD_Ctr_VendorClassification.Value is not 'G' and GD_Ctr_TaxCode1.Value starts with {'P','Q','S'} then
			set value 'G' in GD_Ctr_VendorClassification

		HF_RegionalCountry.Value is 'ES' and GD_Ctr_VendorClassification.Value is not 'NG' and GD_Ctr_TaxCode1 is empty then
			set value 'NG' in GD_Ctr_VendorClassification

		; as fallback
		HF_RegionalCountry.Value is 'ES' and GD_Ctr_TaxCode1.Value starts with {'P','Q','S'} then
			set value 'G' in GD_Ctr_VendorClassification

		HF_RegionalCountry.Value is 'ES' and GD_Ctr_TaxCode1.Value starts with {'X','1','2','3','4','5','6','7','8','9','0'} then
			set value true in GD_Ctr_IsNaturalPerson

		HF_RegionalCountry.Value is 'ES' and GD_Ctr_TaxCode1.Value not starts with {'X','1','2','3','4','5','6','7','8','9','0'} then
			set value false in GD_Ctr_IsNaturalPerson
		
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false


	with triggers
		this loads
		this changes

; ---------------------------------------------------------------------------- 

; TESTGEN : DEFAULTS=14, RULES=1, TRIGGERS=4, ACTIONS=0
Entity GD_VB_Grid is Grid in frmMain
	with defaults
		define column GRID_GD_VB_Country		with arguments { ControlID :GD_VB_Country ,  DataField : GD_VB_Country, Header : LABELS.labCountry, Visible : true}
		define column GRID_GD_VB_BankKey		with arguments { ControlID : GD_VB_BankKey,	DataField : GD_VB_BankKey, Header : LABELS.labBankKey, Visible : true}
		define column GRID_GD_VB_BankAccount	with arguments { ControlID : GD_VB_BankAccount,DataField : GD_VB_BankAccount, Header : LABELS.labBankAccount, Visible : true}
		define column GRID_GD_VB_BankControlKey	with arguments { ControlID : GD_VB_BankControlKey,DataField : GD_VB_BankControlKey, Header : LABELS.labBankControlKey, Visible : true}
		define column GRID_GD_VB_IBAN			with arguments { ControlID : GD_VB_IBAN,DataField : GD_VB_IBAN, Header : LABELS.labIBAN, Visible : true}
		define column GRID_GD_VB_SWIFT		with arguments {	 ControlID : GD_VB_SWIFT,  DataField : GD_VB_SWIFT, Header : LABELS.labSWIFT, Visible : true}
		define column GRID_GD_VB_NameOfBank	with arguments {	 ControlID : GD_VB_NameOfBank,  DataField : GD_VB_NameOfBank, Header : LABELS.labNameOfBank, Visible: false}
		define column GRID_GD_VB_AccountHolder	with arguments { ControlID : GD_VB_AccountHolder,DataField : GD_VB_AccountHolder, Header : LABELS.labAccountHolder, Visible : true}
		define column GRID_GD_VB_BankCity	with arguments {	 ControlID : GD_VB_BankCity,  DataField : GD_VB_BankCity, Header : LABELS.labBankCity, Visible : false}
		define column GRID_GD_VB_PartBankType	with arguments { ControlID : GD_VB_PartBankType,   DataField : GD_VB_PartBankType, Header : LABELS.labPartBankType, Visible : false}
		define column GRID_GD_VB_BankReferDetails	with arguments { ControlID : GD_VB_BankReferDetails,	DataField : GD_VB_BankReferDetails, Header : LABELS.labBankReferDetails, Visible: false}
		define column GRID_RelevantFlag	with arguments { DataField : RelevantFlag, Visible : false}

		
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		on row inserted
		on row deleted
		on row updated
		this loads

; ----------------------------------------------------------------------------	

; TESTGEN : RULES=6, DEFAULTS=2, TRIGGERS=1
Entity CC_CO_ReconAccount is TextBox in frmMain
	with defaults
		visible false
	with rules
		HF_RequestType.Value in {'VC', 'VC_CC'} then
			set value 0044110000 in CC_CO_ReconAccount
		
		; if model data is empty
		HF_RequestType.Value in {'VC_PO','VM'} and REQUEST.CC_CO_ReconAccount then
			set value '0044110000' in CC_CO_ReconAccount

		HF_RequestType.Value in {'VC', 'VC_CC'} and HF_RegionalCountry.Value is 'GR' and HF_VendorCountry.Value is 'GR' and GD_Ctr_VendorClassification.Value is 'NG' then
			set value '0044110000' in CC_CO_ReconAccount

		HF_RequestType.Value in {'VC', 'VC_CC'} and HF_RegionalCountry.Value is 'GR' and HF_VendorCountry.Value is 'GR' and GD_Ctr_VendorClassification.Value is 'G' then
			set value '0044110090' in CC_CO_ReconAccount

		HF_RequestType.Value in {'VC', 'VC_CC'} and HF_RegionalCountry.Value is 'GR' and HF_VendorCountry.Value is 'GR' then
			set value '0044110050' in CC_CO_ReconAccount

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=2, RULES=0, TRIGGERS=1
Entity LFB1_LNRZE is TextBox in frmMain
	with defaults
		visible false
		enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=2, RULES=3, TRIGGERS=1
Entity LFB1_REPRF is TextBox in frmMain
	with defaults
		visible false

	with rules

		HF_RequestType.Value in {'VC', 'VC_CC'} then
			set value 'X' in LFB1_REPRF

		; TODO: SEB Clarify model access
		HF_RequestType.Value not in {'VC', 'VC_CC'} then
			; in this case send the old value from SAP
			set value REQUEST.LFB1_REPRF_SAP in LFB1_REPRF

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=7, RULES=9
Entity CC_AM_SortKey is DropDownList in frmMain
	with defaults
		label LABELS.labAMSortKeys
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_SortKeys with arguments {FlagActive : true, ClusterCountryCode : HF_RegionalCountry.Value}
		mandatory
		visible false

	with rules

		; TODO: ACCESS TO MODEL EXPOSING OBTAINED SAP DATA
		REQUEST.CC_AM_SortKey is not empty then
			set value REQUEST.CC_AM_SortKey in CC_AM_SortKey
		
		REQUEST.CC_AM_SortKey is empty and HF_RegionalCountry.Value is 'ES' then
			set value '000' in CC_AM_SortKey

		REQUEST.CC_AM_SortKey is empty and HF_RegionalCountry.Value is 'IT' then
			set value '002' in CC_AM_SortKey

		REQUEST.CC_AM_SortKey is empty and HF_RegionalCountry.Value is 'PT' then
			set value '003' in CC_AM_SortKey

		REQUEST.CC_AM_SortKey is empty and HF_RegionalCountry.Value in {'BE','LU'} then
			set value '009' in CC_AM_SortKey

		REQUEST.CC_AM_SortKey is empty and HF_RegionalCountry.Value is 'FR' then
			set value '007' in CC_AM_SortKey

		REQUEST.CC_AM_SortKey is empty and HF_RegionalCountry.Value is 'GR' then
			set value '001' in CC_AM_SortKey

		HF_RequestType.Value in {'VC', 'VC_CC', 'VC_PO'} then
			this visible false
		else
			this visible true
			
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
		this changes
; ----------------------------------------------------------------------------	

; TODO: MOVE THIS TO WEB SERVICES FOR SAP
; TESTGEN : DEFAULTS=3, RULES=7, TRIGGERS=2
Entity CC_AM_SubjectedToWHTax is CheckBox in frmMain
	with defaults
		label LABELS.labAMSubjectedWithholdingTax

	with rules
	
		HF_RegionalCountry.Value is not 'GR' and CC_AM_SubjectedToWHTax.Value is true then
			CC_AM_WithholdingTaxCode mandatory true

		HF_RegionalCountry.Value in {'ES', 'IT'} and CC_AM_SubjectedToWHTax.Value is true then
			CC_AM_WithholdingTaxCode mandatory true
			
		HF_RegionalCountry.Value is not 'GR' and CC_AM_SubjectedToWHTax.Value is false then
			CC_AM_WithholdingTaxCode mandatory false

		HF_RegionalCountry.Value is 'ES' and GD_Ctr_IsNaturalPerson.Checked is true and HF_RequestType.Value is 'VM' then
			CC_AM_WithholdingTaxCode mandatory false

		HF_RegionalCountry.Value is 'ES' and GD_Ctr_IsNaturalPerson.Checked is true then
			set value true in CC_AM_SubjectedToWHTax

		HF_RegionalCountry.Value is 'ES' and HF_RequestType.Value is 'VM' then
			CC_AM_WithholdingTaxCode mandatory false
			
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
		this changes
; ----------------------------------------------------------------------------	

; TODO: CHECK WITH PREVIOUS ELEMENT - I THINK RULES ARE MIXED
Entity CC_AM_WithholdingTaxCode	is DropDownList in frmMain
	with defaults
		label LABELS.labAMWithholdingTaxCode
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_WithholdingTaxCodes with arguments {FlagActive : true, ClusterCountryCode : HF_RegionalCountry.Value}

	with rules

		HF_RegionalCountry.Value is 'ES' then
			set value E0 in CC_AM_SubjectedToWHTax 

		HF_CurrentRole.Value is 'MDMV3_ENQ' and HF_RegionalCountry.Value in {'ES', 'IT'} then
			CC_AM_WithholdingTaxCode mandatory CC_AM_SubjectedToWHTax.Checked

		HF_RegionalCountry.Value is 'ES' and GD_Ctr_IsNaturalPerson.Checked is true and HF_RequestType.Value is 'VM' then
			CC_AM_WithholdingTaxCode mandatory false

		HF_RequestType.Value in {'VC','VC_CC'} and HF_RegionalCountry.Value is 'ES' and CC_AM_WithholdingTaxCode.Value is empty then
			set value 'EO' in CC_AM_WithholdingTaxCode
			
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
		this changes
; ----------------------------------------------------------------------------	

; TODO: CHECK RULES
; TESTGEN : DEFAULTS=4, RULES=1, TRIGGERS=1
Entity CC_AM_ExemptionNumber is TextBox in frmMain
	with defaults
		label LABELS.labAMExemptionNumber
		max length 20
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; Field is only needed when field NIF/ P.IVA/ Local tax code starts by ""1"" and ""2"", 
; country from 'PT' and Company code 5240. If so field becomes mandatory, label should be ""Social Security Situation"", 
; field must appear in menu ""info add. For natural person"" in general data: 
; and then a dropdownlist with the folloing values must be available: ""0_No exemption"" and 2_Exemption
; 14-07-2014 (MC) the correct technical name is LFB1-QSBGR with DDL (2 options - 0 and 2) and only for company code PT"


; TODO: CLARIFY THIS WITH STAKEHOLDERS_: 
; 2) In case Greece company code, if this field is flagged, the field LFB1-QSSKZ is mandatory  but the DDL must have just the value D1- Dummy. 
; This value D1 will be saved in SAP in the  fields LFBW-WITHT and LFBW-WT_WITHCD = D1 and LFBW-WT_SUBJCT flagged. 

; TODO: TEST

; --- backed by test 036
; TESTGEN : DEFAULTS=7, RULES=2, TRIGGERS=1
Entity GD_NatP_Exemption is DropDownList in frmMain
	with defaults
		label LABELS.labExemption
		visible false
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_NaturalPersonExemption
		value ''

	with rules

		HF_VendorCountry.Value is 'PT' and GD_Ctr_NIF starts with {'1','2'} then
			CC_AM_ExemptionNumber visible 
			CC_AM_ExemptionNumber mandatory 
			; change label to "Social Security Situation"
			label LABELS.SOCIAL_SEC_SITUATION

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=1, TRIGGERS=1
Entity CC_PT_ValidityDate is Calendar in frmMain
	with defaults
		label LABELS.labValidityDate
	with rules
		; TODO: CALENDAR SHOULD 'BE' DISABLED IN ALL DATES PRIOR TO TODAY - CHECK WITH SEB - PENDING FEEDBACK FROM SEB
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TODO: IS THIS VISIBLE?
; TESTGEN : DEFAULTS=6, RULES=4, TRIGGERS=1
Entity CC_AM_CashManagementGroup is DropDownList in frmMain
	with defaults
		label LABELS.labAMCashManagementGroup
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_CashManagementGroups with arguments {FlagActive : true}
		visible false
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_VendorCountry.Value is HF_RegionalCountry.Value then
			set value 'A1' in CC_AM_CashManagementGroup

		HF_VendorCountry.Value is not HF_RegionalCountry.Value then
			set value 'A2'

		HF_RegionalCountry.Value is 'FR' and HF_VendorCountry.Value in {'FR', 'GF', 'GP', 'RE', 'MQ', 'YT', 'NC', 'PF', 'PM', 'WF', 'MC'} then
			set value 'A1'

	with triggers
		this loads
; ----------------------------------------------------------------------------	


; 3) if a request type creation for purchase organization and the company code already exists, the value from SAP must be preserved
; 1) default values (but 'MDMV3_ENQ' can change)
; if request type creation from scratch and/or for company:
;   if company code Spain -> default value 3M60 
;   if company code 'IT' -> default value 5510 
;   if company code 'LU' -> default value 1113 
;   if company code 'BE' - >default value 1301 
;   if company code '5140' - >default value 6115
;   if company code 5924/592F -> default value 6000
;   if company code 'PT' =a)visible but not enable
; if company code 'GR' - > default value 7A90 
; b) if partner country PT-> default value ""4217""
; C) if partner country not 'PT' -> default value ""4117""

; TESTGEN : DEFAULTS=7, ACTIONS=2, RULES=9, TRIGGERS=2
Entity CC_PT_PaymentTerms is DropDownList in frmMain
	with defaults
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_PaymentTerms with arguments {FlagActive : true, ClusterCountryCode : HF_RegionalCountry.Value}
		label LABELS.labPTPaymentTerms
		mandatory
		
	with actions
		set value CC_PT_PaymentTerms.Value in PO_TermsOfPaymentKey.Value
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

		HF_RegionalCountry.Value is 'PT' and HF_RequestType.Value in {'VC', 'VC_CC'} then
			this visible false
			this mandatory false

		HF_RegionalCountry.Value is 'ES' and HF_RequestType.Value in {'VC', 'VC_CC'} then
			set value '3M60' in CC_PT_PaymentTerms
			set value '3M60' in CC_PT_PaymentTerms.OldDisplayValue

		HF_RegionalCountry.Value is 'IT' and HF_RequestType.Value in {'VC', 'VC_CC'} then
			set value '5510' in CC_PT_PaymentTerms
			set value '5510' in CC_PT_PaymentTerms.OldDisplayValue
		
		HF_RegionalCountry.Value is 'LU' and HF_RequestType.Value in {'VC', 'VC_CC'} then
			set value '1113' in PO_TermsOfPaymentKey
			set value '1113' in PO_TermsOfPaymentKey.OldDisplayValue

		HF_RegionalCountry.Value is 'BE' and HF_RequestType.Value in {'VC', 'VC_CC'} then
			set value '1301' in CC_PT_PaymentTerms
			set value '1301' in CC_PT_PaymentTerms.OldDisplayValue

		HF_RegionalCountry.Value is 'GR' and HF_RequestType.Value in {'VC', 'VC_CC'} then
			set value '7A90' in CC_PT_PaymentTerms
			set value '7A90' in CC_PT_PaymentTerms.OldDisplayValue

		HF_CompanyCode.Value is '5140' and HF_RequestType.Value in {'VC', 'VC_CC'} then
			set value '6115' in CC_PT_PaymentTerms
			set value '6115' in CC_PT_PaymentTerms.OldDisplayValue

		HF_CompanyCode.Value in {'5924', '592F'} and HF_RequestType.Value in {'VC', 'VC_CC'} then
			set value '6000' in CC_PT_PaymentTerms
			set value '6000' in CC_PT_PaymentTerms.OldDisplayValue
	
	with triggers
		this changes
		this loads

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=6, RULES=1, ACTIONS=1, TRIGGERS=2
Entity CC_PT_PaymentBlock is DropDownList in frmMain
	with defaults
		data field DisplayName
		value field Code
		label LABELS.labPTPaymentBlock
		load data from DATASOURCE.MDMV3_PaymentBlocks with arguments {FlagActive : true}
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		this changes
		this loads
; ----------------------------------------------------------------------------	


; TODO: FINISH THESE VALIDATIONS IN VALIDATE OF BTNSUBMIT
; 4) For company code France:
;     if bank country belongs to YVt6 (FR, GF, GP, RE, MQ and YT) and payment methods = Y->error:in Company Code Data it is not possible to inform Payment Methods with value 'Y - VIREMENT SFS - FRS'
;     if bank country doesn't belong to 'YVT6' and payment methods = G->in Company Code Data it is not possible to informPayment Methods with value 'G - Domestic payments thru SFS' for foreign banks
; 4)if selected payment methods 2 and vendor country Spain and house bank empty-> mandatory inform house bank
; "

; backed by file File038 - CC_PT_PaymentMethods
; TESTGEN : DEFAULTS=7, RULES=6, TRIGGERS=1
Entity CC_PT_PaymentMethods	is DropDownList in frmMain
	with defaults
		label LABELS.labPTPaymentMethods
		mandatory
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_PaymentMethods with arguments {FlagActive : true, ClusterCountryCode: HF_RegionalCountry.Value}


	with rules

		HF_VendorCountry.Value is HF_RegionalCountry.Value and HF_RegionalCountry.Value not in {'PT', 'BE', 'LU'} then
			set value 'G'

		HF_VendorCountry.Value is not HF_RegionalCountry.Value and HF_RegionalCountry.Value not in {'PT', 'BE', 'LU'} then
			set value 'Y''

		HF_RegionalCountry.Value in {'BE','LU'} then
			set value 'GY'
			this enable false

		HF_RegionalCountry.Value is 'PT' and this.Value is empty then
			set value '2GHY'
			this enable false

		HF_VendorCountry.Value is 'ES' and CC_PT_PaymentMethods.Value is '2' then
			CC_PT_HouseBank mandatory
			
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=2, TRIGGERS=1
Entity CC_PT_ClearingWithCustomer is CheckBox in frmMain
	with defaults
		label LABELS.labCC_PT_ClearingWithCustomer

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_CompanyCode.Value in {'5101', '5109'} then
			set value true in CC_PT_ClearingWithCustomer
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, ACTIONS=1, RULES=1, TRIGGERS=2
Entity CC_PT_AlternativePayee is TextBox in frmMain
	with defaults
		label LABELS.labPTAlternativePayee
		max length 10
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		ATTACHMENT mandatory  true  
		; _COMMENT_ mandatory  false 
	with triggers 
		this loads
		on change

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity CC_PT_IndividualPayment	is CheckBox in frmMain
	with defaults
		label LABELS.labPTIndividualPayment
		visible false

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RegionalCountry.Value in {'IT', 'BE', 'LU'} then
			CC_PT_IndividualPayment visible true
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : RULES=3, DEFAULTS=6, TRIGGERS=1
Entity CC_PT_HouseBank is DropDownList in frmMain
	with defaults
		label LABELS.labPTHouseBank
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_HouseBanks with arguments {FlagActive : true}
	with rules
		; need to apply this one?
		GD_Adr_Country.Value is not 'ES' then
			this enabled false 
		GD_Adr_Country.Value is 'ES' and CC_PT_PaymentMethods.Value is 2 then
			this mandatory true
		HF_RequestState.Value in {'Locked', 'Closed'} or REeQUEST.REQUEST_TYPE is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=2, RULES=1, TRIGGERS=1
Entity CC_PT_ForCreditMemos	is TextBox in frmMain
	with defaults
		visible false

	with rules
		HF_CompanyCode.Value is '5240' then
			set value '4112' in CC_PT_ForCreditMemos
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=6, RULES=4, TRIGGERS=2
Entity CC_DD_DunningProcedure is DropDownList in frmMain
	with defaults
		label LABELS.labDDDunningprocedure
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_DunningProcedure with arguments {FlagActive : true, ClusterCountryCode: HF_RegionalCountry.Value}

	with rules
		HF_RegionalCountry.Value is 'BE' then
			set value 'Y1VE' in CC_DD_DunningProcedure

		HF_RegionalCountry.Value is 'LU' then
			set value 'Y001' in CC_DD_DunningProcedure

		; HF_CompanyCode.Value in {'5101', '563M', '5109'} then
		; 	set value 10 in CC_DD_DunningProcedure
		; 	CC_DD_DunningClerk enable false

		HF_RegionalCountry.Value is 'ES' and CC_DD_DunningProcedure.Value is empty then
			CC_DD_LegalProceedings mandatory true

		; HF_RegionalCountry.Value is 'PT' then 
		; 	this visible false

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
		this changes
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=6, TRIGGERS=1
Entity CC_DD_LegalProceedings is Calendar in frmMain
	with defaults
		visible true
		label LABELS.labLegalProceedings	

	with rules
		HF_RegionalCountry.Value in {'PT','BE','LU'} then
			this visible false

		HF_RegionalCountry.Value is 'ES' and CC_DD_LastDunnedOn is not empty then
			CC_DD_DunningProcedure mandatory

		HF_RegionalCountry.Value is 'ES' and CC_DD_LegalProceedings is empty then
			set value '' in CC_DD_DunningProcedure

		HF_RegionalCountry.Value is not 'ES' and CC_DD_LegalProceedings is not empty then
			set value 'Y3PR' in CC_DD_DunningProcedure

		HF_RegionalCountry.Value is 'ES' and CC_DD_LegalProceedings.Value is empty then
			CC_DD_DunningProcedure mandatory true

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=4, TRIGGERS=1
Entity CC_DD_LastDunnedOn is Calendar in frmMain
	with defaults
		visible true
		label LABELS.labLastDunnedOn

	with rules
		HF_RegionalCountry.Value is 'PT' then 
			this visible false

		HF_RegionalCountry.Value is 'ES' and CC_DD_DunningProcedure is not empty then
			CC_DD_LastDunnedOn mandatory

		HF_RegionalCountry.Value is 'ES' and CC_DD_LegalProceedings is not empty then
			CC_DD_LastDunnedOn mandatory

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=6, RULES=1, TRIGGERS=1
Entity CC_DD_DunningBlock is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labDDDunningBlock
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_DunningBlocks with arguments {FlagActive : true}
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=2, TRIGGERS=1
Entity CC_DD_Level is TextBox in frmMain
	with defaults
		visible true
		label LABELS.labDDDunningLevel

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RegionalCountry.Value is 'PT' then 
			this visible false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=6, RULES=4, TRIGGERS=1
Entity CC_DD_DunningClerk is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labDDDunningClerk
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_AccountingClerks with arguments {FlagActive : true, CompanyCode : HF_CompanyCode.Value}

	with rules
	
		HF_RegionalCountry.Value not in {'PT', 'BE', 'LU', 'GR'} then
			this visible true

		HF_CompanyCode.Value in {'5101', '563M', '5109'} and HF_RequestType.Value is 'VC' then
			set value '10' in CC_DD_DunningClerk.Value

		HF_CompanyCode.Value in {'5101', '563M', '5109'} and CC_DD_DunningClerk is empty then
			set value '10' in CC_DD_DunningClerk.Value

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TODO: THIS FIELD IS TOO COMPLICATED - REVIEW BETTER - SEE FIELDMAPPING FILE
; TESTGEN : DEFAULTS=6, RULES=5, TRIGGERS=1
Entity CC_CO_AccountingClerk is DropDownList in frmMain
	with defaults
		visible false
		label LABELS.labCOAccountingClerk
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_AccountingClerks with arguments {FlagActive : true, CompanyCode : HF_CompanyCode.Value}

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

		HF_VendorCountry.Value in {'PT', 'FR'} then
			CC_CO_AccountingClerk visible true

		HF_CompanyCode.Value in {'5101', '563M'} then
			CC_CO_AccountingClerk visible true

		HF_RegionalCountry.Value is 'PT' and CC_CO_AccountingClerk.Visible is true and CC_PT_PaymentTerms is number or PO_TermsOfPaymentKey is number then
			set value 25 in CC_CO_AccountingClerk

		HF_RegionalCountry.Value is 'PT' and CC_CO_AccountingClerk.Visible is true and CC_PT_PaymentTerms is not number or PO_TermsOfPaymentKey is not number then
			set value 20 in CC_CO_AccountingClerk
					
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; has to be saved and resent from SAP in any case
; NOTE: NOT PRESENT IN FORM
; Entity CC_CO_AccountingClerkTel	is TextBox in frmMain
; 	with defaults
; 		visible false
; 	with rules
; 		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
; 			this enable false
; ----------------------------------------------------------------------------	

; has to be saved and resent from SAP in any case
; NOTE: NOT PRESENT IN FORM
; Entity CC_CO_AccountingClerkFax	is TextBox in frmMain
; 	with defaults
; 		visible false
; 	with rules
; 		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
; 			this enable false
; ----------------------------------------------------------------------------	

; has to be saved and resent from SAP in any case
; NOTE: NOT PRESENT IN FORM
; Entity CC_CO_AccountingClerkInternet is TextBox in frmMain
; 	with defaults
; 		visible false
; 	with rules
; 		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
; 			this enable false
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=1, TRIGGERS=1
Entity CC_CO_OurAccountWithVendor is TextBox in frmMain
	with defaults
		max length 12
		label LABELS.labCOOurAccountWithVendor
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	


; TESTGEN : DEFAULTS=3, RULES=4, TRIGGERS=1
Entity PO_AutomaticGenerationPO	is CheckBox in frmMain
	with defaults
		visible true
		label LABELS.labAutomaticGenerationPO

	with rules
		HF_RegionalCountry.Value is 'GR' then
			this visible true

		HF_RegionalCountry.Value is not 'GR' then
			this visible true
			PO_AutomaticGenerationPO visible true

		HF_RequestType.Value in {'VC', 'VC_CC', 'VC_PO'} then
			set value true in PO_AutomaticGenerationPO

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=2, TRIGGERS=1
Entity PO_OrderAcknowledgmentReq is CheckBox in frmMain
	with defaults
		visible false
		label LABELS.labOrderAcknowledgmentReq

	with rules
		HF_RequestType.Value in {'VC', 'VC_CC', 'VC_PO'} then
			set value true in PO_OrderAcknowledgmentReq
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads	
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=1, TRIGGERS=1
Entity PO_GRBasedInvoiceVerification is CheckBox in frmMain
	with defaults
		; visible false
		label LABELS.labPO_GRBasedInvoiceVerification
	with rules
		; HF_RegionalCountry.Value is 'GR' then
		; 	this visible true
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=6, TRIGGERS=2
Entity PO_ReturnsVendor	is CheckBox in frmMain
	with defaults
		visible true
		label LABELS.labPO_ReturnsVendor

	with rules

		HF_RequestType.Value is 'VM' and PO_ReturnsVendor.Value is true and GD_Ctr_CustomerNumber.OldDisplayValue is empty then
			GD_Ctr_CustomerNumber mandatory
			GD_Ctr_CustomerNumber visible
			GD_Ctr_CustomerNumber enable true

		HF_RequestType.Value is 'VM' and PO_ReturnsVendor.Value is true and GD_Ctr_CustomerNumber.OldDisplayValue is not empty then
			GD_Ctr_CustomerNumber mandatory false
			GD_Ctr_CustomerNumber visible
			GD_Ctr_CustomerNumber enable false

		HF_RequestType.Value is 'VM' and PO_ReturnsVendor.Value is false then
			GD_Ctr_CustomerNumber enable false

		HF_RequestType.Value is not 'VM' and PO_ReturnsVendor.Value is true then
			GD_Ctr_CustomerNumber visible
			GD_Ctr_CustomerNumber mandatory

		HF_RegionalCountry.Value is 'GR' then
			set value false in PO_ReturnsVendor
			this visible true

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this changes
		this loads

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=7, RULES=2, ACTIONS=1, TRIGGERS=2
Entity PO_PurchaseOrderCurrency	is DropDownList in frmMain
	with defaults
		mandatory
		label LABELS.labPurchaseOrderCurrency
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_Currencies with arguments {FlagActive : true }
		value EUR
	with rules
		HF_RequestType.Value is 'VC' then
			set value EUR in SO_SalesOrderCurrency
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		this changes
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=7, RULES=11, ACTIONS=0, TRIGGERS=2
Entity PO_TermsOfPaymentKey is DropDownList in frmMain
	with defaults
		mandatory
		label LABELS.labPO_TermsOfPaymentKey
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_PaymentTerms with arguments {FlagActive : true, ClusterCountryCode : HF_RegionalCountry.Value}

	with rules

		; TODO: REMOVE THE VALUE FROM SP CHECK AS THIS IS A VC
		HF_RequestType.Value is 'VC' and HF_RegionalCountry.Value is 'ES' and REQUEST_SAP.PO_TermsOfPaymentKey is empty then
			set value '3M60' in PO_TermsOfPaymentKey
			set value '3M60' in PO_TermsOfPaymentKey.OldDisplayValue

		HF_RequestType.Value is 'VC' and HF_CurrentRole.Value is ENQ and HF_RegionalCountry.Value is 'IT'  and REQUEST_SAP.PO_TermsOfPaymentKey is empty then
			set value '5510' in PO_TermsOfPaymentKey
			set value '5510' in PO_TermsOfPaymentKey.OldDisplayValue
	
		HF_RequestType.Value is 'VC' and HF_RegionalCountry.Value is 'LU'  and REQUEST_SAP.PO_TermsOfPaymentKey is empty then
			set value '1113' in PO_TermsOfPaymentKey
			set value '1113' in PO_TermsOfPaymentKey.OldDisplayValue
	
		HF_RequestType.Value is 'VC' and HF_RegionalCountry.Value is 'BE' and REQUEST_SAP.PO_TermsOfPaymentKey is empty then
			set value '1301' in PO_TermsOfPaymentKey
			set value '1301' in PO_TermsOfPaymentKey.OldDisplayValue

		HF_RequestType.Value is 'VC' and HF_RegionalCountry.Value is 'GR' and REQUEST_SAP.PO_TermsOfPaymentKey is empty then
			set value '7A90' in PO_TermsOfPaymentKey
			set value '7A90' in PO_TermsOfPaymentKey.OldDisplayValue
		
		HF_RequestType.Value is 'VC' and HF_CompanyCode.Value is '5140' and REQUEST_SAP.PO_TermsOfPaymentKey is empty then
			set value '6115' in PO_TermsOfPaymentKey
			set value '6115' in PO_TermsOfPaymentKey.OldDisplayValue

		HF_RequestType.Value is 'VC' and HF_CompanyCode.Value in {'5924','592F'} and REQUEST_SAP.PO_TermsOfPaymentKey is empty then
			set value '6000' in PO_TermsOfPaymentKey
			set value '6000' in PO_TermsOfPaymentKey.OldDisplayValue

		HF_RegionalCountry.Value is 'PT' and HF_VendorCountry.Value is 'PT' and REQUEST_SAP.PO_TermsOfPaymentKey is empty then
			set value '4217' in PO_TermsOfPaymentKey
			set value '4217' in PO_TermsOfPaymentKey.OldDisplayValue
			
		HF_RegionalCountry.Value is 'PT' and HF_VendorCountry.Value is not 'PT' and REQUEST_SAP.PO_TermsOfPaymentKey is empty then
			set value '4117' in PO_TermsOfPaymentKey
			set value '4117' in PO_TermsOfPaymentKey.OldDisplayValue

		HF_RequestType.Value in {'VC', 'VC_CC'} then
			set value PO_TermsOfPaymentKey.Value in CC_PT_PaymentTerms

		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with actions
		; ; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		this changes
		this loads


; ----------------------------------------------------------------------------	

; TODO: DEFAULTS=7, RULES=7, ACTIONS=3, TRIGGERS=2
Entity PO_Incoterms	is DropDownList in frmMain
	with defaults
		label LABELS.labIncoterms	
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_Incoterms with arguments {FlagActive : true}
		mandatory true

	with actions
		; whenever the value of this dropdown list changes, copy the text, not the value to PO_IncotermsPart2
		set value PO_Incoterms.Text in PO_IncotermsPart2
		set value PO_Incoterms.SelectedText in PO_IncotermsPart2.OldDisplayValue
		; ; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  

	with rules

		HF_RequestType.Value in {'VC', 'VC_CC', 'VC_PO'} and HF_RegionalCountry.Value is 'ES' then
			set value 'DAP' in PO_Incoterms
			set value 'DAP' in PO_Incoterms.OldDisplayValue

		HF_RequestType.Value in {'VC', 'VC_CC', 'VC_PO'} and HF_RegionalCountry.Value is 'IT' then
			set value 'EXW' in PO_Incoterms
			set value 'EXW' in PO_Incoterms.OldDisplayValue

		HF_RequestType.Value in {'VC', 'VC_CC', 'VC_PO'} and HF_RegionalCountry.Value in {PT, BE, LU} then
			set value 'DDP' in PO_Incoterms
			set value 'DDP' in PO_Incoterms.OldDisplayValue

		HF_RequestType.Value in {'VC', 'VC_CC', 'VC_PO'} and HF_CompanyCode.Value in {5140,5924,592F} then
			set value 'DAP' in PO_Incoterms
			set value 'DAP' in PO_Incoterms.OldDisplayValue

		HF_RequestType.Value in {'VC', 'VC_CC', 'VC_PO'} and HF_CompanyCode.Value in 5150 then
			set value 'CIF' in PO_Incoterms
			set value 'CIF' in PO_Incoterms.OldDisplayValue

		HF_RequestType.Value in {'VC', 'VC_CC', 'VC_PO'} and HF_PurchaseOrg.Value in {65G0, 65Q0} then
			set value 'FCA' in PO_Incoterms
			set value 'FCA' in PO_Incoterms.OldDisplayValue
		
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		this changes
		this loads

; ----------------------------------------------------------------------------	


; TESTGEN : DEFAULT=4, RULES=9, TRIGGERS=1
Entity PO_IncotermsPart2 is TextBox in frmMain
	with defaults
		label LABELS.labIncotermsPart2
		mandatory true

	with rules

		HF_CompanyCode.Value is '5150' and REQUEST_SAP.PO_IncotermsPart2 is empty then
			set value 'ATHENS' in PO_IncotermsPart2
		HF_CompanyCode.Value is '5150' and GD_Adr_City2 is not empty and REQUEST_SAP.PO_IncotermsPart2 is empty then
			set value GD_Adr_City2.Value in PO_IncotermsPart2
		HF_CompanyCode.Value in {'5924','592F'} and REQUEST_SAP.PO_IncotermsPart2 is empty then
			set value 'Saint Denis' in PO_IncotermsPart2
		HF_CompanyCode.Value is '491E' and HF_PurchaseOrg.Value in {'65G0', '65Q0'} and REQUEST_SAP.PO_IncotermsPart2 is empty then
			set value 'GRENOBLE' in PO_IncotermsPart2
		HF_CompanyCode.Value is '491E' and HF_PurchaseOrg.Value not in {'65G0', '65Q0'} and REQUEST_SAP.PO_IncotermsPart2 is empty then
			set value 'France Metropolitaine' in PO_IncotermsPart2
		HF_CompanyCode.Value is '5140' and REQUEST_SAP.PO_IncotermsPart2 is empty then
			set value 'France Metropolitaine' in PO_IncotermsPart2
		HF_RegionalCountry.Value in {'BE','LU'} and REQUEST_SAP.PO_IncotermsPart2 is empty then
			set value 'Brussels' in PO_IncotermsPart2.OldDisplayValue
			set value 'Brussels' in PO_IncotermsPart2.Value
		HF_RegionalCountry.Value is 'IT' and REQUEST_SAP.PO_IncotermsPart2 is empty then
			set value 'VS. MAGAZZINO' in PO_IncotermsPart2.OldDisplayValue
			set value 'VS. MAGAZZINO' in PO_IncotermsPart2.Value
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=6,RULES=2, TRIGGERS=1
Entity PO_ConfirmationControl is DropDownList in frmMain
	with defaults
		label LABELS.labConfirmationControl
		visible false
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_ConfirmationControl with arguments {FlagActive : true}

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		HF_RegionalCountry.Value is 'FR' and PO_ConfirmationControl.Value is empty then
			set value 'Y601' in PO_ConfirmationControl
			PO_ConfirmationControl visible true
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; Entity CostCenter is TextBox in frmMain
; 	with defaults
; 		label LABELS.labCostCenter
; 		
; 	with rules
; 		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
; 			this enable false
; ----------------------------------------------------------------------------	

; TODO: THIS TEXTBOX HAS A LOT OF LOGIC - TODO: PENDING CALCULATEEXTERNALNUMBER etc.
; NOTE: NOT IN FIELDMAPPING

; TESTGEN : DEFAULTS=5, RULES=4, TRIGGERS=1
Entity GD_SAPNumber is TextBox in frmMain
	with defaults
		label LABELS.labSAPNumber
		visible false
		; at least one number
		validation ^[0-9]+$
		max length 10

	with rules
		HF_RequestType.Value is 'VC' then
			this visible true
			this enable true
		else
			this enable false
		HF_RegionalCountry.Value in {'BE','LU'} and HF_CurrentRole.Value is 'MDMV3_CLERK' then
			this mandatory true
		HF_CompanyCode.Value in {'5101', '5109', '563M'} then 
			GD_SAPNumber mandatory true
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
		
		; HF_RegionalCountry.Value is 'BE' and HF_RequestType.Value is 'VC' and HF_CurrentRole.Value is 'MDMV3_CLERK' and REQUEST.SAP_MESSAGE is empty then
		; 	set value '' in GD_SAPNumber

		; TODO: MOVE TO VALIDATE
		; GD_SAPNumber is visible and DDLDCReqAction.Value is STATUS.SUBMITTED and HF_RegionalCountry.Value is 'BE' and HF_RequestType.Value is 'VC' then
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=1, TRIGGERS=1
; TODO: CHECK WITH SEB IF THEY KNOW WHAT THIS IS FOR... SEND EMAIL EXPLAINING
Entity SAP_Message is TextBox in frmMain
	with defaults
		label LABELS.labSAP_Message
		visible false
		enable false
	with rules
		HF_RequestState.Value is CLOSED then
			this visible true
	with triggers
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=4, RULES=2, TRIGGERS=1
Entity TS_IsUrgentRequest is CheckBox in frmMain
	with defaults
		label LABES.labUrgentRequest
		value false
	with rules

		REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false
		HF_RequestState.Value in {'Locked', 'Closed'} then
			this enable false

	with triggers
		this loads
		

; --- CONTROLS IN BLOCKING DATA TAB -------------------------------------------

; TESTGEN ; DEFAULTS=6, RULES=1, ACTIONS=1, TRIGGERS=2
Entity BLK_GD_Ctr_UnsubscribeCMD is DropDownList in frmMain
	with defaults
		label LABELS.labUnsubscribeCMD
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_UnsubscribeOptions

	with actions
		set value BLK_GD_Ctr_UnsubscribeCMD.Value in GD_Ctr_UnsubscribeCMD

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is not 'VM_UBLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with triggers
		; when this controls change, change the value of GD_Ctr_UnsubscribeCMD
		this changes
		this loads

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=6, RULES=1, ACTIONS=1, TRIGGERS=2
Entity BLK_CC_PT_PaymentBlock is DropDownList in frmMain
	with defaults
		label LABELS.labPTPaymentBlock
		data field DisplayName
		value field Code
		load data from DATASOURCE.MDMV3_PaymentBlocks with arguments {FlagActive : true}
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is not 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		this changes
		this loads

; ----------------------------------------------------------------------------	

; TESTGEN : RULES=1, DEFAULTS=3, ACTIONS=1, TRIGGERS=2
Entity BLK_CentralPO is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labCentralPostingBlock
	
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is not 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		on change
		this loads
; ----------------------------------------------------------------------------	

; this was not even in the field mapping, but is visible false as default, so probably not used...
; TODO: CHECK AT RUNTIME
; TESTGEN : RULES=1, DEFAULTS=3, TRIGGERS=1
Entity BLK_24_hour is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labUnBlockFor24Hours
		visible false
	
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is not 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with triggers
		this loads
	
; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFB1.SPERR
;	2)SEND data to SAP in field SPERB_B
; TESTGEN : RULES=1, DEFAULTS=3, ACTIONS=1, TRIGGERS=2
Entity BLK_CompanyCode is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labUnBlockFor24Hours
	
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is not 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		this changes
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : RULES=1, DEFAULTS=3, ACTIONS=1, TRIGGERS=2
Entity BLK_Central is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labCentrallyPurchasingBlock
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is not 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		this changes
		this loads
; ----------------------------------------------------------------------------	

; TESTGEN : RULES=1, DEFAULTS=3, ACTIONS=1, TRIGGERS=2
Entity BLK_PO is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labPursachingBlockAtOrganization
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is not 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		this changes
		this loads
; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFA1.LOEVM
;	2)SEND data to SAP in field LOEVM_X
; TESTGEN : DEFAULTS=3, RULES=1, ACTIONS=1, TRIGGERS=2
Entity BLK_MFD_Central is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_Central
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is not 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		this changes
		this loads
; ----------------------------------------------------------------------------	

;	1)Get data from SAP from field LFB1.LOEVM not available on services
;	2)SEND data to SAP in field LOEVM_B

; TESTGEN : DEFAULTS=3, RULES=1, ACTIONS=1, TRIGGERS=2
Entity BLK_MFD_CompanyCode is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_CompanyCode
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is not 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		this changes
		this loads
; ----------------------------------------------------------------------------	

; LFA1.LOEVM
; SEND TO SAP IN FIELD LOEVM_M
; TESTGEN : DEFAULTS=3, RULES=1, ACTIONS=1, TRIGGERS=2
Entity BLK_MFD_PO is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_PO
	
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is not 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false

	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		this changes
		this loads
; ----------------------------------------------------------------------------	

; LFA1.NODEL
; TESTGEN : DEFAULTS=3, RULES=1, ACTIONS=1, TRIGGERS=2
Entity BLK_MFD_DeletionBlockCentral	is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_DeletionBlockCentral
	
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is not 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		this loads
		this changes
; ----------------------------------------------------------------------------	

; not sent to SAP, only retrieve from LFB1.NODEL
; TESTGEN : DEFAULTS=3, RULES=1, ACTIONS=1, TRIGGERS=2
Entity BLK_MFD_DeletionBlockCompanyCode	is CheckBox in frmMain
	with defaults
		enabled false
		label LABELS.labBLK_MFD_DeletionBlockCompanyCode
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is not 'VM_BLK' or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
	with actions
		; ATTACHMENT mandatory  false 
		_COMMENT_ mandatory  true  
	with triggers 
		this changes
		this loads

; --- BUTTON BLOCK -----------------------------------------------------------

; NOTE: TELL SEB - REMOVED AS 'IT' IS ALWAYS INVISIBLE
; Entity GD_Ctr_CapCostNumber	is Button in frmMain
; 	with defaults
; 		label LABELS.btnCaptureCostumerNumber
; 		visible false
; 	with rules
; 		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is {'VM_BLK', 'VM_UBLK'} or HF_CurrentRole.Value in {'MDMV3_CPM', 'MDMV3_UPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
; 			this enable false
; ----------------------------------------------------------------------------	

; TODO: PENDING FINAL REVISION
Entity btnSubmit is Button in frmMain
	with defaults
		label LABELS.btnSubmit

	with actions
		; set value toupper(GD_Adr_Name.Value) in GD_Adr_Name
		; set value toupper(GD_Adr_Name.Value) in    GD_Adr_Name
		; set value toupper(GD_Adr_Name2.Value) in   GD_Adr_Name2
		; set value toupper(GD_Adr_Name3.Value) in   GD_Adr_Name3
		; set value toupper(GD_Adr_Name4.Value) in   GD_Adr_Name4
		; set value toupper(GD_Adr_Street.Value) in  GD_Adr_Street
		; set value toupper(GD_Adr_Street2.Value) in GD_Adr_Street2
		; set value toupper(GD_Adr_Street3.Value) in GD_Adr_Street3
		; set value toupper(GD_Adr_Street4.Value) in GD_Adr_Street4
		; set value toupper(GD_Adr_Street5.Value) in GD_Adr_Street5
		; set value toupper(GD_Adr_City.Value) 	in   GD_Adr_City

	with rules

		; --- validations when submitting

		DDLDCReqAction is empty then
			set value MESSAGES.ERRsubmitRequestAction in MESSAGE_POPUP
		
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_CurrentRole.Value in {'MDMV3_ENQ','MDMV3_CLERK'} and CC_PT_PaymentMethods.Value is 2 and REQUEST.BANK_DETAILS is empty then		; 2 means CONFIRMING
			set value MESSAGES.ERRsubmitRequestGDFieldBank in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Ctr_IsNaturalPerson.Value is true and GD_Adr_Country.Value is 'IT' and GD_NatP_DateOfBirth.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldData in MESSAGE_POPUP
	
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Ctr_IsNaturalPerson.Value is true and GD_Adr_Country.Value is 'IT' and GD_NatP_PlaceOfBirth.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldPlace in MESSAGE_POPUP

		; TODO: GD_NatP_Exemption.Visible is true or GD_NatP_Exemption is visible?
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Ctr_IsNaturalPerson.Value is true and GD_Adr_Country.Value is 'IT' and GD_NatP_Exemption.Value and GD_NatP_Exemption.Visible is true is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldExemption in MESSAGE_POPUP
		
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_VT_Grid.Items.Count is 0 and HF_RegionalCountry.Value is not 'BE' then
			set value MESSAGES.ERRsubmitRequestGDFieldTelephone in MESSAGE_POPUP
		
		; TODO: DEFINE SOMEHOW THE CHECKIN OF DEFAULT ROW IN GRID...
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_VT_Grid.Items.Count is not 0 and REQUEST.PHONE_DETAILS.NO_DEFAULT_ENTRY is true then
			set value MESSAGES.ERRsubmitRequestGDFieldPhone in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and PO_ReturnsVendor.Value is true and GD_Ctr_CustomerNumber.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldCustomerNum in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_CurrentRole.Value is 'MDMV3_CLERK' and GD_Procur_Supplier_ExpectedPVO >= 3 and HF_RegionalCountry.Value is not 'IT' and GD_PVO_Question1.Value is 0 then
			set value MESSAGES.ERRsubmitRequestGDEmptyPDQuestion1 in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_CurrentRole.Value is 'MDMV3_CLERK' and GD_Procur_Supplier_ExpectedPVO >= 3 and HF_RegionalCountry.Value is not 'IT' and GD_PVO_Question2.Value is 0 then
			set value MESSAGES.ERRsubmitRequestGDEmptyPDQuestion2 in MESSAGE_POPUP
			
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_CurrentRole.Value is 'MDMV3_CLERK' and GD_Procur_Supplier_ExpectedPVO >= 3 and HF_RegionalCountry.Value is not 'IT' and GD_PVO_Question3.Value is 0 then
			set value MESSAGES.ERRsubmitRequestGDEmptyPDQuestion3 in MESSAGE_POPUP
	
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_CurrentRole.Value is 'MDMV3_CLERK' and GD_Procur_Supplier_ExpectedPVO >= 3 and HF_RegionalCountry.Value is not 'IT' and GD_PVO_Question4.Value is 0 then
			set value MESSAGES.ERRsubmitRequestGDEmptyPDQuestion4 in MESSAGE_POPUP
	
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_CurrentRole.Value is 'MDMV3_CLERK' and GD_Procur_Supplier_ExpectedPVO >= 3 and HF_RegionalCountry.Value is not 'IT' and GD_PVO_Question5.Value is 0 then
			set value MESSAGES.ERRsubmitRequestGDEmptyPDQuestion5 in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_VendorCountry.Value in {FR,GP,YT,MC,RE,MQ,GF} and REQUEST.BANK_DETAILS > 0 and REQUEST.BANK_DETAILS.FIRST.GD_VB_COUNTRY in {FR,GP,YT,MC,RE,MQ,GF} and CC_PT_PaymentMethods.Value is Y then
			set value MESSAGES.ERRsubmitRequestCCFieldPaymentMethodInvalid in MESSAGE_POPUP
	
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_VendorCountry.Value in {FR,GP,YT,MC,RE,MQ,GF} and REQUEST.BANK_DETAILS > 0 and REQUEST.BANK_DETAILS.FIRST.GD_VB_COUNTRY not in {FR,GP,YT,MC,RE,MQ,GF} and CC_PT_PaymentMethods.Value is 'G' then
			set value MESSAGES.ERRsubmitRequestCCFieldInformPaymentInvalid in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_VendorCountry.Value not in {FR,GP,YT,MC,RE,MQ,GF} and CC_PT_PaymentMethods.Value is 'G' then
			set value MESSAGES.ERRsubmitRequestCCFieldInformPaymentInvalid in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and CC_PT_ValidityDate.Value is not empty and CC_PT_ValidityDate.Value < DATE.TODAY then
			set value MESSAGES.ERRsubmitRequestCCFielddateInv in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Country.Value is 'IT' and GD_Ctr_CF is not empty and GD_Ctr_CF.Value.Length < 9 then
			set value MESSAGES.ERRsubmitRequestGDFieldCFShort in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Country.Value is 'PT' and GD_Ctr_CF is not empty and GD_Ctr_CF.Value.Length < 9 then
			set value MESSAGES.ERRsubmitRequestGDFieldNIFShort in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Country.Value is 'IT' and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_CF is empty and HF_RequestType.Value is 'VC' then
			set value MESSAGES.ERRsubmitRequestGDFieldCFEmpty in MESSAGE_POPUP
					   
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Ctr_VendorClassification.Value is empty then
			set value MESSAGES.ERRsubmitRequestRHFieldVClass in MESSAGE_POPUP
					   
		HF_RequestType.Value in {'VC','VC_CC'} and GD_Procur_SuppliersName is empty then			   
			set value MESSAGES.ERRsubmitRequestRHFieldName in MESSAGE_POPUP
		
		HF_RequestType.Value in {'VC','VC_CC'} and GD_Procur_ESNCode is empty then		   
			set value MESSAGES.ERRsubmitRequestRHFieldESN in MESSAGE_POPUP			   
		
		HF_RequestType.Value in {'VC','VC_CC'} and GD_Procur_Reason_Justification is empty then		   
			set value MESSAGES.ERRsubmitRequestRHFieldJustification in MESSAGE_POPUP

		HF_RequestType.Value in {'VC','VC_CC'} and GD_Procur_GoodsToSiemens is empty then		   
			set value MESSAGES.ERRsubmitRequestRHFieldGoods in MESSAGE_POPUP
		
		HF_RequestType.Value in {'VC','VC_CC'} and GD_Procur_Supplier_ExpectedPVO is empty then		   
			set value MESSAGES.ERRsubmitRequestRHFieldExpected in MESSAGE_POPUP			   
		
		HF_RequestType.Value in {'VC','VC_CC'} and GD_Procur_Supplier_IsOneTimeVendor is empty then		   
			set value MESSAGES.ERRsubmitRequestRHFieldOccasionalV in MESSAGE_POPUP			   

		HF_RequestType.Value in {'VC','VC_CC'} and E_GD_VE_Grid is empty then		   
			set value MESSAGES.ERRsubmitRequestRHFieldOccasionalV in MESSAGE_POPUP			   
		
		; HF_CurrentRole.Value in {'MDMV3_ENQ','MDMV3_CLERK'}

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Name.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldVName in MESSAGE_POPUP	
					   
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Street.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldVStreet in MESSAGE_POPUP
						   
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Region.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldVRegion in MESSAGE_POPUP		
				   
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_City.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldVCity in MESSAGE_POPUP			   
		
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Com_LanguageCode.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldLanguage in MESSAGE_POPUP			   
		
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Com_Telebox.Value is empty and HF_VendorCountry.Value is not WF then
			set value 'To submit the request fill all the mandatory fields: in General Data view the field Telebox is empty' in MESSAGE_POPUP			   
		
		HF_RequestType.Value is not 'VM_BLK' and GD_Adr_Country.Value is not 'IT' and HF_AccountGroup.Value not in {'YCT6', 'YVT6'} and GD_Ctr_TaxCode1.Value is empty and GD_Ctr_TaxCode1.IsMandatory is true then
			set value MESSAGES.ERRsubmitRequestGDFieldTaxCode1 in MESSAGE_POPUP			   
		
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Country.Value is 'PT' and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_TaxCode1.Value.Length < 9 then
			set value MESSAGES.ERRsubmitRequestGDFieldTaxCode1Inv in MESSAGE_POPUP			   
		
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Country.Value is 'PT' and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_TaxCode1.Value.Length < 9 and HF_CompanyCode.Value is '5240' and GD_Ctr_NIF.Value starts with {'1','2'} then
			set label MESSAGES.MSGNiss in GD_Ctr_TaxCode2
			set label MESSAGES.MSGNEmployess in GD_NatP_PlaceOfBirth
			set value MESSAGES.ERRsubmitRequestRHFieldOccasionalV in MESSAGE_POPUP
		
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Country.Value is 'PT' and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_TaxCode1.Value.Length < 9 and HF_CompanyCode.Value is '5240' and GD_Ctr_NIF.Value starts with {'1','2'} and GD_Ctr_TaxCode2 is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldNISS in MESSAGE_POPUP

		; TODO:                 if ( String.IsNullOrEmpty ( this.GD_NatP_PlaceOfBirth.Text ) || !int.TryParse ( this.GD_NatP_PlaceOfBirth.Text, out i ) )
        ;                       Error = Error + ( "To submit the request fill all the mandatory fields: in General Data view the field Nº Employees is mandatory and must be numeric.<br/> " );

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Country.Value is not 'IT' and HF_AccountGroup.Value not in {'YVT6', 'YVT9', 'YCT6', 'YCT9'} and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_TaxCode2 is empty and GD_Ctr_TaxCode2 is mandatory then
			set value MESSAGES.ERRsubmitRequestGDFieldTaxCode2Empty in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Country.Value is not 'IT' and HF_AccountGroup.Value not in {'YVT6', 'YVT9', 'YCT6', 'YCT9'} and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_VATRegistrationNumber is empty and GD_Ctr_VATRegistrationNumber.IsMandatory is true then
			set value MESSAGES.ERRsubmitRequestGDFieldVatReg in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Country.Value is 'IT' and GD_Ctr_IsNaturalPerson.Value is true then
			GD_Ctr_TaxCode1 mandatory true
			GD_Ctr_TaxCode2 mandatory false

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Country.Value is 'IT' and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_TaxCode1.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldTaxCode1Empty in MESSAGE_POPUP			   

		; TODO: how to include this WEBSERVICE call in a condition like this?
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_POBox.Value is not empty and WEBSERVICE.VALIDATE_POSTAL_CODE with arguments {} and GD_Adr_Country.Value is not 'GR' and HF_AccountGroup.Value not in {'YVT6', 'YVT9', 'YCT6', 'YCT9'} then
			set value MESSAGES.ERRsubmitRequestGDPOinv in MESSAGE_POPUP			   
		
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Adr_Name.Value is empty then
			set value MESSAGES.ERRsubmitRequestRHFieldOccasionalV in MESSAGE_POPUP			   

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_CurrentRole.Value in {'MDMV3_ENQ', 'MDMV3_CLERK'} and F_GD_VF_Grid.Items.Items.Count is true and F_GD_VF_Grid.HasDefaultRow is false then
			; TODO: DEFINE THESE THINGS
			; meaning, there must be one selected default row in the grid if there are rowsLERKC and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_PIVA.Value is empty and 	GD_Ctr_PIVA.IsMandatory is true then
			set value MESSAGES.ERRsubmitRequestGDFieldSIRET in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_VendorCountry.Value in {'FR','GF','GP','RE','MQ','YT','NC','PF','PM','WF','MC','TF'} and HF_RequestType.Value is 'VC' and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_PIVA.Value.Value.Length is not 14 then
			set value MESSAGES.ERRsubmitRequestGDFieldSIRET_14 in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_VendorCountry.Value in {'FR','GF','GP','RE','MQ','YT','NC','PF','PM','WF','MC','TF'} and HF_RequestType.Value is 'VC' and GD_Ctr_IsNaturalPerson.Value is true and GD_Ctr_VATRegistrationNumber.Value is empty and GD_Ctr_VATRegistrationNumber.IsMandatory is true then
			set value MESSAGES.ERRsubmitRequestGDFieldVatEmplty in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_VendorCountry.Value in {'FR','GF','GP','RE','MQ','YT','NC','PF','PM','WF','MC','TF'} and HF_RequestType.Value is 'VC' and GD_Adr_POBoxLoc.Value is empty and GD_Adr_POBoxLoc.IsMandatory is true then
			set value MESSAGES.ERRsubmitRequestPOBOXinformed in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_VendorCountry.Value in {'FR','GF','GP','RE','MQ','YT','NC','PF','PM','WF','MC','TF'} and HF_CurrentRole.Value is 'MDMV3_CLERK' and GD_Ctr_GFORM.Value is empty and GD_Ctr_GFORM.IsMandatory is true then
			set value MESSAGES.ERRsubmitRequestFieldLegalForm in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_SAPNumber.Visible is true and DDLDCReqAction.Value is STATES.SUBMITTED and HF_RegionalCountry.Value in {'BE','LU'} and GD_SAPNumber.Value is empty then
			set value MESSAGES.ERRsubmitRequestRHFieldSAPNEmpty in MESSAGE_POPUP
			
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_SAPNumber.Visible is true and DDLDCReqAction.Value is STATES.SUBMITTED and HF_RegionalCountry.Value is 'BE' and GD_SAPNumber.Value is not empty and GD_SAPNumber.Value < 1000000000 or GD_SAPNumber.Value > 1999999999 then
			set value MESSAGES.ERRsubmitRequestRHFieldSAPInv in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_SAPNumber.Visible is true and DDLDCReqAction.Value is STATES.SUBMITTED and HF_RegionalCountry.Value is 'LU' and GD_SAPNumber.Value is not empty and GD_SAPNumber.Value < 2000000000 or GD_SAPNumber.Value > 2999999999 then
			set value MESSAGES.ERRsubmitRequestRHFieldSAPInv2 in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and CC_AM_WithholdingTaxCode.IsMandatory is true and CC_AM_WithholdingTaxCode.Value is empty then
			set value MESSAGES.ERRsubmitRequestCCTaxCode in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and HF_RegionalCountry.Value is 'IT' and CC_AM_SubjectedToWHTax.Value is true and CC_AM_WithholdingTaxCode.Value is empty then
			set value MESSAGES.ERRsubmitRequestCCTaxCode in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Damex.IsMandatory is true and GD_Damex.Value is empty then
			set value MESSAGES.ERRsubmitRequestRHFieldDamex in MESSAGE_POPUP
		
		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and GD_Damex.Value is true and ATTACHMENT.Items.Count is 0 then
			set value MESSAGES.ERRsubmitRequestAttachment in  MESSAGE_POPUP

		HF_CurrentRole.Value is 'MDMV3_ENQ' and HF_RequestType.Value is 'VC' and DDLDCComment.Value is empty then
			set value MESSAGES.ERRsubmitRequestComment in  MESSAGE_POPUP

		DDLDCComment.Value is not empty and DDLDCComment.Value.Length > 2000 then
			set value MESSAGES.ERRcommentLenght in  MESSAGE_POPUP

		; some greece specific rules
		HF_RequestType.Value in {'VC','VC_CC'} and GD_Adr_Country.Value is 'GR' and GD_Adr_Name3.Value and is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldName3 in MESSAGE_POPUP
		
		HF_RequestType.Value in {'VC','VC_CC'} and GD_Adr_Country.Value is 'GR' and GD_Adr_Name4.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldName4 in MESSAGE_POPUP

		GD_Adr_Country.Value is 'GR' and GD_Ctr_IsNaturalPerson.Value is true and CC_AM_WithholdingTaxCode.IsMandatory is true and CC_AM_WithholdingTaxCode.Value is empty then
			set value MESSAGES.ERRsubmitRequestCCWithholding in MESSAGE_POPUP
		
		GD_Adr_Country.Value is 'GR' and and GD_Ctr_TaxCode2.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDFieldTaxCode2Empty in MESSAGE_POPUP

		GD_Adr_Country.Value is 'GR' and and GD_Ctr_TaxCode2.Value is not empty and GD_Ctr_TaxCode2.Value.Length < 9 then
			set value MESSAGES.ERRsubmitRequestGDFieldTaxCode1_9 in MESSAGE_POPUP

		GD_Adr_Country.Value is 'GR' and and PO_Incoterms.Value is empty then
			set value MESSAGES.ERRsubmitRequestPOFieldIncoterms in MESSAGE_POPUP

		GD_Adr_Country.Value is 'GR' and and PO_Incoterms2.Value is empty then
			set value MESSAGES.ERRsubmitRequestPOFieldIncoterms2 in MESSAGE_POPUP

		GD_Adr_Country.Value is 'GR' and GD_Adr_City2.Value is empty and GD_Adr_City2.IsMandatory is true then
			set value MESSAGES.ERRsubmitRequestGDFieldDistrict in MESSAGE_POPUP

		CC_AM_BPClassification.Value is empty then
			set value MESSAGES.ERRsubmitRequestRHFieldBPC in MESSAGE_POPUP

		HF_RegionalCountry.Value is 'ES' and CC_PT_PaymentMethods.Value is 2 and CC_PT_HouseBank.Value is empty then 
			set value MESSAGES.ERRsubmitRequestCCHouseBank in MESSAGE_POPUP
			
		CC_AM_SortKey.Value is empty then
			set value MESSAGES.ERRsubmitRequestCCFieldSortKey in MESSAGE_POPUP

		CC_PT_PaymentTerms is visible and CC_PT_PaymentTerms.Value is empty then 
			set value MESSAGES.ERRsubmitRequestCCFieldPaymentTerm in MESSAGE_POPUP

		HF_RegionalCountry.Value is 'ES' and CC_DD_DunningProcedure.Value is not empty and CC_DD_LegalProceedings.Value is empty then
			set value MESSAGES.ERRsubmitRequestCCFieldLegalDunnig in MESSAGE_POPUP

		HF_RegionalCountry.Value not in {'IT', 'PT'} and HF_CurrentRole.Value in {'MDMV3_ENQ','MDMV3_CLERK'} and CC_PT_PaymentMethods.IsMandatory is true and CC_PT_PaymentMethods.Value is empty then
			set value MESSAGES.ERRsubmitRequestCCViewFieldPaymentMethod in MESSAGE_POPUP
	 
		PO_PurchaseOrderCurrency.Value is empty and HF_CompanyCode.Value is 563M then
			set value MESSAGES.ERRSubmitRequestPOPurchaseOrderEmpty in MESSAGE_POPUP

		PO_TermsOfPaymentKey.Value is empty and HF_CompanyCode.Value is 563M then
			set value MESSAGES.ERRSubmitRequestPOTermsPaymentEmpty in MESSAGE_POPUP

		HF_RequestType.Value not in {'VM_BLK', 'VM_UBLK'} and CC_AM_BPClassification.Value is empty then
			set value MESSAGES.ERRsubmitRequestValuePartnerRisk in MESSAGE_POPUP

		HF_RequestType.Value is 'VC' then
			ATTACHMENT mandatory true

		; TODO: CHECK THIS WITH SEB?
		ATTACHMENT.IsMandatory is true and ATTACHMENT.Items.Count is 0 then
			set value MESSAGES.ERRsubmitRequestAttachment in MESSAGE_POPUP

		GD_Adr_PostalCode.Value is empty and HF_AccountGroup.Value in {'YVT6','YVT9','YCT6','YCT9'} and GD_Adr_Region.Value not in {'75','2A','2B'} and GD_Adr_PostalCode.Value not starts with GD_Adr_Region.Value then
			set value MESSAGES.ERRsubmitRequestGDPostalCode in MESSAGE_POPUP

		GD_Adr_PostalCode.Value is empty and HF_AccountGroup.Value in {'YVT6','YVT9','YCT6','YCT9'} and GD_Adr_Region.Value is '75' and GD_Adr_PostalCode.Value not starts with '00' then
			set value MESSAGES.ERRsubmitRequestGDPostalCode in MESSAGE_POPUP

		GD_Adr_PostalCode.Value is empty and HF_AccountGroup.Value in {'YVT6','YVT9','YCT6','YCT9'} and GD_Adr_Region.Value in {'2A', '2B'} and GD_Adr_PostalCode.Value not starts with '20' then
			set value MESSAGES.ERRsubmitRequestGDPostalCode in MESSAGE_POPUP

		GD_Adr_CountryGD.Value is 'ES' and GD_Adr_PostalCode.Value.Length is not 5 and GD_Adr_PostalCode.Value >= 53000 then
			set value MESSAGES.ERRspanishPostalCode in MESSAGE_POPUP

		GD_Adr_CountryGD.Value is 'GR' and GD_Adr_PostalCode.Value.Length is not 5  then
			set value MESSAGES.ERRsubmitRequestGDPostalCode in MESSAGE_POPUP
		
		GD_Adr_CountryGD.Value is 'IT' and GD_Adr_PostalCode.Value.Length is not 5 then 
			set value MESSAGES.ERRitalianPostalCode in MESSAGE_POPUP

		GD_Adr_CountryGD.Value is 'PT' and GD_Adr_PostalCode.Value.Length is not 8 then
			set value MESSAGES.ERRportughesePostalCode in MESSAGE_POPUP

		; TODO: THESE VALIDATIONS SHOULD 'BE' CHECKED ACTUALLY WITH THE VALIDATION REGEXS IN THE FIELD ITSELF - SEB
		; GD_Adr_CountryGD.Value is 'PT' and GD_Adr_PostalCode.Value.Length is not 8 then
		; GD_Adr_CountryGD.Value is 'BE' and GD_Adr_Region.Value is 01 and GD_Adr_PostalCode.Value is number and GD_Adr_PostalCode.Value not in range {1500,3999} or GD_Adr_PostalCode.Value not in range {8000,9999} then 
		; 	set value MESSAGES.ERRregionCode in MESSAGE_POPUP
		; GD_Adr_CountryGD.Value is 'BE' and GD_Adr_Region.Value is 02 and GD_Adr_PostalCode.Value is number and GD_Adr_PostalCode.Value not in range {1300,1499} or GD_Adr_PostalCode.Value not in range {4000,7999} then 
		; 	set value MESSAGES.ERRregionCode in MESSAGE_POPUP
		; GD_Adr_CountryGD.Value is 'BE' and GD_Adr_Region.Value is 03 and GD_Adr_PostalCode.Value is number and GD_Adr_PostalCode.Value not in range {1000,1299} then
		; 	set value MESSAGES.ERRregionCode in MESSAGE_POPUP
		; GD_Adr_CountryGD.Value is 'LU' and GD_Adr_PostalCode.Value.Length is not 4 then
		; 	set value MESSAGES.ERRsubmitRequestGDPostalCode in MESSAGE_POPUP
		; GD_Adr_Country.Value is 'GR' and GD_Adr_POBoxPostalCode.Value is not empty and GD_Adr_POBoxPostalCode.Value.Length is not 5 then 
		; 	set value MESSAGES.ERRsubmitRequestGDPOBoxValid in MESSAGE_POPUP

		GD_Adr_Country.Value is 'GR' and GD_Adr_POBoxPostalCode.IsMandatory is true and GD_Adr_POBoxPostalCode.Value is empty then
			set value MESSAGES.ERRsubmitRequestGDPOBox in MESSAGE_POPUP

		GD_SAPNumber is Visible and DDLDCReqAction.Value is SUBMITTED and GD_Adr_CountryGD.Value is 'BE' and HF_RequestType.Value is 'VC' and GD_SAPNumber.Value is empty then
			set value MESSAGES.ERRsubmitRequestRHFieldSAP in MESSAGE_POPUP

		GD_SAPNumber is Visible and DDLDCReqAction.Value is SUBMITTED and GD_Adr_CountryGD.Value is 'BE' and HF_RequestType.Value is 'VC' and GD_SAPNumber.Value is not empty and GD_SAPNumber.Value not in range {1000000000,1999999999} then
			set value MESSAGES.ERRsubmitRequestRHFieldSAPInv in MESSAGE_POPUP

		GD_SAPNumber is Visible and DDLDCReqAction.Value is SUBMITTED and GD_Adr_CountryGD.Value is 'LU' and HF_RequestType.Value is 'VC' and GD_SAPNumber.Value is empty then
			set value MESSAGES.ERRsubmitRequestRHFieldSAP in MESSAGE_POPUP									
																									
		GD_SAPNumber is Visible and DDLDCReqAction.Value is SUBMITTED and GD_Adr_CountryGD.Value is 'LU' and HF_RequestType.Value is 'VC' and GD_SAPNumber.Value is not empty and GD_SAPNumber.Value not in range {2000000000,2999999999} then
			set value MESSAGES.ERRsubmitRequestRHFieldSAPInv2 in MESSAGE_POPUP

		CC_AM_WithholdingTaxCode.IsMandatory is true and CC_AM_WithholdingTaxCode.Value is empty then
			set value MESSAGES.ERRsubmitRequestCCTaxCode in MESSAGE_POPUP

		HF_RegionalCountry.Value is 'IT' and CC_AM_WithholdingTaxCode.Value is empty then
			set value MESSAGES.ERRsubmitRequestCCTaxCode in MESSAGE_POPUP

		GD_Damex.IsMandatory is true and GD_Damex.Value is emtpy then
			set value MESSAGES.ERRsubmitRequestRHFieldDamexE in MESSAGE_POPUP

		GD_Damex.Value is true and ATTACHMENTS.Items.Count is 0 then
			set value MESSAGES.ERRsubmitRequestAttachment in MESSAGE_POPUP

		HF_CurrentRole.Value is 'MDMV3_ENQ' and HF_RequestType.Value is not 'VC' and DDLDCComment.Value is empty then
			set value MESSAGES.ERRsubmitRequestComment in MESSAGE_POPUP

		DDLDCComment.Value is not empty and DDLDCComment.Value.Length > 2000 then 
			set value MESSAGES.ERRcommentLenght in MESSAGE_POPUP

		; TODO: PUT IN VALIDATAION OF SUBMIT BUTTON If customer country belongs to 'YCT6'/'YCT9': if region selected = ""2A"" -> Postal code begins with 20/if region selected = ""2B"" -> Postal code begins with 20 else Postal code begins with code region

		; TODO: ValidateBankDetails - Banks data is validated only on CLERK or ENQ
		; if there are no banks
		HF_CurrentRole.Value in {'MDMV3_ENQ', 'MDMV3_CLERK'} and GD_VB_Grid.Items.Count is 0 then
			set value MESSAGES.ERRAtLestOneBankRow in MESSAGE_POPUP


		; TODO: CalculateExternalNumber

		
		HF_RequestState.Value in {'Locked', 'Closed'} then
			this visible false
		else
			this visible true
			this enable true

		REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false

		; TODO: CONTROL_FLAG_IS_OK is true then
		; TODO: SPECIFY ALL ARGUMENTS --- load data from WEBSERVICE.C with arguments { ALL FIELDS }
		
	with triggers

		this on click
			
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, ACTIONS=1, TRIGGERS=1
Entity btnClose	is Button in frmMain
	with defaults
		label LABELS.btnClose

	; TODO: ADD CLOSE SUPPORT IN PARSER - NEED TO CHANGE PARSER
	with actions
		close frmMain

	with triggers
		this on click
		

; ----------------------------------------------------------------------------	

; TODO: SEB probably we do not need this?	
; TESTGEN : DEFAULTS=3,	RULES=3
Entity btnSCClose is Button in frmMain
	with defaults
		label LABELS.btnClose

	with rules
		HF_RequestState.Value is not CLOSED and btnSubmit.Visible is true then
			this visible true

		btnClose.Visible is true then
			this visible false
		else
			this visible true

		HF_RequestState.Value in {'Locked', 'Closed'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false	

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, ACTIONS=1, TRIGGERS=1, RULES=1
; TODO: CHECK if this is useful, there's no really going "back" so probably this is not useful
Entity btnBack2 is Button in frmMain
	with defaults
		label LABELS.btnBack

	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false	

; ----------------------------------------------------------------------------	

; TODO: SEB what about this?
; TESTGEN : DEFAULTS=3, ACTIONS=1, TRIGGERS=1, RULES=1
Entity btnSave is Button in frmMain
	with defaults
		label LABELS.btnSave

	with actions
		this enable false

	with rules

		HF_RequestState.Value in {'Locked', 'Closed'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false	

	with triggers
		this on click

; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=3, RULES=2
Entity btnCloseFinal is Button in frmMain
	with defaults
		label LABELS.btnClose

	with rules
		HF_CurrentRole.Value is 'MDMV3_CLERK' then
			this visible true
		else
			this visible false

		HF_RequestState.Value in {'Locked', 'Closed'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false	

; --- WORKFLOW RELATED CONTROLS ----------------------------------------------

; TODO: OMFG - THIS IS GOING TO 'BE' A MESS - THIS NEEDS MORE STUFF.....
Entity DDLDCReqAction is DropDownList in frmMain
	with defaults
		mandatory true
		label LABELS.labSR_Action

		; TODO: the dataloading seems too complex
		; DDLDCReqAction.DataSource = _w4e.W4E_StateMap.Where ( GetActionFilter ( _sessionInfo.CurrentBPCode, flowtype, GeneralRequestData.WFRoleCode, GeneralRequestData.WFStatusCode, Evaluator ) );
		; Evaluator?????

		data field DisplayName
		value field Code

        load data from DATASOURCE.W4E_StateMap with arguments {BPCode : 'MDMV3', FlowType : HF_RequestType.Value, CurrentRole : HF_CurrentRole.Value, Status : HF_RequestState.Value }

	
	with rules

		HF_RequestState.Value is CLOSED then
			this visible false

		; HF_RegionalCountry.Value is 'LU' or HF_RegionalCountry.Value is 'IT' then
			; this needs a TEST and inclusion in the GRAMMAR
			; remove value 'Info Requested to 'MDMV3_UPM'' from DDLDCReqAction

		HF_RegionalCountry.Value in {'ES','IT','BE','LU'} then
			remove "Info Requested to CPM" in DDLDCReqAction.Items

		HF_RequestState.Value in {'Locked', 'Closed'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false	


	; with triggers
	; 	this.value changes

; ----------------------------------------------------------------------------	


; in spite of the name 'labNextRole' this is correct
; TODO: The data loading of this, is a total mess
; TESTGEN : DEFAULTS=5, RULES=2
Entity labNextRole is DropDownList in frmMain
	with defaults
		label LABELS.NextRole
		data field DisplayName
		value field Code
		enable false

	with rules
		HF_RequestState.Value is CLOSED then
			this visible false
		REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false
; ----------------------------------------------------------------------------	


; TODO: The data loading of this, is a total mess
; TESTGEN : DEFAULTS=4, RULES=2
Entity labNextAction is DropDownList in frmMain
	with defaults
		data field DisplayName
		value field Code
		enable false

	with rules
		HF_RequestState.Value is CLOSED then
			this visible false
		REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false
			this visible false
; ----------------------------------------------------------------------------	

; TESTGEN : DEFAULTS=2, RULES=1, TRIGGERS=1, ACTIONS=0
Entity PO_lbxPODPursacheOrganization1 is Object in frmMain
	with rules
		HF_RequestState.Value in {'Locked', 'Closed'} or HF_RequestType.Value is CM_BLK or HF_CurrentRole.Value in {'MDMV3_UPM', 'MDMV3_CPM', 'MDMV3_RCO'} or REQUEST.USER_PERMISSION is ACCESSRIGHTS.READER then
			this enable false	
	with triggers
		this loads
